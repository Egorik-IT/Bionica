"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[11619],{587904:(e,_,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M6.75 1.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z"/></svg>',name:"add_12"}}i.d(_,{getIcon12Add:()=>o})},286645:(e,_,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="M3.72 5.22a.75.75 0 0 1 1.06 0l2.5 2.5a.75.75 0 1 1-1.06 1.06L5 7.56v1.9c0 .84 0 1.44.04 1.9.04.45.1.71.2.91.22.43.57.77.99.99.2.1.46.17.91.2.46.04 1.06.04 1.91.04h1.2a.75.75 0 0 1 0 1.5H9.02c-.82 0-1.47 0-2-.04a3.85 3.85 0 0 1-1.47-.37 3.75 3.75 0 0 1-1.64-1.64 3.84 3.84 0 0 1-.37-1.47c-.04-.53-.04-1.18-.04-2V7.56L2.28 8.78a.75.75 0 1 1-1.06-1.06zm9.14 1.32c-.46-.04-1.06-.04-1.91-.04h-1.2a.75.75 0 1 1 0-1.5h1.23c.81 0 1.47 0 2 .04.55.05 1.03.14 1.47.37a3.75 3.75 0 0 1 1.64 1.64c.23.44.32.92.37 1.47.04.53.04 1.19.04 2v1.92l1.22-1.22a.75.75 0 0 1 1.06 1.06l-2.5 2.5a.75.75 0 0 1-1.06 0l-2.5-2.5a.75.75 0 0 1 1.06-1.06L15 12.44v-1.89c0-.85 0-1.45-.04-1.9a2.4 2.4 0 0 0-.2-.92 2.25 2.25 0 0 0-.99-.98 2.4 2.4 0 0 0-.91-.21z" clip-rule="evenodd"/></svg>',name:"arrow_2_squarepath_outline_20"}}i.d(_,{getIcon20Arrow2SquarepathOutline:()=>o})},293753:(e,_,i)=>{function o(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M9.76 4.75c0-.2.24-.32.4-.2l6.75 5.25c.13.1.13.3 0 .4l-6.75 5.25a.25.25 0 0 1-.4-.2V12.1a.75.75 0 0 0-.75-.75c-2.46 0-4.34.92-5.83 2.2a6.97 6.97 0 0 1 1.57-3.43 7.16 7.16 0 0 1 4.38-2.22.75.75 0 0 0 .63-.75zm1.33-1.38a1.75 1.75 0 0 0-2.83 1.38v1.8a8.42 8.42 0 0 0-4.64 2.6c-1.35 1.53-2.12 3.67-2.12 6.44a.75.75 0 0 0 1.33.47c1.36-1.65 3.06-2.94 5.43-3.16v2.35a1.75 1.75 0 0 0 2.82 1.38l6.75-5.25c.9-.7.9-2.06 0-2.76z" fill="currentColor" fill-rule="evenodd"/></svg>',name:"share_outline_20"}}i.d(_,{getIcon20ShareOutline:()=>o})},27914:(e,_,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 20 20"><path fill="currentColor" fill-rule="evenodd" d="M13.75 4c.2 0 .39.08.53.22l2.5 2.5a.75.75 0 0 1-1.06 1.06L14.5 6.56v8.69a.75.75 0 0 1-1.5 0V6.56l-1.22 1.22a.75.75 0 1 1-1.06-1.06l2.5-2.5a.75.75 0 0 1 .53-.22zm-7.5 0a.75.75 0 0 1 .75.75v8.69l1.22-1.22a.75.75 0 0 1 1.06 1.06l-2.5 2.5a.75.75 0 0 1-1.06 0l-2.5-2.5a.75.75 0 1 1 1.06-1.06l1.22 1.22V4.75A.75.75 0 0 1 6.25 4z" clip-rule="evenodd"/></svg>',name:"sort_outline_20"}}i.d(_,{getIcon20SortOutline:()=>o})},818732:(e,_,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 36 36"><path fill-rule="evenodd" d="M24.74 7.47a12.5 12.5 0 0 0-18.1 15.76 1.25 1.25 0 0 1-2.27 1.04A15 15 0 1 1 18 33a1.25 1.25 0 1 1 0-2.5 12.5 12.5 0 0 0 6.74-23.03Z" clip-rule="evenodd"/></svg>',name:"spinner_36"}}i.d(_,{getIcon36Spinner:()=>o})},475653:(e,_,i)=>{i.d(_,{default:()=>v});var o=i(593159),t=i(972332),s=i(575753),d=i(754866),a=i(939646);function n(e){if(!this.inited)return!1;if(e||(e=window.event),this.isHorizontal){const _=Math.floor((this.contWidth()-this.scrollWidth)*Math.min(1,(e.screenX-this.moveX)/(this.scrollbarSize-this.innerWidth-6)));(0,o.isFunction)(this.options.onScroll)&&this.options.onScroll(this.obj.scrollLeft-_,this),this.obj.scrollLeft=_}else{const _=Math.floor((this.contHeight()-this.scrollHeight)*Math.min(1,(e.screenY-this.moveY)/(this.scrollbarSize-this.innerHeight-6)));(0,o.isFunction)(this.options.onScroll)&&this.options.onScroll(this.obj.scrollTop-_,this),this.obj.scrollTop=_}return this.update(!0),!1}function r(){return!!this.inited&&(this.moveY=this.moveX=this.isDown=!1,this.isOut&&this.contOut(),(0,t.removeEvent)(document,"mousemove",this.mouseMove),(0,t.removeEvent)(document,"mouseup",this.mouseUp),(0,d.setStyle)(document.body,"cursor","default"),(0,d.setStyle)(this.obj,{pointerEvents:""}),(0,d.removeClass)(this.inner,"scrollbar_hovered"),(0,o.isFunction)(this.options.stopDrag)&&this.options.stopDrag(),(0,o.isFunction)(this.options.onHold)&&this.options.onHold(!1),!1)}function l(e){return!!this.inited&&(this.moveY||(0,t.checkEvent)(e)?void 0:(e||(e=window.event),(0,t.addEvent)(document,"mousemove",this.mouseMove),(0,t.addEvent)(document,"mouseup",this.mouseUp),(0,d.setStyle)(document.body,"cursor","pointer"),(0,d.setStyle)(this.obj,{pointerEvents:"none"}),this.isHorizontal?this.moveX=e.screenX-(this.inner.offsetLeft||0):this.moveY=e.screenY-(this.inner.offsetTop||0),(0,d.addClass)(this.inner,"scrollbar_hovered"),(0,o.isFunction)(this.options.startDrag)&&this.options.startDrag(),(0,o.isFunction)(this.options.onHold)&&this.options.onHold(!0),this.isDown=!0,(0,t.cancelEvent)(e)))}function c(e){switch(e||(e=window.event),e.keyCode){case 40:this.obj[this.scrollProp]+=40;break;case 38:this.obj[this.scrollProp]-=40;break;case 34:this.obj[this.scrollProp]+=this[this.scrollDimensionProp];break;case 33:this.obj[this.scrollProp]-=this[this.scrollDimensionProp];break;default:return!0}return this.update(!0),(0,t.cancelEvent)(e)}function m(e,_){const i=this.wheel.bind(this);this.obj=e=(0,d.ge)(e),this.options=(0,o.extend)({nomargin:!1,horizontal:!1,top:0,bottom:0,padding:3,prefix:"",hidden:0},_||{}),this.isHorizontal=this.options.horizontal,this.scrollProp=this.isHorizontal?"scrollLeft":"scrollTop",this.scrollDimensionProp=this.isHorizontal?"scrollWidth":"scrollHeight",this.topShadow=!1,this.bottomShadow=!1,this[this.scrollProp+"Last"]=this.obj[this.scrollProp],this.destroyList=[],this.mouseDown=l.bind(this),this.mouseMove=n.bind(this),this.mouseUp=r.bind(this),this.initObjMouseWheel=function(){(0,t.addEvent)(e,s.browserFeatures.wheelEvent,i)},this.destroyObjMouseWheel=function(){(0,t.removeEvent)(e,s.browserFeatures.wheelEvent,i)},this.initScrollBarMouseWheel=function(){(0,t.addEvent)(this.scrollbar,s.browserFeatures.wheelEvent,i)}.bind(this),this.destroyScrollBarMouseWheel=function(){(0,t.removeEvent)(this.scrollbar,s.browserFeatures.wheelEvent,i)}.bind(this),setTimeout(function(){(0,d.setStyle)(e,{overflow:"hidden"}),this.scrollbar=(0,d.ce)("div",{className:(this.options.prefix?this.options.prefix+"scrollbar_cont ":"")+"scrollbar_cont"+(this.isHorizontal?" scrollbar_cont_horiz":"")+(this.options.hidden?" scrollbar_hidden":"")}),this.inner=(0,d.ce)("div",{className:(this.options.prefix?this.options.prefix+"scrollbar_inner ":"")+"scrollbar_inner"}),this.scrollbar.appendChild(this.inner);const _=this.widthUpdated();this.options.shadows&&(e.parentNode.insertBefore(this.topShadowDiv=(0,d.ce)("div",{className:(this.options.prefix?this.options.prefix+"scrollbar_top ":"")+"scrollbar_top"},{width:_[0]}),e),e.parentNode.insertBefore(this.bottomShadowDiv=(0,d.ce)("div",{className:(this.options.prefix?this.options.prefix+"scrollbar_bottom ":"")+"scrollbar_bottom"},{width:_[0]}),e.nextSibling)),e.parentNode.insertBefore(this.scrollbar,e);const a=c.bind(this),n=function(){this.initObjMouseWheel(),(0,t.removeEvent)(e,"mousemove",n)}.bind(this);if((0,t.addEvent)(e,"mouseleave",this.destroyObjMouseWheel),(0,t.addEvent)(e,"mouseenter",this.initObjMouseWheel),(0,t.addEvent)(e,"mousemove",n),(0,t.addEvent)(this.scrollbar,"mouseenter",this.initScrollBarMouseWheel),(0,t.addEvent)(this.scrollbar,"mouseleave",this.destroyScrollBarMouseWheel),this.options.scrollElements&&(0,o.each)(this.options.scrollElements,(function(e,_){(0,t.addEvent)(_,s.browserFeatures.wheelEvent,i)})),(0,t.addEvent)(this.scrollbar,"mouseover",this.contOver.bind(this)),(0,t.addEvent)(this.scrollbar,"mouseout",this.contOut.bind(this)),(0,t.addEvent)(this.scrollbar,"mousedown",this.contDown.bind(this)),s.browser.safari_mobile){const _=function(e){this.isHorizontal?cur.touchX=e.touches[0].pageX:cur.touchY=e.touches[0].pageY}.bind(this),i=function(_){return this.isHorizontal?(cur.touchDiff=cur.touchX-(cur.touchX=_.touches[0].pageX),e.scrollLeft+=cur.touchDiff,e.scrollLeft>0&&!1!==this.shown&&this.update(!0)):(cur.touchDiff=cur.touchY-(cur.touchY=_.touches[0].pageY),e.scrollTop+=cur.touchDiff,e.scrollTop>0&&!1!==this.shown&&this.update(!0)),(0,t.cancelEvent)(_)}.bind(this),o=function(){cur.animateInt=setInterval(function(){cur.touchDiff=.9*cur.touchDiff,cur.touchDiff<1&&cur.touchDiff>-1?clearInterval(cur.animateInt):(e[self.scrollProp]+=cur.touchDiff,this.update(!0))}.bind(this),0)}.bind(this);(0,t.addEvent)(e,"touchstart",_),(0,t.addEvent)(e,"touchmove",i),(0,t.addEvent)(e,"touchend",o),this.destroyList.push((function(){(0,t.removeEvent)(e,"touchstart",_),(0,t.removeEvent)(e,"touchmove",i),(0,t.removeEvent)(e,"touchend",o)}))}(0,t.addEvent)(this.inner,"mousedown",this.mouseDown),this.options.nokeys?this.onkeydown=a:(0,t.addEvent)(window,"keydown",a),this.destroyList.push(function(){(0,t.removeEvent)(e,s.browserFeatures.wheelEvent,i),this.options.scrollElements&&(0,o.each)(this.options.scrollElements,(function(e,_){(0,t.removeEvent)(_,s.browserFeatures.wheelEvent,i)})),(0,t.removeEvent)(this.inner,"mousedown",this.mouseDown),(0,t.removeEvent)(window,"keydown",a),(0,t.removeEvent)(e,"mousemove",n),(0,d.re)(this.scrollbar)}.bind(this)),this.isHorizontal||(this.contHeight()<=this.scrollHeight?(0,d.hide)(this.bottomShadowDiv):this.bottomShadow=!0),this.options.onInit&&this.options.onInit(),this.inited=!0,this.update(!0),this.options.global||cur.destroy.push(this.destroy.bind(this))}.bind(this),0)}m.prototype={wheel:function(e){if(this.disabled)return;e||(e=window.event);let _=0;const i=this.obj[this.scrollProp],t=void 0!==e.deltaMode?e.deltaMode:"MozMousePixelScroll"==e.type?0:1;return"wheel"==e.type?_=-(this.isHorizontal?e.deltaX:e.deltaY):void 0!==e.wheelDeltaX&&void 0!==e.wheelDeltaY?(_=1/40*(this.isHorizontal?e.wheelDeltaX:e.wheelDeltaY),s.browser.mac&&s.browser.opera&&(_*=.1)):void 0!==e.wheelDelta?_=1/40*e.wheelDelta:e.detail&&e.axis===(this.isHorizontal?1:2)&&(_=-e.detail),_=1*_*(1==t?15:2==t?450:1),_?(this.obj[this.scrollProp]-=_,(0,o.isFunction)(this.options.onScroll)&&this.options.onScroll(_,this),i!=this.obj[this.scrollProp]&&!1!==this.shown&&(this.update(!0),(0,d.addClass)(this.inner,"scrollbar_hovered"),clearTimeout(this.moveTimeout),this.moveTimeout=setTimeout(function(){(0,d.removeClass)(this.inner,"scrollbar_hovered")}.bind(this),300)),!!(!this.shown&&!this.options.forceCancelEvent||this.isHorizontal&&i==this.obj[this.scrollProp])&&void 0):void 0},setOptions:function(e){(0,o.extend)(this.options,e)},widthUpdated:function(){const e=(0,d.getSize)(this.obj);let _;return _=this.isHorizontal?{marginLeft:this.options.top+"px",marginTop:e[1]+3+"px",width:e[0]-this.options.top-this.options.bottom+"px"}:{marginTop:this.options.top+"px",marginLeft:this.options.nomargin?0:e[0]-(this.options.mlDiff||7)+"px",height:e[1]-this.options.top-this.options.bottom+"px"},this.options.nomargin&&(void 0!==this.options.right&&"auto"!==this.options.right?(_.right=this.options.right,_.left="auto"):void 0!==this.options.left&&(_.right="auto",_.left=this.options.left)),this.scrollWidth=e[0],this.scrollHeight=e[1],this.scrollbarSize=e[this.isHorizontal?0:1]-this.options.top-this.options.bottom,(0,d.setStyle)(this.scrollbar,_),setTimeout(function(){(0,d.removeClass)(this.scrollbar,"no_transition")}.bind(this)),e},contOver:function(){this.isOut=!1,this.shown&&(0,d.addClass)(this.scrollbar,"scrollbar_c_overed")},contOut:function(){this.isOut=!0,this.isDown||(0,d.removeClass)(this.scrollbar,"scrollbar_c_overed")},contDown:function(e){if(e||(e=window.event),this.isHorizontal){const _=e.offsetX-this.innerWidth/2+5,i=this.scrollbarSize-this.innerWidth;this.obj.scrollLeft=Math.floor((this.contWidth()-this.scrollWidth)*Math.min(1,_/i))}else{const _=e.offsetY-this.innerHeight/2+5,i=this.scrollbarSize-this.innerHeight;this.obj.scrollTop=Math.floor((this.contHeight()-this.scrollHeight)*Math.min(1,_/i))}this.update(!0),this.mouseDown(e)},hide:function(){(0,d.hide)(this.topShadowDiv,this.bottomShadowDiv,this.scrollbar),this.hidden=!0},show:function(){(0,d.show)(this.topShadowDiv,this.bottomShadowDiv,this.scrollbar),this.hidden=!1},disable:function(){this.hide(),this[this.scrollProp](0),this.disabled=!0},enable:function(){this.show(),this.update(),this.disabled=!1},getScrollHeight:function(){return this.scrollHeight},scrollTop:function(e){if(void 0===e)return this.obj.scrollTop;this.obj.scrollTop=parseInt(e),this.update(!1,!0)},scrollBottom:function(e){if(void 0===e)return this.contHeight()-this.scrollHeight-this.obj.scrollTop;this.obj.scrollTop=this.contHeight(!0)-this.scrollHeight-e,this.update(!0,!0)},smoothScroll:function(e,_,i){const o=this.obj.scrollTop+e;void 0===i&&(i=300);const t=this;new a.Fx.Base({scrollTop:this.obj.scrollTop},{transition:a.Fx.Transitions.easeOutCubic,onStep:function(e){t.obj.scrollTop=e.scrollTop,t.update(!0)},duration:i,onComplete:function(){_&&_(scroll)}}).start({scrollTop:this.obj.scrollTop},{scrollTop:o})},scrollLeft:function(e){this.obj.scrollLeft=parseInt(e),this.update(!1,!0)},destroy:function(){(0,o.each)(this.destroyList||[],(function(e,_){_()}))},contHeight:function(){return Math.round(this.options.contHeight||this.obj.scrollHeight)},contWidth:function(){return Math.round(this.options.contWidth||this.obj.scrollWidth)},val:function(e){return e&&(this.obj[this.scrollProp]=e,this.update(!0,!0)),this.obj[this.scrollProp]},update:function(e,_){if(!this.inited||this.hidden)return;if(!e&&(this.isHorizontal?this.moveX:this.moveY))return!0;let i,t;if(_&&(i=(0,d.getSize)(this.obj),this.isHorizontal?(this.scrollWidth=i[0],i=Math.round(this.scrollWidth-this.options.top-this.options.bottom),this.scrollbarSize!==i&&(this.scrollbar.style.width=i+"px")):(this.scrollHeight=i[1],i=Math.round(this.scrollHeight-this.options.top-this.options.bottom),this.scrollbarSize!==i&&(this.scrollbar.style.height=i+"px")),this.scrollbarSize=i),this.isHorizontal?(i=this.contWidth())<=Math.round(this.scrollWidth):(i=this.contHeight())<=Math.round(this.scrollHeight))return(0,d.hide)(this.inner,this.bottomShadowDiv,this.topShadowDiv),this.scrollbar.style.pointerEvents="none",this.topShadow=this.bottomShadow=this.shown=!1,(0,o.isFunction)(this.options.more)&&i-this.obj[this.scrollProp]<2*this[this.scrollDimensionProp]&&this.options.more(this),void(this[this.scrollProp+"Last"]=this.obj[this.scrollProp]);this.shown||((0,d.show)(this.inner),this.scrollbar.style.pointerEvents="",this.shown=!0);const s=this.val();(0,o.isFunction)(this.options.scrollChange)&&this.options.scrollChange(s),this.lastProgress=Math.min(1,s/(i-(this.isHorizontal?this.scrollWidth:this.scrollHeight))),this.lastProgress>0!=this.topShadow&&((this.topShadow=!this.topShadow)?d.show:d.hide)(this.topShadowDiv),this.lastProgress<1!=this.bottomShadow&&((this.bottomShadow=!this.bottomShadow)?d.show:d.hide)(this.bottomShadowDiv),this.isHorizontal?(t=Math.max(40,Math.floor(this.scrollbarSize*this.scrollWidth/i)),t!==this.innerWidth&&(this.inner.style.width=(this.innerWidth=t)+"px"),this.inner.style.marginLeft=(this.scrollbarSize-t-2*this.options.padding)*this.lastProgress+this.options.padding+"px"):(t=Math.max(40,Math.floor(this.scrollbarSize*this.scrollHeight/i)),t!==this.innerHeight&&(this.inner.style.height=(this.innerHeight=t)+"px"),this.inner.style.marginTop=(this.scrollbarSize-t-2*this.options.padding)*this.lastProgress+this.options.padding+"px"),(0,o.isFunction)(this.options.more)&&i-this.obj[this.scrollProp]<2*this[this.scrollDimensionProp]&&this.options.more(this),this[this.scrollProp+"Last"]=this.obj[this.scrollProp]},restore:function(){this.obj[this.scrollProp]=this[this.scrollProp+"Last"]}};const v=m},461388:(e,_,i)=>{i.r(_),i.d(_,{API_LIVE_PHASES:()=>r,ENDED:()=>s,FAILED:()=>d,PRE_CHECK:()=>n,STARTED:()=>t,UPCOMING:()=>a,WAITING:()=>o});const o=1,t=2,s=3,d=4,a=5,n=6,r={waiting:o,started:t,postlive:s,finished:s,failed:d,upcoming:a}},111922:(e,_,i)=>{i.d(_,{TimeCodesList:()=>c});var o=i(293753),t=i(593159),s=i(353557),d=i(754866),a=i(866467),n=i(939646),r=i(972332),l=i(636576);const c={THUMB_SIZE:128,_block:null,curTimeCodeIndex:0,tpl:'\n    <div class="TimeCodesList">\n      <div class="TimeCodesList__header">\n        <div class="TimeCodesList__headerText">%title%</div>\n        <button type="button" class="TimeCodesList__headerAction" onclick="TimeCodesList.close()">\n          %closeText%\n        </button>\n      </div>\n      <div class="TimeCodesList__container">\n        %items%\n      </div>\n    </div>',buildBlock:e=>{const _=c.buildTimeCodesList(e),i=(0,t.trim)(c.tpl),o=(0,d.se)((0,d.rs)(i,{title:(0,a.getLang)("video_n_time_codes",e.length,!0),closeText:(0,a.getLang)("video_close_time_code_list"),items:_}));return c._block=o,o},blockItemTpl:`\n<div class="TimeCodesList__item" onclick="Videoview.timeTagClick(%time%, 'list', event)">\n  <div class="TimeCodesList__itemThumbWrap">\n    <div class="TimeCodesList__itemThumb" style="\n      width: %imgWidth%px;\n      height: %imgHeight%px;\n      background-image: url(%imgSrc%);\n      background-size: %imgWidth%px %imgHeight%px;\n      background-position: %imgOffsetX%px %imgOffsetY%px">\n    </div>\n    />\n  </div>\n  <div class="TimeCodesList__itemInfo">\n    <div class="TimeCodesList__itemTitle" data-task-mouseover="Video/check_title">%text%</div>\n    <div class="TimeCodesList__itemDurationWrap">\n      <div class="TimeCodesList__itemDuration">%formattedDuration%</div>\n      <div class="TimeCodesList__itemShare" onclick="TimeCodesList.exportEpisode(%time%, event)">\n        <span class="TimeCodesList__itemShareIcon">${(0,o.getIcon20ShareOutline)().icon}</span>\n      </div>\n    </div>\n  </div>\n</div>\n  `,buildTimeCodesList(e){let _="";for(let i=0;i<e.length;i++)_+=this.buildItem(e[i]);return _},buildItem(e){const _=(0,t.trim)(c.blockItemTpl),{imgSrc:i="",imgWidth:o=128,imgHeight:a=72,imgOffsetX:n=0,imgOffsetY:r=0}=Videoview.getThumbFromTime(e.time,this.THUMB_SIZE);return(0,d.rs)(_,{text:e.text,time:e.time,imgSrc:i,imgWidth:o,imgHeight:a,imgOffsetX:n,imgOffsetY:r,formattedDuration:(0,s.formatTime)(e.time)})},getBlock(){return this._block},isShowed(){const e=document.getElementById("mv_box");return!!e&&e.classList.contains("_has_time_codes")},toggleUI:e=>{if(!c._block)return;const _=document.getElementById("mv_box");if(_){const i=_.classList.contains("_has_time_codes");_.classList.toggle("_has_time_codes",!i||e)}},close:()=>{c.toggleUI(),Videoview.onResize()},destroy:()=>{c._block&&((0,d.re)(c._block),c._block=null,c.curTimeCodeIndex=0,(0,d.removeClass)("mv_box","_has_time_codes"))},draw:(e=!1)=>{if(!c._block){const e=Videoview.getTimeCodes(),_=c.buildBlock(e);let i=document.getElementById("mv_main");i&&i.insertBefore(_,i.firstChild)}c.toggleUI(e),c.updateScrollbar()},reDraw:()=>{(0,d.re)(c._block),c._block=null;const e=Videoview.getTimeCodes(),_=c.buildBlock(e);document.getElementById("mv_main").appendChild(_),c.updateScrollbar(),c.updateCurrentTimeCode(c.curTimeCodeIndex)},updateCurrentTimeCode:e=>{const _=c._block;if(!_)return;let i;if([..._.querySelectorAll(".TimeCodesList__item")].forEach(((_,o)=>{_.classList.toggle("TimeCodesList__item--active",o===e),o===e&&(i=_,c.curTimeCodeIndex=e)})),i){const e=(0,d.geByClass1)("TimeCodesList__container",_),o=(0,d.getXY)(i)[1],t=(0,d.getSize)(i)[1],s=(0,d.getXY)(e)[1],a=(0,d.getSize)(e)[1],r=o-s;if(r<0||r+t>a){const _=e.scrollTop+o-s-a/2+t/2;e.scrollTop!==_&&(0,n.animate)(e,{scrollTop:_,transition:n.Fx.Transitions.easeOutCubic},450,c.updateScrollbar)}}},updateScrollbar(){const e=c.getBlock();if(!e)return;const _=(0,d.data)(e,"sb");if(_)_.update(!0,!0);else{const _=(0,d.geByClass1)("TimeCodesList__container",e),i=new Scrollbar(_,{prefix:"mv_tc_",nokeys:!0,padding:0});(0,d.data)(e,"sb",i)}},exportEpisode(e,_){(0,l.statlogsValueEvent)("video_time_codes_share",""),window.Videoview?.sendVideo(!1,{fromTime:e}),(0,r.cancelEvent)(_)}}},314310:(e,_,i)=>{i.d(_,{default:()=>w});var o=i(432081),t=i(898848),s=i(972332),d=i(593159),a=i(754866),n=i(826619),r=i(105330),l=i(781956),c=i(237625),m=i(540462),v=i(174269),E=i(856289),u=i(977780);const w={resize:function(e,_){},debugLog(...e){e.unshift("video player:"),c.debugLog.apply(null,e)},fullscreen(e){window.Videoview?.onFullscreenChange(e),window.ExternalVideo?.updateExternalVideoFinishBlock(),cur.storyLayer?(0,a.toggleClass)(cur.storyLayer.layerEl,"_fullscreen",e):window.mvLayer&&(0,a.toggleClass)(mvLayer,"mv_layer--fullscreen",e)},incViewCounter(e,_,i,o,t,s,a){const r={oid:e,vid:_,hash:i,curr_res:o,max_res:t,player:s||"flash",type:a,module:Videoview.getVideoModule(e+"_"+_)};if(cur.videoSearchStats){const e=parseInt(cur.videoSearchPos);isNaN(e)||(r.search_pos=e,cur.videoSearchStats.positions[e]=(0,d.extend)({viewStarted:0},cur.videoSearchStats.positions[e]),cur.videoSearchStats.positions[e].viewStarted++),cur.videoSearchStats.totalViews++}(0,n.idlizeCall)((()=>{ajax.post("al_video.php?act=inc_view_counter",r)}))},rotateVideo(e,_,i,o){ajax.post("al_video.php?act=rotate_video",{oid:e,vid:_,angle:i,hash:o})},onVideoNext(e,_,i){setTimeout((function(){{let o=0;_||e?_&&i?o=5:_&&!i?o=6:e&&(o=7):o=4,Videoview.sendPlayerStats(o,0)}if(VideoPlaylist.getBlock())e&&!_?VideoPlaylist.showVideo(e):VideoPlaylist.nextVideo();else{let _=Videoview.getVideoModule(e);cur.is_showcase&&(_+=":similar"),(0,o.showVideo)(e,"",{autoplay:1,module:_})}}),0)},fetchSuggestions(e,_){if(!e)return;const i=Videoview.getMvData(),o=i.videoRaw;ajax.post("al_video.php?act=fetch_player_suggestions",{oid:i.oid,vid:i.vid,videos:e,prepend_current:_?1:0},{onDone:function(e){const _=Videoview.getMvData();if(_&&_.videoRaw==o){_.playerSuggestions=e;const i=cur.videoInlinePlayer||window.mvcur&&mvcur.player||cur.player;i&&i.setSuggestions(e)}}})},setSuggestions(e){Videoview.playerCallback.fetchSuggestions(e)},onSuggestionsShown(e,_){const i=_?16:12;Videoview.sendPlayerStats(i,0)},onSuggestionClick(e,_,i,t){const s=t?15:11;Videoview.sendPlayerStats(s,0);let d=Videoview.getVideoModule(e);cur.is_showcase&&(d+=":similar"),(0,o.showVideo)(e,"",{autoplay:1,module:d})},onSuggestionsReplayClicked:function(){Videoview.sendPlayerStats(17,0)},onOpenInPopup(e,_,i){Videoview.sendPlayerStats(8,0);const t=cur.videoInlinePlayer&&cur.videoInlinePlayer.canExpand()?cur.videoInlinePlayer:null;let s=null,d=null,n=null,r=null;t&&(r=t.isInteractive,r&&t.projectVars?(s=t.projectVars.short_video,d=t.projectVars.track_code,n=t.projectVars.module):t.vars&&(s=t.vars.short_video,d=t.vars.track_code,n=t.vars.module));const l=window._videoLastInlined?(0,a.domData)((0,a.domClosest)("post",window._videoLastInlined[1]),"post-id"):null,c=window._videoLastInlined?.[1]?(0,a.domData)(window._videoLastInlined[1],"promo-post-hash"):null,m=window._videoLastInlined?(0,a.domData)(window._videoLastInlined[1],"playlist"):null;(0,o.showVideo)(e,_,{shortVideo:s,expandPlayer:t,playlistId:m,autoplay:1,module:n,addParams:{t:i,post_id:l,track_code:d,promo_post_hash:c},openInPopup:!0})},onVideoAdEvent(e,_,i,o,t,s,d,a,n){if(i){cur._vadStatQueue=cur._vadStatQueue||{},cur._vadStatQueue[e+"_"+_]=cur._vadStatQueue[e+"_"+_]||{type:"",events:[]};const s=cur._vadStatQueue[e+"_"+_];s.type=t,s.events.push(o),s.pl_type=d,s.app_version=a,s.media_provider=n,clearTimeout(cur._vadStatTimer),cur._vadStatTimer=setTimeout(Videoview.sendVideoAdStat.bind(Videoview,e,_,i),1e3)}},onVideoAdShown(e,_,i,o){ajax.post("al_video.php?act=ad_event",{oid:e,vid:_,type:i,event:o})},onVideoResolutionChanged(e,_,i,o){const t=Videoview.getMvData();t&&(t.resolution=o)},onInitialized(){Videoview.isLayerShown()&&(VideoPlaylist.toggle(!VideoPlaylist.isCollapsed()),mvcur.options&&mvcur.options.focusPlay&&("visible"==document.visibilityState?Videoview.togglePlay(!0):"hidden"==document.visibilityState&&(0,s.addEvent)(window,"focus",(function e(){Videoview.togglePlay(!0),(0,s.removeEvent)(window,"focus",e)}))));const e=window.mvcur&&mvcur.player&&mvcur.player.el||(0,a.ge)("video_player");e&&e.focus()},onVideoPlayProgress(e,_,i,o,t){const s=e+"_"+_;o<5e3&&cur.tnsStart!=s?cur.tnsStart=s:o>t/2&&cur.tnsEnd!=s&&(cur.tnsEnd=s),window.mvcur&&mvcur.adData&&(mvcur.adData.stat_link_start&&!mvcur.adData.view_complete_start&&o>=5e3&&(ajax.post(mvcur.adData.stat_link_start,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_start=!0),mvcur.adData.stat_link_half&&!mvcur.adData.view_complete_half&&o>=t/2&&(ajax.post(mvcur.adData.stat_link_half,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_half=!0),mvcur.adData.stat_link_full&&!mvcur.adData.view_complete_full&&o>=.9*t&&(ajax.post(mvcur.adData.stat_link_full,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_full=!0))},onPlayerTouchedByUser(e=!1){window._videoLastInlined&&(e||(0,a.removeClass)(window._videoLastInlined[1],"page_video_autoplayable"))},onVideoStreamPlaying(e,_){const i=Videoview.getPlayerObject();if(i&&i.isAutoplay&&i.isAutoplay())return!1;if(!window.Notifier)return!1;setTimeout((function(){Notifier.lcSend("video_start")}),0);const o=window.ap;return o&&o.isPlaying()&&(o.pauseByChangeChannel(),o.pausedByVideo=Date.now()),!0},onVideoPlayStarted(e,_,i,o,s,d,a,l){const c=Videoview.getMvData(),v=Videoview.getVideoModule(e+"_"+_),E=cur.videoInlinePlayer&&cur.videoInlinePlayer.isAutoplay();if(window.mvcur&&(0,n.idlizeCall)((()=>{document.querySelector(".VideoLayout")?.classList.remove("VideoLayout--hidden"),window.VideoShowcase?.updateLayout()}),3e3),ajax.post("al_video.php?act=video_view_started",{oid:e,vid:_,hash:i,module:v,quality:c?c.resolution:0,autoplay:E?1:0,inline:-1,player_view_type:Videoview.getLayoutType(),ov_id:d,app_version:a,media_provider:l},{}),E&&cur.videoAutoplayStat&&cur.videoAutoplayStat.video==e+"_"+_&&!s&&!(0,m.partConfigEnabled)("video_delete_autoplay_stat")&&ajax.post("al_video.php?act=autoplay_stat",{event:"start",start_time:Date.now()-cur.videoAutoplayStat.launched,preloaded:cur.videoAutoplayStat.preloaded?1:0,streaming_method:o,module:Videoview.getVideoModule()},{}),c){const e=`//${(0,r.getHostName)()}/rtrg?r=`;switch(c.l_type){case 1:(0,t.vkImage)().src=`${e}JQ6ueUeOxlSLb8IoA8ToayylOLgRkThaoFV0XVgG5qvS1x1xWrkfqAg73sYWJxwq9PXWucKtMS02J3CsGLZdmOMNj9dv9UCjDN4a3ShJZXcJFMhgfVwSoPWoxp*Y/LAFUnKz5*XBvDCQXeaygAqI*gY9gz*jWTXaOXyT2lSfIPY-`;break;case 2:(0,t.vkImage)().src=`${e}lD4OYmfC8ehvdc/8TL9AsAjM956qNaHyj20XV5mCNiTgYKQ6X*IXgwE8VbgqOf7rdbLJq7uCRBrdnFPTcUU2NjMgy8x4y6NWrYVwQMteNWh62XnLoNVZqobnsMMGm1OyTW09rhEkmiX5jqk3CI3JIIYbIbd8K7EC0ytQ4Kp4Kro-`}}-33118207==e||-78630688==e?(0,t.vkImage)().src="//rs.mail.ru/d23694799.gif":-68420747==e||-121650415==e?(0,t.vkImage)().src="//rs.mail.ru/d25688137.gif":-18479452==e&&((0,t.vkImage)().src="//rs.mail.ru/d25688115.gif")},onVideoPlayFinished(){window.mvcur&&mvcur.mvShown&&(mvcur.finished=!0,mvcur.mousemoved=!0,Videoview.moveCheck()),window.mvcur&&mvcur.mvShown&&mvcur.adData&&(mvcur.adData.stat_link_start&&!mvcur.adData.view_complete_start&&(ajax.post(mvcur.adData.stat_link_start,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_start=!0),mvcur.adData.stat_link_half&&!mvcur.adData.view_complete_half&&(ajax.post(mvcur.adData.stat_link_half,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_half=!0),mvcur.adData.stat_link_full&&!mvcur.adData.view_complete_full&&(ajax.post(mvcur.adData.stat_link_full,{},{onDone:function(){},onFail:function(){return!0}}),mvcur.adData.view_complete_full=!0))},onVideoPlayError(){Videoview.isLayerShown()&&(0,a.re)("mv_live_gifts_block"),(0,n.idlizeCall)((()=>{document.querySelector(".VideoLayout")?.classList.remove("VideoLayout--hidden"),window.VideoShowcase?.updateLayout()}),3e3)},onVideoAdsLoadStarted(){},onVideoAdsPlayStarted(){(0,n.idlizeCall)((()=>{document.querySelector(".VideoLayout")?.classList.remove("VideoLayout--hidden"),window.VideoShowcase?.updateLayout()}),3e3)},onVideoAdsPlayFinished(){},onViewSegmentsChanged(e,_,i,o){if(!i)return;if(cur.segmentsSaveProcess)return;const t="vsegs"+vk.id+"_"+e+"_"+_;let s=ls.get(t);s&&s.ts&&Date.now()-s.ts>864e5&&(s=null,ls.remove(t));const a=s&&s.segments?s.segments.split("|")[2]:"";if(!a||i!=a){cur.segmentsSaveProcess=!0;const a={module:Videoview.getVideoModule(e+"_"+_),vid:_,oid:e,s:i,prev_s:s?s.segments:"",prev_sig:s?s.segmentsSig:"",hash:o},n=parseInt(cur.videoSearchPos);if(isNaN(n)||(a.search_pos=n),ajax.post("al_video.php?act=a_view_segments",a,{onDone:function(e,_,i){if(e<0)return;e&&ls.set(t,{segments:e,segmentsSig:_,ts:Date.now()}),cur.segmentsSaveProcess=!1,i=(0,d.intval)(i);const o=parseInt(cur.videoSearchPos);i>0&&!isNaN(o)&&cur.videoSearchStats&&(cur.videoSearchStats.positions[o]=(0,d.extend)({viewedParts:0},cur.videoSearchStats.positions[o]),cur.videoSearchStats.positions[o].viewedParts++)}}),cur.videoSearchStats&&(cur.videoSearchStats.totalViewedTime||(cur.videoSearchStats.totalViewedTime=0),cur.videoSearchStats.totalViewedTime+=mvcur.mvData.vsegsSize,!isNaN(n))){cur.videoSearchStats.positions[n]=(0,d.extend)({viewedSeconds:0},cur.videoSearchStats.positions[n]);let e=cur.videoSearchStats.positions[n].viewedSeconds;e=Math.min(mvcur.mvData.duration,e+mvcur.mvData.vsegsSize),cur.videoSearchStats.positions[n].viewedSeconds=e}}},onLike(e){Videoview.like(null,!1),Videoview.sendPlayerStats(1,e)},onAdd(e,_,i){Videoview.addSmall(e,_),Videoview.sendPlayerStats(3,i)},onRemove(){Videoview.removeVideo()},onShare(e){Videoview.share(),Videoview.sendPlayerStats(2,e)},onSubscribe(e,_){Videoview.subscribeToAuthor(e,{from:"player"}),Videoview.sendPlayerStats(e?9:10,_)},onDonate(){Videoview.showDonateBox()},onAddBookmark(){const e=(0,m.partConfigEnabled)("video_modal_refactoring_of_info")?0:1;Videoview.bookmarkVideo(!1,e,v.FAVORITE_SOURCES.VIDEO_PLAYER_BUTTON)},onRemoveBookmark(){Videoview.bookmarkVideo(!0,1,v.FAVORITE_SOURCES.VIDEO_PLAYER_BUTTON)},isInLayer:e=>Videoview.isLayerShown(e),onLiveViewersCountChange(e,_,i){Videoview.isLayerShown(e)&&window.VideoLive?.updateLiveViewersCount(_,i),window.Stories&&window.Stories.isLiveShown(e)&&window.Stories.updateLiveViewersCount(_)},onLiveStarted(e){window.Videoview.isLayerShown(e)&&window.Videoview.reload()},onLivePaused(e){window.Videoview.isLayerShown(e)&&window.Videoview.reload()},onLiveEnded(e,_){window.Videoview.isLayerShown(e)?window.Videoview.reload():window.Stories&&window.Stories.isLiveShown(e)&&window.Stories.activeLiveEnded(_)},onLiveEdit(e){const _=document.getElementById("mv_title");_&&e&&(_.textContent=e)},onAdStat(e,_){window.Wall&&Wall.triggerAdStat(e,_)},showVideoMutePopup(e,_,i,o){(0,l.showMutePopup)({faqLink:e,title:_,text:i,buttonText:o})},openTimeCodesList(e){const _=window.location.pathname.match(E.VIDEO_PAGE_PATHNAME_REGEXP);(0,m.partConfigEnabled)("video_new_video_page")&&_?window.dispatchEvent(new CustomEvent(u.VideoEvents.OPEN_EPISODE_LIST)):setTimeout((()=>{Videoview.openTimeCodesList(e)}),100)},updateCurrentTimeCode(e){const _=window.location.pathname.match(E.VIDEO_PAGE_PATHNAME_REGEXP);(0,m.partConfigEnabled)("video_new_video_page")&&_?window.dispatchEvent(new CustomEvent(u.VideoEvents.UPDATE_ACTIVE_EPISODE,{detail:{index:e}})):Videoview.updateCurrentTimeCode(e)}}},557907:(e,_,i)=>{i.d(_,{default:()=>v,lazyLoadPlayer:()=>E});var o=i(898848),t=i(598129),s=i(540462),d=i(153663),a=i(237625),n=i(754866),r=i(826619),l=i(417465);const c={queue:[],timeout:null,sig:""};function m(e,_){if(!_.send_debug)return;c.sig=[_.action_hash,_.oid,_.vid,_.viewer_id].join("_");const i={ts:Math.round(Date.now()/1e3),video_id:[_.oid,_.vid].join("_"),e:"video_event",event:"debug",value:e,ov_id:_.ov_id,ad_data:_.ad_data,autoplay:_.autoplay,track_code:_.track_code,player_type:window.Videoview?.getLayoutType?.()??"",ref:_.module??window.Videoview?.getVideoModule?.()??""};c.queue.push(i),c.timeout=c.timeout??window.setTimeout((()=>{ajax.post("al_video.php?act=track_player_events",{events:JSON.stringify(c.queue),sig:c.sig}),c.queue=[],c.timeout=null}),1e3)}const v={initPlayer(e,_,i){if((0,n.hide)((0,n.domByClass)(e,"video_box_msg")),(0,l.isInteractiveVideo)(i[0])){const o=(0,l.prepareInteractivePlayerVars)(i[0]);VideoInitializer[_].apply(VideoInitializer,[e,o])}else VideoInitializer[_].apply(VideoInitializer,[e].concat(i));window.stManager.add(window.jsc("web/notifier.js"),(function(){const e=Videoview.togglePlay.pbind(!1);Notifier.addRecvClbk("audio_start","video",e),Notifier.addRecvClbk("video_start","video",e),Notifier.addRecvClbk("videocall_start","video",e)}))},vk(e,_){const i=_.oid+"_"+_.vid;if(_.vsegs)ls.remove("vsegs"+vk.id+"_"+i);else{const e=ls.get("vsegs"+vk.id+"_"+i);e&&e.ts&&e.segments&&Date.now()-e.ts<864e5&&(_.vsegs=e.segments.replace(/[^0-9\,\|]/gi,""))}if(e&&e instanceof HTMLElement){const i=(0,d.getTrackCodeFromPost)(e);i&&(_.feed_track_code=i)}window.onLoaded((function(){VideoInitializer.unionPlayer(e,_)}))},unionPlayer(e,_){m("requested",_);const t=window.mvLayer&&window.mvLayer.contains(e);(0,n.val)(e,""),window.stManager.add(["videoplayer.css"]),((0,l.isInteractiveVideo)(_)?(0,l.interactivePlayerLazyLoad)():Promise.all([i.e(28458),i.e("langs/web/videoplayer_v2")]).then(i.bind(i,17533))).then((({Player:i,InteractivePlayer:s})=>{if(!document.body.contains(e))return void m("domabort",_);let d;m("imported",_);try{d=new(i??s)(_,e),d.init()}catch(e){throw m("constructor_failed",_),e}t?(mvcur.player&&(mvcur.player.deinit?.(),mvcur.player.destroy?.()),mvcur.sdkPlayer=d,mvcur.player=mvcur.sdkPlayer):_.is_embed?cur.player=d:(cur.videoInlinePlayer=d,window.dispatchEvent(new Event("VIDEO_INLINE_PLAYER_LOADED")));const a=(0,n.ce)("div",{id:"video_player"});(0,n.attr)(a,"preventhide",1),a.appendChild(d.el),e.appendChild(a),(0,o.isFunction)(_.onPlayerLoaded)&&_.onPlayerLoaded(d)}),(e=>{throw m("import_failed",_),e}))},youtube(e,_){const i=_.oid,o=_.vid,s=_.report_error_hash;_.restriction||(document.pictureInPictureEnabled&&document.pictureInPictureElement&&document.exitPictureInPicture(),window.onYouTubeIframeAPIReady=function(){const t=(0,n.domByClass)(e,"video_yt_player"),d=new window.YT.Player(t,{events:{onError:function(e){e.data&&[100,101,150].includes(e.data)&&ajax.post("al_video.php?act=reparseDeletedYoutube",{vid:o,oid:i}),(0,a.debugLog)("YT player error",arguments),ajax.post("al_video.php?act=external_error",{oid:i,vid:o,hash:s})},onStateChange:function(e){switch(e.data){case window.YT.PlayerState.ENDED:window.stManager.add([window.jsc("web/videoview.js"),"videoview.css",window.jsc("web/external_video.js")],(function(){const e=document.getElementById("video_yt");window.ExternalVideo?.onExternalVideoEnded(e)}));break;case window.YT.PlayerState.PLAYING:const e=window.ap;e&&e.isPlaying()&&e.pauseByChangeChannel();break;default:document.getElementById("mv_external_finish")&&window.ExternalVideo?.removeExternalVideoFinishBlock()}}}});window.stManager.add([window.jsc("web/video_youtube.js")],(function(){VideoYoutube.initStatOnly(d,_)}))},window.YT?window.onYouTubeIframeAPIReady():(0,t.loadScript)("https://www.youtube.com/iframe_api",{attributes:{async:!0,fetchPriority:"high"}}))},iframeOrFlash(e,_,i,o,t,s){(0,n.val)(e,'<iframe class="extra_player" type="text/html" width="100%" height="100%" src="'+encodeURI(o)+'" frameborder="0" '+t+"></iframe>"),s&&setTimeout((()=>{cur&&cur.incViews&&cur.incViews()}),100)}},E=(e="vk")=>{if((0,s.partConfigEnabled)("video_lazy_load_player"))try{(0,r.idlizeCall)((()=>window.setTimeout((()=>(0,r.idlizeCall)((()=>(e=>{switch(e){case"vk":window.stManager.add(["videoplayer.css"]),Promise.all([i.e(28458),i.e("langs/web/videoplayer_v2")]).then(i.bind(i,17533));break;case"youtube":const e="https://www.youtube.com/iframe_api";(window.YT||document.head.querySelector(`script[src="${e}"]`))&&(0,t.loadScript)(e,{attributes:{defer:!0,fetchPriority:"low"}})}})(e)))),300)))}catch(e){console.error(e)}}},932153:(e,_,i)=>{i.d(_,{VideoPlaylist:()=>M});var o=i(361121),t=i(538522),s=i(754866),d=i(432081),a=i(102088),n=i(898848),r=i(939646),l=i(972332),c=i(593159),m=i(342879),v=i(412573),E=i(286645),u=i(27914),w=i(126415),p=i(826619),b=i(314309),h=i(540462),D=i(317216),P=i(977780),O=i(475653);const M={VIDEOS_LIMIT:30,VIDEO_ITEM_HEIGHT:88,LOADING_PROGRESS_HEIGHT:27,lists:{},disableScrollLoading:!1,module:"",_block:null,blockTpl:`\n<div class="mv_playlist %canSubscribeClass%" id="video_mvpl">\n  <div class="mv_playlist_header clear_fix">\n    <div class="mv_playlist_header_buttons_wrap">\n      <div class="mv_playlist_header_btn %autoplayBtnClass%" onmouseover="VideoPlaylist.showAutoplayTooltip(this);" onclick="VideoPlaylist.toggleAutoplay(this)">\n        ${(0,E.getIcon20Arrow2SquarepathOutline)().icon}\n      </div>\n      <div class="mv_playlist_header_btn" onmouseover="VideoPlaylist.showReverseTooltip(this);" onclick="VideoPlaylist.toggleReverse(this)">\n        <div class="mv_playlist_header_reverse_icon"></div>\n        ${(0,u.getIcon20SortOutline)().icon}\n      </div>\n    </div>\n    <div class="mv_playlist_header_title">%title%</div>\n    <div class="mv_playlist_header_videos_cnt">%size%</div>\n    <a class="mv_playlist_header_subscribe_btn" onclick="VideoPlaylist.toggleSubscription();"></a>\n  </div>\n  <div class="mv_playlist_list">\n    <div class="mv_playlist_load_top"><div class="pr_bt"></div><div class="pr_bt"></div><div class="pr_bt"></div></div>\n    <div class="mv_playlist_list_cont">%items%</div>\n    <div class="mv_playlist_load_bottom %loading%"><div class="pr_bt"></div><div class="pr_bt"></div><div class="pr_bt"></div></div>\n    <div class="mv_playlist_list_subscribe_cont">\n      <div class="mv_playlist_list_subscribe_title">%playlistListSubscribeTitle%</div>\n      <a class="mv_playlist_list_subscribe_btn" onclick="VideoPlaylist.toggleSubscription();"></a>\n    </div>\n  </div>\n</div>\n  `,blockItemTpl:(e=!1)=>`\n<a class="VideoRecomsItem%itemClass%%restrictionClasses%" id="mv_playlist_video%vid%" onclick="return VideoPlaylist.showVideo('%vid%', '%hash%', event);" data-vid="%vid%" href="%link%">\n  <div class="VideoRecomsItem__thumb_wrap">\n    %restrictionBlock%\n    <img src="%thumb%" loading="lazy" width="128"  height="72" class="VideoRecomsItem__thumb%restrictionThumbClass%" alt="%thumbAlt%" onerror="window.VideoPlaylist && VideoPlaylist.onImageError(this)"/>\n    ${e?"":'<div scheme="%scheme%" class="VideoRecomsItem__duration%interactiveClass%">\n            <div class="VideoRecomsItem__duration_icon">%interactiveIcon%</div>\n            %duration%\n          </div>'}\n  </div>\n  <div class="VideoRecomsItem__info">\n    <div class="VideoRecomsItem__title" data-task-mouseover="Video/check_title">%title%</div>\n    <div class="VideoRecomsItem__views">%views%</div>\n  </div>\n</a>\n  `,showReverseTooltip(e){(0,m.showTooltip)(e,{text:(0,a.getLang)("video_playlist_reverse_tt"),shift:[7,7,0],showdt:0,black:1})},showAutoplayTooltip(e){const _=M.isAutoplayEnabled()?(0,a.getLang)("video_playlist_autoplay_disable_tt"):(0,a.getLang)("video_playlist_autoplay_enable_tt");(0,m.showTooltip)(e,{text:_,shift:[7,7,0],showdt:0,black:1})},toggleAutoplay(e){const _=!M.isAutoplayEnabled(),i=(0,h.partConfigEnabled)("video_new_video_page")||(0,h.partConfigEnabled)("video_refactored_autoplay_btn");(0,s.toggleClass)(e,"_active",_),_?ls.remove("video_playlist_autoplay_disabled"):ls.set("video_playlist_autoplay_disabled",1),i?window.mvcur&&mvcur?.player?.ui?.controls?mvcur.player.ui.controls.toggleAutoPlayComponent():cur?.videoInlinePlayer.ui.controls.toggleAutoPlayComponent():(window.tooltips.destroy(e),M.showAutoplayTooltip(e)),b.videoAutoplayButtonStatsCollector.logEvent({event_type:_?D.VideoAutoplayButtonEventTypes.AUTOPLAY_TURN_ON:D.VideoAutoplayButtonEventTypes.AUTOPLAY_TURN_OFF,event_subtype:i?D.VideoAutoplayButtonEventSubtypes.PLAYER_CONTROLS:D.VideoAutoplayButtonEventSubtypes.PLAYLIST_BLOCK})},toggleSubscription(){if(!vk.id)return(0,v.showQuickLoginBox)(),!1;const e=M.getCurList();e&&window.ajax.post("al_video.php?act=playlist_subscribe",{playlist_raw_id:e.id,subscribe:e.is_subscribed?0:1,hash:mvcur.mvData.pl_subscription_hash,ref:Videoview.getVideoModule()},{onDone:_=>{const{ownerId:i,itemId:t}=(0,o.splitRawId)(e.id);window.dispatchEvent(new CustomEvent(P.VideoPlaylistEvents.SUBSCRIPTION_STATE_CHANGE,{detail:{ownerId:i,albumId:t,isSubscribed:Boolean(_)}})),this.setIsSubscribed(_)}})},isAutoplayEnabled:()=>!ls.get("video_playlist_autoplay_disabled"),toggleReverse(e){const _=M.getCurList();if(_){if(_.reversed=!_.reversed,_.shownFirstItemIdx||_.shownLastItemIdx){const e=_.current.split("_"),i=_.list.findIndex((_=>_[0]==e[0]&&_[1]==e[1]));_.shownFirstItemIdx=Math.max(0,i-M.VIDEOS_LIMIT),_.shownLastItemIdx=Math.min(_.list.length,_.shownFirstItemIdx+2*M.VIDEOS_LIMIT)}(0,s.toggleClass)(e,"_active",_.reversed),M.updateBlockList(_.id)}},buildBlock(e,_,i){const o=M.getBlock(),t=!!o&&(0,s.data)(o,"playlist");if(t&&t.id===e&&!i)return o;M.removeBlock();const d=M.getList(e,_);if(!d||d.size<=1&&!d.force_layout)return!1;const n=(0,c.trim)(M.blockTpl),r=M.buildBlockList(d);let l;l=(0,h.partConfigEnabled)("video_new_video_page")||(0,h.partConfigEnabled)("video_refactored_autoplay_btn")?"_hidden":M.isAutoplayEnabled()?"_active":"";let m="";if(cur.is_showcase&&M.isStoredPlaylistId(e)){const[_,i]=e.split("_");m=+_!==vk.id&&+i>0&&d.can_subscribe?1===d.list.length?"_can_subscribe_list":"_can_subscribe_header":"_can_not_subscribe"}const v=(0,s.se)((0,s.rs)(n,{items:r,title:d.title||"",size:d.size?(0,a.langNumeric)(d.size,(0,a.curLang)("video_playlist_size")):"",autoplayBtnClass:l,playlistListSubscribeTitle:(0,a.getLang)("video_player_playlist_ask_to_subscribe"),canSubscribeClass:m,loading:d.list.length>0?"":"loading"}));return(0,s.data)(v,"playlist",d),M._block=v,v},formatViewsCount:e=>e>999?(0,p.getFormattedBigViewsToShortCase)(e):(0,a.getLang)("video_N_views_list",e||1,!0),buildBlockListItem(e,_){if(!e)return;const i=(e="")=>{const _={"&":"&amp;",'"':"&quot;","'":"&#39","<":"&lt;",">":"&gt;"},i=new RegExp(Object.keys(_).join("|"),"g");return e.replace(i,(e=>_[e]||""))};let o;if((0,n.isArray)(e)){const t=e[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+e[VideoConstants.VIDEO_ITEM_INDEX_ID],s=this.formatViewsCount(e[VideoConstants.VIDEO_ITEM_INDEX_VIEWS]),d=(0,h.partConfigEnabled)("interactive_video_redesign_badge_vk")&&e[VideoConstants.VIDEO_ITEM_INDEX_INTERACTIVE],a=d?"vkcom_dark":"";o={vid:t,hash:e[VideoConstants.VIDEO_ITEM_INDEX_LIST_ID]||window.Video&&Video.getDefaultListId(),link:e[VideoConstants.VIDEO_ITEM_INDEX_LINK]||`/video${t}`,thumb:e[VideoConstants.VIDEO_ITEM_INDEX_SMALL_THUMB],thumbAlt:i(e[VideoConstants.VIDEO_ITEM_INDEX_TITLE]),title:e[VideoConstants.VIDEO_ITEM_INDEX_TITLE],duration:e[VideoConstants.VIDEO_ITEM_INDEX_DURATION],views:s,itemClass:t===_?" VideoRecomsItem--active":"",restrictionBlock:e[VideoConstants.VIDEO_ITEM_INDEX_RESTRICTION_BLOCK],restrictionClasses:e[VideoConstants.VIDEO_ITEM_INDEX_RESTRICTION_CLASSES],interactiveIcon:d?`${(0,w.getIcon12HandPointUp)().icon}`:"",interactiveClass:d?" VideoRecomsItem__duration_interactive":"",scheme:a}}else o=(0,c.extend)({link:`/video${e.vid}`},e,{itemClass:e.vid===_?" VideoRecomsItem--active":"",thumbAlt:i(e.title)});const t=Boolean(o.interactiveIcon),d=Boolean(o.restrictionBlock&&t),a=(0,c.trim)(M.blockItemTpl(d));return o.hasOwnProperty("restrictionBlock")&&o.restrictionBlock?(o.itemClass+=" VideoRestriction--onlyIcon",o.restrictionThumbClass=" VideoRestriction__thumb"):(o.restrictionBlock="",o.restrictionClasses="",o.restrictionThumbClass=""),(0,s.rs)(a,o)},buildBlockList(e){let _,i,o;e.shownFirstItemIdx||e.shownLastItemIdx?(_=function(){return e.reversed?e.shownLastItemIdx-1:e.shownFirstItemIdx},i=function(_){return e.reversed?_>=e.shownFirstItemIdx:_<e.shownLastItemIdx},o=function(_){return e.reversed?--_:++_}):(_=function(){return e.reversed?e.list.length-1:0},i=function(_){return e.reversed?_>=0:_<e.list.length},o=function(_){return e.reversed?--_:++_});let t="";for(let s=_();i(s);s=o(s))t+=this.buildBlockListItem(e.list[s],e.current);return t},processScroll(){if(M.disableScrollLoading)return;const e=(0,s.geByClass1)("mv_playlist_list"),_=(0,s.geByClass1)("mv_playlist_load_top"),i=(0,s.geByClass1)("mv_playlist_load_bottom");let o;if(e.offsetHeight+Math.round(e.scrollTop)>=e.scrollHeight&&!(0,s.isVisible)(i))o=!0;else{if(0!==e.scrollTop||(0,s.isVisible)(_))return;o=!1}let t=this.getCurList();if(!t)return;const d=o&&!t.reversed||!o&&t.reversed;if(void 0!==t.shownFirstItemIdx||void 0!==t.shownLastItemIdx){if(d&&t.loadBottomIsFull&&t.shownLastItemIdx===t.size||!d&&0===t.shownFirstItemIdx)return}else if(d&&t.loadBottomIsFull||!d&&!t.loadFirstItemIdx)return;d&&!t.loadBottomIsFull&&(o?(0,s.show)(i):(0,s.show)(_));let a,n,r,[l]=this.getLoadedPlaylistData(...t.id.split("_"));if(t.list.length<l.length){const e=l.findIndex((e=>e?.[1]==t.list[t.shownFirstItemIdx]?.vid?.split("_")?.[1]));t.list=l,t.shownFirstItemIdx=e,t.shownLastItemIdx=Math.min(l.length,t.shownFirstItemIdx+2*M.VIDEOS_LIMIT),t.loadFirstItemIdx=0,t.loadLastItemIdx=l.length}if(this.isStoredPlaylistId(t.id)){let e=[];if(d?(a=t.shownLastItemIdx,n=a+M.VIDEOS_LIMIT,e=l.slice(a,n),t.shownLastItemIdx+=e.length,t.shownFirstItemIdx=Math.max(0,t.shownLastItemIdx-2*M.VIDEOS_LIMIT)):(a=Math.max(0,t.shownFirstItemIdx-M.VIDEOS_LIMIT),n=Math.min(t.shownFirstItemIdx,a+M.VIDEOS_LIMIT),e=l.slice(a,n),t.shownFirstItemIdx-=e.length,t.shownLastItemIdx=Math.min(t.shownLastItemIdx,t.shownFirstItemIdx+2*M.VIDEOS_LIMIT)),e.length){if((0,s.data)(this.getBlock(),"playlist",t),this.addVideosToBlockList(e,o,t.reversed,!0),e.length>=M.VIDEOS_LIMIT)return;d?(a=t.shownLastItemIdx,n=a+M.VIDEOS_LIMIT,t.loadBottomIsFull||(o?(0,s.show)(i):(0,s.show)(_))):(a=Math.max(0,t.shownFirstItemIdx-M.VIDEOS_LIMIT),n=a+Math.min(t.shownFirstItemIdx,M.VIDEOS_LIMIT))}}if(d&&cur.showcaseSection&&cur.catPlaylistId===t.id){const e=(0,s.ge)("ui_"+cur.showcaseSection+"_load_more");return void((0,s.isVisible)(e)?Video.showMoreShowcase(cur.showcaseSection,e):this.setCurPlaylistBottomAsFull())}if(!this.isStoredPlaylistId(t.id))return t.loadBottomIsFull=!0,(0,s.data)(this.getBlock(),"playlist",t),void(o?(0,s.hide)(i):(0,s.hide)(_));r=d?{playlist_raw_id:t.id,offset:Math.max(t.loadLastItemIdx,l.length),limit:8*M.VIDEOS_LIMIT}:{playlist_raw_id:t.id,offset:Math.max(0,t.loadFirstItemIdx-M.VIDEOS_LIMIT),limit:Math.min(t.loadFirstItemIdx,8*M.VIDEOS_LIMIT)};const c=this._getVideoTrackCode(t.current);c&&(r.current_video_track_code=c),window.ajax.post("al_video.php?act=load_playlist_videos",r,{onDone:(e,r,c)=>{if(t=this.getCurList(),d){if(!e||0===e.length)return t.loadBottomIsFull=!0,(0,s.data)(this.getBlock(),"playlist",t),void(o?(0,s.hide)(i):(0,s.hide)(_));const d=t.list.map((e=>e.vid));for(let _=0;_<e.length&&d.includes(e[_].vid);_++)e.splice(_,1);l.push(...e),t.list=[...t.list,...e],t.loadLastItemIdx=c,t.shownLastItemIdx=Math.min(c,n),t.shownFirstItemIdx=Math.max(0,t.shownLastItemIdx-2*M.VIDEOS_LIMIT),t.loadBottomIsFull=c>=t.size}else l.unshift(...e),t.list=[...e,...t.list],t.loadFirstItemIdx=Math.max(r,0),t.shownFirstItemIdx=Math.max(r,a,0),t.shownLastItemIdx=Math.min(t.shownLastItemIdx,t.shownFirstItemIdx+2*M.VIDEOS_LIMIT);(0,s.data)(this.getBlock(),"playlist",t),this.addVideosToBlockList(l.slice(a,n),o,t.reversed,!0)},onFail:()=>{M.disableScrollLoading=!0,o?(0,s.hide)(i):(0,s.hide)(_),setTimeout((()=>{M.disableScrollLoading=!1}))}})},loadPlaylistByVideo(e,_){const i=(0,s.geByClass1)("mv_playlist_load_bottom");(0,s.isVisible)(i)||((0,s.show)(i),window.ajax.post("al_video.php?act=load_playlist_videos",{playlist_raw_id:e,video_raw_id:_},{onDone:(_,o,t,d)=>{(0,s.hide)(i);let a=this.getCurList();if(a&&!_)return a.loadBottomIsFull=!0,void(0,s.data)(this.getBlock(),"playlist",a);a.size=d,a.list=_,a.loadFirstItemIdx=o,a.loadLastItemIdx=t,a.shownFirstItemIdx=Math.max(0,Math.floor(_.length/2)-M.VIDEOS_LIMIT),a.shownLastItemIdx=Math.min(_.length,d,a.shownFirstItemIdx+2*M.VIDEOS_LIMIT),a.loadBottomIsFull=a.loadLastItemIdx>=a.size,(0,s.data)(this.getBlock(),"playlist",a),this.updateBlockList(e)},onFail:()=>{(0,s.hide)(i)}}))},setCurPlaylistBottomAsFull(){let e=this.getCurList();e.loadBottomIsFull=!0,e.reversed?(0,s.hide)((0,s.geByClass1)("mv_playlist_load_top")):(0,s.hide)((0,s.geByClass1)("mv_playlist_load_bottom")),(0,s.data)(this.getBlock(),"playlist",e)},addVideosToBlockList(e,_=!0,i=!1,o=!1){const t=M.getBlock(),d=(0,s.geByClass1)("mv_playlist_list_cont",t),a=(0,s.geByClass1)("mv_playlist_list");if(_?(0,s.hide)((0,s.geByClass1)("mv_playlist_load_bottom")):(0,s.hide)((0,s.geByClass1)("mv_playlist_load_top")),!e?.length)return;const n=(0,s.data)(t,"playlist");n.id===window.Video?.VIDEO_GLOBAL_SEARCH_TYPE&&(n.list=[...n.list,...e],(0,s.data)(this.getBlock(),"playlist",n));let r=document.createDocumentFragment();const l=2*M.VIDEOS_LIMIT,c=[...d.children],m=c.length,v=e.length;if(_){const _=m>=l-v?m-l+v:0;if(o)for(let e=_;e<m;e++)r.appendChild(c[e]);if(i)for(let _=e.length-1;_>=0;_--)r.appendChild((0,s.se)(this.buildBlockListItem(e[_])));else for(let _=0;_<e.length;_++)r.appendChild((0,s.se)(this.buildBlockListItem(e[_])));o?(d.innerHTML="",d.appendChild(r),a.scrollTop=a.scrollTop-M.VIDEO_ITEM_HEIGHT*_):d.appendChild(r)}else{if(o){const e=m+v>=l?l-v:m;for(let _=0;_<e;_++)r.appendChild(c[_])}if(i)for(let _=0;_<e.length;_++)r.prepend((0,s.se)(this.buildBlockListItem(e[_])));else for(let _=e.length-1;_>=0;_--)r.prepend((0,s.se)(this.buildBlockListItem(e[_])));o?(d.innerHTML="",d.appendChild(r)):d.prepend(r),a.scrollTop=a.scrollTop+M.VIDEO_ITEM_HEIGHT*e.length}this.updateScrollbar()},updateBlockList(e){const _=M.getCurList();if(!_||_.id!=e)return;const i=M.getBlock(),o=(0,s.geByClass1)("mv_playlist_list_cont",i),t=M.buildBlockList(_);(0,s.val)(o,t);const d=(0,s.data)(i,"sb");d&&d.update(),M.setCurVideo(_.current),M.updateControls()},getBlock:()=>M._block,removeBlock(){const e=(0,s.data)(M._block,"sb");e&&(e.destroy(),(0,l.removeEvent)((0,s.geByClass1)("mv_playlist_list"),"scroll")),(0,s.re)(M._block),(0,s.removeData)(M._block),M._block=null,M.toggleStateClasses(),M.updateControls()},setIsSubscribed(e){const _=M.getBlock();if(!_)return;const i=(0,s.data)(_,"playlist");if(!i)return;void 0!==e&&(i.is_subscribed=!!e);let o=i.is_subscribed?(0,a.getLang)("video_player_playlist_subscribed"):(0,a.getLang)("video_player_playlist_subscribe");(0,s.geByClass1)("mv_playlist_header_subscribe_btn",_).innerHTML=o,(0,s.geByClass1)("mv_playlist_list_subscribe_btn",_).innerHTML=o,(0,s.toggleClass)(_,"_is_subscribed",i.is_subscribed)},setCurVideo(e,_){const i=M.getBlock();if(!i)return;const o=(0,s.data)(i,"playlist");if(!o)return;e&&(o.current=e);let t=(0,s.domByClass)(i,"VideoRecomsItem--active");if(e&&((0,s.removeClass)(t,"VideoRecomsItem--active"),t=(0,s.ge)("mv_playlist_video"+e),(0,s.addClass)(t,"VideoRecomsItem--active")),t){const o=(0,s.geByClass1)("mv_playlist_list",i),a=(0,s.getXY)(t)[1],n=(0,s.getSize)(t)[1],l=(0,s.getXY)(o)[1],c=(0,s.getSize)(o)[1],m=a-l;if(m<0||m+n>c){const e=o.scrollTop+a-l-c/2+n/2;o.scrollTop!=e&&(_?(0,r.animate)(o,{scrollTop:e,transition:r.Fx.Transitions.easeOutCubic},450,d):(o.scrollTop=e,d()))}(0,p.idlizeCall)((()=>{M._queueNextVideo(e)}),5e3)}function d(){const e=M.getBlock();if(e){const _=(0,s.data)(e,"sb");_&&_.update()}}},isWallPlaylistId:e=>/^wall_-?\d+$/.test(e),isPostPlaylistId:e=>/^post_-?\d+_\d+$/.test(e),isCatPlaylistId:e=>/^cat_(\d|[\w_])+$/.test(e),isStoredPlaylistId:e=>/^-?\d+_-?\d+$/.test(e),getList(e,_){if(M.VIDEOS_LIMIT=2*Math.floor(window.innerHeight/M.VIDEO_ITEM_HEIGHT)||M.VIDEOS_LIMIT,this.lists[e]&&!cur.currentSortings?.[`playlist_${e.split("_")[1]}`]){const i=this.lists[e].list.map((e=>e.vid));if((0,c.inArray)(_,i))return this.lists[e]}if(M.isWallPlaylistId(e))return cur.wallVideos&&cur.wallVideos[e]&&this.uniqList(cur.wallVideos[e]);if(M.isPostPlaylistId(e)||"feed_recommends"===e)return cur.pageVideosList&&cur.pageVideosList[e];if(M.isCatPlaylistId(e))return cur.catVideosList&&cur.catVideosList[e];if(!M.isStoredPlaylistId(e))return;const[i,o]=e.split("_");let t,[s,d,a]=this.getLoadedPlaylistData(i,o);if(!s||!s.length)return;if(_)for(let e=0;e<s.length;e++){const i=s[e];i[0]+"_"+i[1]===_&&(t=e)}let n=s.length;cur.videosCount&&cur.videosCount[i]&&cur.videosCount[i][d]&&(n=cur.videosCount[i][d]);let r=0,l=s.length;const m=s.length;s.length>2*M.VIDEOS_LIMIT&&(r=Math.max(0,t-M.VIDEOS_LIMIT),l=Math.min(s.length,r+2*M.VIDEOS_LIMIT));let v=!1;window.mvcur&&void 0!==mvcur.pl_is_subscribed?v=mvcur.pl_is_subscribed:void 0!==cur.isPlaylistSubscribed&&(v=cur.isPlaylistSubscribed);let E={id:e,title:a,list:s,size:n,loadFirstItemIdx:0,loadLastItemIdx:m,shownFirstItemIdx:r,shownLastItemIdx:l,loadBottomIsFull:s.length>=n,force_layout:!(!window.mvcur||!mvcur.forcePlaylistLayout),is_subscribed:v};return void 0===t&&_&&(this.loadPlaylistByVideo(e,_),E.force_layout=!0,E.shownFirstItemIdx=0,E.loadBottomIsFull=!0),E},getLoadedPlaylistData(e,_){let i,o,s=[];-2==_?(i="all",o=cur.playlistAddedTitle):-1==_?(i="uploaded",o=cur.playlistUploadedTitle):cur.is_showcase?(i="playlist_"+_,o=cur.playlistTitle):(i="album_"+_,o=cur.playlistTitle),(0,c.each)([cur.silentLoaded,cur.pageVideosList],((_,o)=>{if(o&&o[e]&&o[e][i])return s=o[e][i].list||o[e][i],!1}));const d=(0,t.joinRawId)({ownerId:e,itemId:_}),a=this.lists[i]||(this.lists[d]?.list??this.lists[d]);return s&&s.length||!a||(s=[...a]),[s,i,o]},getCurList(){const e=M.getBlock();if(e)return(0,s.data)(e,"playlist")},getCurListId(){const e=M.getCurList();if(e)return e.id},addList(e){e.size=e.size||e.list.length,e.loadFirstItemIdx=0,e.loadLastItemIdx=e.list.length,e.shownFirstItemIdx=0,e.shownLastItemIdx=e.list.length,e.loadBottomIsFull=!1,this.lists[e.id]=e},extendList(e,_){if(!this.lists[e])return!1;const i=this.lists[e].list,o=[],t={};let s=0,d=0;for(;;)if(i[s]&&_[d]&&i[s].vid==_[d].vid)t[i[s].vid]||(o.push(i[s]),t[i[s].vid]=1),++s,++d;else if(i[s])t[i[s].vid]||(o.push(i[s]),t[i[s].vid]=1),++s;else{if(!_[d])break;t[_[d].vid]||(o.push(_[d]),t[_[d].vid]=1),++d}return this.lists[e].list=o,this.lists[e]},uniqList(e){const _={};for(let i,o=0;i=e.list[o];++o)_[i.vid]?e.list.splice(o,1):_[i.vid]=!0;return e},isCollapsed(){const e=M.getBlock();return!(!e||!(0,s.data)(e,"collapsed"))},toggle(e,_){if(void 0===e&&(e=M.isCollapsed()),window.mvcur?.minimized&&e)return;const i=M.getBlock();return i&&M.isCollapsed()!=!e?((0,s.data)(i,"collapsed",!e),M.toggleStateClasses(),Videoview.playerOnResize(),Videoview.updateReplyFormPos(),e&&setTimeout((()=>{M.updateScrollbar(),M.setCurVideo()})),!1):void 0},toggleStateClasses(){const e=!!M.getBlock(),_=Videoview.isMinimized(),i=M.isCollapsed();(0,s.toggleClass)("mv_box","_has_playlist",e&&!_),(0,s.toggleClass)("mv_box","_hide_playlist",e&&!_&&i);let o="";e&&((0,s.toggleClass)("mv_box","_hide_recomms",!i),o=i?(0,a.getLang)("video_aria_expand_playlist"):(0,a.getLang)("video_aria_minimize_playlist")),(0,s.attr)("mv_top_pl_toggle","aria-label",o)},updateScrollbar(){const e=M.getBlock();if(!e)return;const _=(0,s.data)(e,"sb");if(_)_.update(!0,!0);else{const _=(0,s.geByClass1)("mv_playlist_list",e),i=(0,h.partConfigEnabled)("video_import_scrollbar")?new O.default(_,{prefix:"mv_pl_",nokeys:!0,padding:0}):new window.Scrollbar(_,{prefix:"mv_pl_",nokeys:!0,padding:0});(0,s.data)(e,"sb",i),(0,l.addEvent)((0,s.geByClass1)("mv_playlist_list"),"scroll",this.processScroll.bind(this))}},updateControls(){const e=M.getCurList();let _=M.getVideoIndex();e&&e.reversed&&(_=e.list.length-_-1);const i=!!e&&_>0,o=!!e&&_<e.list.length-1,t=document.querySelector("#mv_pl_prev"),s=document.querySelector("#mv_pl_next");t&&(t.style.display=i?"block":"none"),s&&(s.style.display=o?"block":"none"),mvcur.player?.ui.controls.onShowNextChanged(o)},showVideo(e,_,i){if(i&&(0,l.checkEvent)(i))return!0;const o=M.getCurList();if(o){if(M.saveScrollPos(),mvcur.options.params&&"direct"===mvcur.options.params.module&&mvcur.mvPrevLoc&&Videoview.backLocation(),o.loaded&&o.loaded.vid===e){const _=o.loaded,i={playlistId:o.id},t=this._getVideoTrackCode(e);t&&(i.addParams={track_code:t}),Videoview.show(null,e,_.listId,(0,c.extend)(_.options,i)),Videoview.showVideo.apply(Videoview,_.hubData);const s=mvcur.preloadStatsHashes?mvcur.preloadStatsHashes[e]:"";s&&(0,p.idlizeCall)((()=>{ajax.post("al_video.php?act=a_inc_preload_stats",{stat_preload_hash:s})}))}else{const i=M.getVideoIndex(e),t=(o.reversed?o.list.length-1-i:i)<o.list.length-1?1:0,s={autoplay:1,playlistId:o.id,addParams:{force_no_repeat:1,show_next:t},module:this.module??Videoview.getVideoModule()},a=this._getVideoTrackCode(e);a&&(s.addParams.track_code=a),(0,d.showVideo)(e,_,s)}return!1}},saveScrollPos(){const e=M.getBlock(),_=(0,s.domByClass)(e,"mv_playlist_list");(0,s.data)(e,"savedScrollTop",_.scrollTop)},restoreScrollPos(){const e=M.getBlock(),_=(0,s.domByClass)(e,"mv_playlist_list"),i=(0,s.data)(e,"savedScrollTop");i&&(_.scrollTop=i)},_queueNextVideo(e){const _=M.getCurList();if(!_)return;e=e||_.current;const i=+M._getNextVideoIndex(e);if(-1===i)return;const o=_.list[i],t=(0,n.isArray)(o)?o[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+o[VideoConstants.VIDEO_ITEM_INDEX_ID]:o.vid,s=(0,n.isArray)(o)?o[VideoConstants.VIDEO_ITEM_INDEX_LIST_ID]:o.hash;if(_.queued===t)return;if(_.loaded&&_.loaded.vid===t)return;_.loaded=!1,_.queued=t;const a=(_.reversed?_.list.length-i:i)<_.list.length-1?1:0,r={hidden:function(e,i,o,t){_.queued===t&&(_.loaded={vid:t,hubData:e,options:i,listId:o||window.Video&&Video.getDefaultListId()}),_.queued=!1},module:this.module??Videoview.getVideoModule(t),is_similar:!0,addParams:{autoplay:1,force_no_repeat:1,preload:1,show_next:a,playlist_id:_.id},fromPlayer:!0};r.addParams.track_code=o[VideoConstants.VIDEO_ITEM_TRACK_CODE]||o.trackCode,(0,d.showVideo)(t,s,r)},getNextVideos(){const e=[];if(!(M.isAutoplayEnabled()||window.mvcur&&mvcur.player))return e;const _=M.getCurList();let i=M._getNextVideoIndex();if(!_||i<0)return e;for(;e.length<3&&i>=0&&i<_.list.length;){const o=_.list[i];let t;t=(0,n.isArray)(o)?{vid:o[VideoConstants.VIDEO_ITEM_INDEX_OWNER_ID]+"_"+o[VideoConstants.VIDEO_ITEM_INDEX_ID],thumb:o[VideoConstants.VIDEO_ITEM_INDEX_THUMB],views:(0,a.getLang)("video_N_views_list",o[VideoConstants.VIDEO_ITEM_INDEX_VIEWS],!0),title:o[VideoConstants.VIDEO_ITEM_INDEX_TITLE],duration:o[VideoConstants.VIDEO_ITEM_INDEX_DURATION]}:o,e.push(t),i+=_.reversed?-1:1}return e},prevVideo(){const e=M.getCurList();if(!e)return;const _=M.getVideoIndex()+(e.reversed?1:-1);if(_<0)return;const i=e.list[_],o=(0,n.isArray)(i)?i[0]+"_"+i[1]:i.vid;M.showVideo(o)},nextVideo(){const e=M.getCurList();if(!e)return;const _=M._getNextVideoIndex();if(_<0)return;const i=e.list[_],o=(0,n.isArray)(i)?i[0]+"_"+i[1]:i.vid;M.showVideo(o)},getVideoIndex(e){const _=M.getCurList();if(!_)return-1;if(e||(e=_.current),!e)return-1;let i=-1;return(0,c.each)(_.list,((_,o)=>{if(((0,n.isArray)(o)?o[0]+"_"+o[1]:o.vid)==e)return i=_,!1})),i},_getNextVideoIndex(e){const _=M.getCurList();if(!_)return-1;const i=M.getVideoIndex(e);if(i<0)return 0;const o=i+(_.reversed?-1:1);return o>=0&&o<_.list.length?o:-1},_getVideoTrackCode(e){const _=M.getVideoIndex(e),i=this.getCurList();if(-1===_||!i)return null;const o=i.list[_];return o[VideoConstants.VIDEO_ITEM_TRACK_CODE]||o.trackCode},onImageError(e){e.parentNode.removeChild(e)}}},524957:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _web_lib_dom__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(754866),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(575753),_web_lib_video__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(432081),_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(102088),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(636576),_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(749284),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(226220),_shared_lib_parse__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(261910),_web_lib_date__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(101148),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(972332),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(246429),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(593159),_vkontakte_internal_plugins_APIClient_APIClientDeprecatedImpl__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(848603),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(8520),_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(683234),_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(996849),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(270959),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(342879),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(237625),_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(898848),_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(939646),_web_likes_helpers__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(890332),_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(576854),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(540462),_video_playlist__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(932153),_video_initializer__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(557907),_player_callback__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(314310),_web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(250598),_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(251703),_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(65759),_web_index__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(412573),_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(101272),_web_video_video_utils__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(826619),_icons_desktop__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(587904),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(952661),_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(111922),_shared_groups_constants__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(3171),_web_videoplayer_lib_live_phases__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(461388),_web_likes_likes_constants__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(527095),_shared_lib_throttle__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(150585),_shared_lib_debounce__WEBPACK_IMPORTED_MODULE_62__=__webpack_require__(740342),_web_videoview_GoodsRecognition_init__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(774753),_shared_ranges__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(810068),_web_search_SearchTop_constants__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(626586),_shared_video__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(856289),_web_VideoShowcase_snackbar_watchLater__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(3820),_shared_stickers_refactor_utils_popup_getDataAttrs__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(924712),_web_videoview_components_LiveInfo_store__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(421954),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(984745),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(632731),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_61__=__webpack_require__(361121),_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_63__=__webpack_require__(538522),_vkontakte_internal_plugins__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(882044),_shared_stickers_refactor_utils_popup_constants__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(126075),_shared_catalog_common_constants__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(373594),_shared_utils_replaceHashtags__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(485910),_shared_production_stats__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(314309),_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(317216),_web_lib_snackbar__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(432465),_web_VideoModal_utils__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(406805),_web_video_handlers__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(636826),_web_feed_utils_updatePost__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(68586),_web_videoplayer_ui_loading_state__WEBPACK_IMPORTED_MODULE_60__=__webpack_require__(299692),_web_video_constants__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(977780);const CONTAINER_MIN_WIDTH=960,CONTAINER_SIDE_PADDING=72,CONTAINER_VERTICAL_SIDE_PADDING=15,INFO_HEADER_PADDING_DEFAULT=115,VIDEO_RATIO_DEFAULT=16/9;function getVideoModalBlocks(){return Promise.resolve().then(__webpack_require__.bind(__webpack_require__,770919))}function getInteractiveVideoOnboardingChunk(){return Promise.all([__webpack_require__.e(91498),__webpack_require__.e(89631),__webpack_require__.e(61899),__webpack_require__.e("langs/web/interactive_video_onboarding")]).then(__webpack_require__.bind(__webpack_require__,208574))}function getVideoRestoreButton(){return Promise.all([__webpack_require__.e(73538),__webpack_require__.e("langs/web/video_restore_button")]).then(__webpack_require__.bind(__webpack_require__,69727))}const __WEBPACK_DEFAULT_EXPORT__={FLASH_MIN_VERSION:24,isFS:!1,isHighloadLive:!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_live_highload"),playerCallback:_player_callback__WEBPACK_IMPORTED_MODULE_24__.default,onScrollHandler:null,watchLaterTooltip:null,videoApi:new _vkontakte_internal_plugins__WEBPACK_IMPORTED_MODULE_52__.VideoApi(new _vkontakte_internal_plugins_APIClient_APIClientDeprecatedImpl__WEBPACK_IMPORTED_MODULE_53__.APIClientDeprecatedImpl),cleanUpStoredVSegs(){if(!window.localStorage)return;const e=Date.now();for(let _ in window.localStorage)if(0===_.indexOf("vsegs")){let i=localStorage.getItem(_);i=JSON.parse(i),e-i.ts>1728e5&&localStorage.removeItem(_)}},getVideoModule(){let e=cur.currentModule?cur.currentModule():cur.module;return cur.storyLayer?"story":window.VideoUpload&&nav.objLoc.hasOwnProperty("section")&&"upload"===nav.objLoc.section?"upload":(window.Video&&Video.isInVideosList()&&(e=_shared_ranges__WEBPACK_IMPORTED_MODULE_37__.Ranges.isGroupId(cur.oid)?"community_videos":cur.oid==vk.id?"profile_own_videos":"profile_videos"),"feed"==e&&"feed_block"==_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getCurListId()&&(e="feed_block"),"feed"==e&&"videos"==cur.section&&(e="feed_videos"),"feed"==e&&"live"==cur.section&&(e="feed_live"),"feed"===e&&"videos_for_you_block"===_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.module&&(e=_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.module),e||"")},getVideoContext(){if("video_search"===Videoview.getVideoModule())return nav.objLoc.q;if("audio"===cur.module){const e=cur.audioPage&&cur.audioPage.getCurrentSection();if(e)return e;if(0===nav.strLoc.indexOf("artist/"))return"artist_page"}return""},getContextPlaylistId:()=>window.mvcur?.options?.playlistId,getLayoutType(){const e=Videoview.getPlayerObject();if(e?.isFullscreen?.())return"fullscreen";const _=Videoview.getMvData();if(_){if(_.inline)return"inline";if(_.embed)return"embed"}return Videoview.isLayerShown()?Videoview.isMinimized()?"minimized":window.mvcur?.options?.playlistId?"layer_with_playlist":"layer":cur.storyLayer&&cur.storyLayer.activeStory.isActiveLive()?"story_layer":""},sendPlayerStats(e,_){(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_remove_a_player_stat_act")||window.ajax.post("al_video.php?act=a_player_stat",{action:e,type:_})},otherVideosStats(e={}){(0,_web_video_video_utils__WEBPACK_IMPORTED_MODULE_30__.idlizeCall)((()=>{window.ajax.post("al_index.php?act=a_other_videos_navigation",e)}))},onMoreActionsMenuToggle:(e,_)=>{if(_)uiActionsMenu.show(e,null,{autopos:!0,dy:6});else{if(Videoview.watchLaterTooltip)return;uiActionsMenu.hide(e,null)}(()=>{const e=document.querySelector("[data-videoview-bookmarked]"),_=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_bookmarks_renaming_to_watch_later"),i=(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_54__.ensureAccountHelpHintsService)().$helpHints.getState()[_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_55__.AvailableHelpHints.ACCOUNT_HINT_VIDEO_WATCH_LATER_ACTION];if(!e||!_||!i||window.isVideoWatchLaterTooltipViewed)return;const o=()=>{(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_54__.ensureAccountHelpHintsService)().hideHelpHint({hintId:_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_55__.AvailableHelpHints.ACCOUNT_HINT_VIDEO_WATCH_LATER_ACTION,isOptimistic:!0}),Videoview.watchLaterTooltip?.destroy(),Videoview.watchLaterTooltip=null,window.isVideoWatchLaterTooltipViewed=!0};Videoview.watchLaterTooltip=new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_25__.ElementTooltip(e,{content:`<div class="VideoLayerInfo__watchLaterTooltipTitle">${i.title}</div>${i.description}`,width:262,forceSide:"top",align:"center",withCloseButton:!1,appendToParent:!0,autoAdjustToViewport:!1,cls:"VideoLayerInfo__watchLaterTooltip",autoShow:!1,onBeforeHide:o,onClick:o}),Videoview.watchLaterTooltip?.show()})()},removeVideo(){const e=Videoview.getMvData();e&&(e.mvShown||(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_remove_a_delete_from_all_albums_act")&&e.deleteFromAllAlbumsHash?window.ajax.post("al_video.php?act=a_delete_from_all_albums",{vid:e.vid,oid:e.oid,target_id:vk.id,hash:e.deleteFromAllAlbumsHash}):(0,_web_video_handlers__WEBPACK_IMPORTED_MODULE_49__.removeVideoFromMy)({video_id:e.vid,owner_id:e.oid,target_id:vk.id}).catch()),e.playlists&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)(e.playlists,((e,_)=>{_.added=!1})),window.mvcur&&Videoview.initAddButton(),e.added=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_finish_add","mv_external_finish"),"selected"))},bookmarkVideo(e=!1,_=1,i){const o=Videoview.getMvData(),t=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_bookmarks_renaming_to_watch_later");if(_=t?0:_,o&&o.bookmarkHash){const s=cur.is_showcase?"showcase":"";window.bookmark(o.oid,o.vid,o.bookmarkType,o.bookmarkHash,e,o.itemAccessHash,s,"",_,i),t&&(0,_web_VideoShowcase_snackbar_watchLater__WEBPACK_IMPORTED_MODULE_40__.showWatchLaterSnackbar)({isBookmarked:e,rollbackCallback:()=>{Videoview?.getPlayerObject()?.bookmark(void 0,_shared_catalog_common_constants__WEBPACK_IMPORTED_MODULE_43__.FAVORITE_SOURCES.SNACKBAR)}});const d=document.querySelector("[data-videoview-bookmarked]");d&&(e=!e,d.innerHTML=t?e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_remove_from_watch_later_plain_text"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_catalog_showcase_section_my_watch_later_title"):e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_remove_from_bookmarks"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_add_to_bookmarks"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(d,"videoview-bookmarked",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(e)))}},bookmarkVideoFromMenu(e){const _=!!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(e,"videoview-bookmarked"));Videoview.bookmarkVideo(_,1,_shared_catalog_common_constants__WEBPACK_IMPORTED_MODULE_43__.FAVORITE_SOURCES.VIDEO_PLAYER_MODAL);const i=Videoview.getPlayerObject();i&&i.onBookmarked&&i.onBookmarked(_shared_catalog_common_constants__WEBPACK_IMPORTED_MODULE_43__.FAVORITE_SOURCES.VIDEO_PLAYER_MODAL)},getNextVideosData:()=>_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getNextVideos().slice(0,3),getSuggestionsData(){const e=Videoview.getMvData();return e&&e.playerSuggestions||[]},getMvData:()=>cur.mvOpts||window.mvcur?.mvData,getPlayerObject:()=>window.mvcur?.player||cur.videoInlinePlayer||document.getElementById("video_yt")&&window.VideoYoutube||null,getTimeCodes:()=>Videoview.getPlayerObject?.()?.getTimeCodes()||[],setTimeCodes(e){try{const _=JSON.parse(e);Array.isArray(_)&&(Videoview.getPlayerObject?.()?.updateTimeCodes?.(_),_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList?.reDraw())}catch(e){}},getThumbFromTime(e,_){const i=Videoview.getPlayerObject();return i?i.ui.getThumbFromTime(e,_):{}},playerOnAdded(){const e=Videoview.getPlayerObject();e&&e.onAdded&&e.onAdded()},playerOnLiked(e){const _=Videoview.getPlayerObject();_&&_.onLiked&&_.onLiked(e)},playerOnResize(){window.mvcur?.player?.resize();const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("video_player"),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(e,"VideoPlayer--minimizedSmall",_[0]<500||_[1]<200)},playerNextTimerUpdate(){let e;mvcur.scrolledAway||mvcur.replyFormShown||"visible"!=document.visibilityState||(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.curBox)()?(e="nextTimerReset",mvcur.nextTimerStopped=!0):(e="nextTimerStart",mvcur.nextTimerStopped=!1),mvcur.playerPrevTimerFunc!=e&&(mvcur.playerPrevTimerFunc=e,clearTimeout(mvcur.playerTimerDebounce),mvcur.playerTimerDebounce=setTimeout((function(){const _=Videoview.getPlayerObject();_&&_[e]&&_[e](),mvcur.nextTimer&&mvcur.nextTimer[e]&&mvcur.nextTimer[e]()}),0))},togglePlay(e,_){if(document.getElementById("video_yt")&&window.VideoYoutube)return void VideoYoutube.togglePlay(e);if(window.mvcur?.mvData?.restriction||window.mvcur?.isInteractiveOnboardingShowed)return;const i=window.mvcur?.player||cur.videoInlinePlayer;if(window.mvcur?.player||cur.videoInlinePlayer){i.isAutoplay()&&!_||i.togglePlay(e)}},sendVideoAdStat(e,_,i){if(!cur._vadStatQueue||!cur._vadStatQueue[e+"_"+_])return;const o=cur._vadStatQueue[e+"_"+_];o.events.length&&(window.ajax.post("al_video.php?act=ads_stat",{ev:o.events.join(","),ad_type:o.type,hash:i,oid:e,vid:_,err:o.err,pl_type:o.pl_type,app_version:o.app_version,module:Videoview.getVideoModule()}),o.events=[])},subscribeToAuthor(e,_={}){const i=Videoview.getMvData(),{authorFirstName:o="",from:t="videoview",subscribeBlockId:s="mv_subscribe_block",subscribedCssClass:d="mv_state_subscribed"}=_;if(e||!i.isClosedGroup&&!i.isFriend)a();else{let e,_;i.isFriend?(e=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_unfollow_friend_title"),_=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.langStr)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_unfollow_friend_text"),"user",o)):(e=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_leave_closed_group_title"),_=i.adminLevel>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_33__.GroupAdminLevel.EDITOR?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_leave_admined_group_text"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_leave_closed_group_text"));const t=function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.curBox)().hide(),a()};(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)(e,_,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("box_yes"),t,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("box_no")),Videoview.playerNextTimerUpdate()}function a(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(s,d,e),window.ajax.post("al_video.php?act=a_subscribe",{author_id:i.authorId,video:i.videoRaw,hash:i.subscribeHash,unsubscribe:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(!e),from:t},{}),i.subscribed=e;const _=Videoview.getPlayerObject();_&&_.onSubscribed&&_.onSubscribed(e);const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_finish_subscribe_btn");o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(o,e?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_view_subscribed_msg"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_view_subscribe_to_author")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_finish_subscribe","mv_finish_subscribed",e))}e&&_shared_ranges__WEBPACK_IMPORTED_MODULE_37__.Ranges.isUserId(i.oid)&&i.authorNameGenitive&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.showDoneBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_friend_subscribe_result_msg").replace("{user_genetive}",i.authorNameGenitive))},showDonateBox(){if(!vk.id)return void(0,_web_index__WEBPACK_IMPORTED_MODULE_28__.showQuickLoginBox)();const e=Videoview.getMvData();e&&(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("al_video.php?act=donate_box",{video:e.videoRaw},{onDone(e,_){window.VideoDonate?.init(_)},params:{hideButtons:1,onDestroy:window.VideoDonate?.onDestroy},stat:[window.jsc("web/video_donate.js"),window.jsc("web/tooltips.js"),"tooltips.css"]})},showNextTooltip(e){const _=7-Math.floor(e.offsetHeight/2);(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTitle)(e,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_player_next_video_tt"),"",{className:"tt_black tt_right VideoLayerInfo__itemTooltip",shift:[33,_,0],slideX:5,needLeft:1,dir:"right",appendEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_playlist_controls_icon",e)})},showPrevTooltip(e){const _=7-Math.floor(e.offsetHeight/2);(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTitle)(e,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_player_prev_video_tt"),"",{className:"tt_black VideoLayerInfo__itemTooltip",shift:[-57,_,0],slideX:5,dir:"left",appendEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_playlist_controls_icon",e)})},showCloseTooltip(e,_=!1){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTitle)(e,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_player_close_tt"),"",{className:"tt_black tt_right VideoLayerInfo__itemTooltip",shift:[33,_?-36:-16,0],slideX:5,needLeft:1,dir:"right"})},showCollapseTooltip(e,_=!1){(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTitle)(e,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_player_collapse_tt"),"",{className:"tt_black tt_right VideoLayerInfo__itemTooltip",shift:[33,_?-20:-15,0],slideX:5,needLeft:1,dir:"right"})},showVideoViewTooltip(e){let _="";if(mvcur.chatMode)_="video_player_"+(window.VideoChat?.isHidden()?"show":"hide")+"_chat_tt";else{let e=!0;if(_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getBlock())e=_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.isCollapsed();else{const _=document.getElementById("mv_box");_.classList.contains("_has_recomms")&&(e=_.classList.contains("_hide_recomms"))}_="video_player_"+(e?"show":"hide")+"_video_list_tt"}(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTitle)(e,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)(_),"",{className:"tt_black tt_right VideoLayerInfo__itemTooltip",shift:[33,-14,0],slideX:5,needLeft:1,dir:"right"})},addPlaylist(onlyPrivate){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("al_video.php?act=add_playlist_box",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,only_private:onlyPrivate?1:0,hash:mvcur.mvData.addedVideoHash},{onDone:function(box){box.removeButtons(),box.addButton((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("Save"),(function(btn){const title=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_video_playlist_edit_title")),privacy=Privacy.getValue("video_playlist");title&&window.ajax.post("al_video.php?act=a_save_playlist",{title,privacy,hash:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("video_playlist_edit_hash"),oid:mvcur.mvData.oid,vid:mvcur.mvData.vid},{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(btn),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(btn),onDone:function(playlistId,text,playlist,video){if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.curBox)().hide(),text&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.showDoneBox)(text),mvcur.mvData.playlists.push({id:playlistId,added:!0,title:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.clean)(title),private:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(privacy)}),Videoview.initAddButton(),window.Video&&playlist){const playlistEvalExpr=`(${playlist})`;try{playlist=eval(playlistEvalExpr)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.logEvalError)(e,playlistEvalExpr)}if(video){const videoEvalExpr=`(${video})`;try{video=eval(videoEvalExpr)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.logEvalError)(e,videoEvalExpr)}}}}})}))},stat:[window.jsc("web/privacy.js"),"privacy.css",window.jsc("web/video.js"),"video.css"],containerClass:"VideoPlaylistPopup"}),Videoview.playerNextTimerUpdate()},updateVideo(e,_,i,o,t,s,d,a,n,r){window.mvcur&&mvcur.mvData.oid==e&&mvcur.mvData.vid==_&&(mvcur.mvData.title=i,mvcur.mvData.desc=o,mvcur.listId=d||mvcur.listId||Video.getDefaultListId(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_info")&&getVideoModalBlocks().then((({videoModalService:e})=>{e.setTitleEvent(i),e.setDescriptionEvent(o)})),Videoview.setTitle(),Videoview.setDesc(),Videoview.setTimeCodes(t),n&&(Videoview.setPostponePublicationDesc(n),Videoview.recache()),r&&(Videoview.setUpcomingLiveDesc(r),Videoview.recache()),"published"===a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_publish"),s&&(mvcur.mvShown?Videoview.reload():Videoview.recache()))},setAddButtonStateAdded(){window.mvcur?.mvShown&&(mvcur.mvData.published=!0,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.triggerEvent)("mv_add_button","setAdded"))},initAddButton(){mvcur.addButtonTT&&(mvcur.addButtonTT.destroy(),mvcur.addButtonTT=null);const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_add_button");if(!(e&&e instanceof HTMLElement))return;const _=Videoview.getMvData(),i=_.uploaded,o=_.noPublicAdd;let t=!1;function s(o,s,a){o=i||o;const r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_added_icon",e),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_plus_icon",e),c=(0,_web_likes_helpers__WEBPACK_IMPORTED_MODULE_57__.getElementLikeButtonLabel)(e);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(l,"mv_add_icon_curr",!o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(l,"mv_add_icon_down",o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(r,"mv_add_icon_curr",o),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(e,"click",d),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(e,"setAdded",d),o)c.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_added_to_my_playlist"),s&&n(!1,_.PLAYLIST_ADDED_ID);else{const _=!Videoview._isCurrentVideoPublished()&&_shared_ranges__WEBPACK_IMPORTED_MODULE_37__.Ranges.isGroupId(mvcur.mvData.oid);c.innerHTML=_?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_add_to_group"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_add_to_my_playlist"),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"click",d),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"setAdded",d)}a||t==o||Videoview.playerOnAdded(),t=o,_.added=o}function d(e){"click"==e.type&&mvcur.addButtonTT&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isAncestor)(e.target,mvcur.addButtonTT.getContent())||(Videoview._isCurrentVideoPublished()?o&&"click"==e.type||s(!0,!0,"setAdded"==e.type):Videoview.showAddDialog(mvcur.videoRaw))}function a(){let e=!1;return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)(mvcur.mvData.playlists,(function(_,i){if(i.added)return e=!0,!1})),e}function n(e,_){let i=!0;if(e){const o=e.currentTarget||e.target;if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(o,"disabled"))return;i=(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(o),_=o.getAttribute("data-id")}else mvcur.addButtonTT.getContent()&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("checkbox",mvcur.addButtonTT.getContent()),(function(){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)(this,"id")===_)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)(this),!1}));(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)(mvcur.mvData.playlists,(function(e,o){if(o.id==_)return o.added=i,!1})),window.ajax.post("al_video.php?act=a_add_to_playlist",{oid:mvcur.mvData.oid,vid:mvcur.mvData.vid,hash:mvcur.mvData.playlistAddHash,playlist_id:+_,add:+i,info:window.Video&&Video.isInCatalog()?_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getCurListId():"",module:Videoview.getVideoModule(),context:Videoview.getVideoContext()},{onFail:function(){+i&&(window.tooltips&&tooltips.destroyAll(),s(!1))}}),e&&(s(a()),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e))}s(i||a(),!1,!0),mvcur.mvData.published&&(mvcur.addButtonTT=mvcur.addButtonTT||new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_25__.ElementTooltip(e,{cls:"mv_add_eltt",autoShow:!0,noHideOnClick:!0,onFirstTimeShow:function(e){let _="";Object.keys(mvcur.mvData.playlists).sort(Number).forEach((e=>{const i=mvcur.mvData.playlists[e];if(i.disabled&&!i.added&&i.id==mvcur.mvData.PLAYLIST_UPLOADED_ID)return;const o=i.private?`<span class="mv_tt_playlist_private_icon" onmouseover="showTooltip(this, { black: 1, text: '${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_album_is_private_tt")}', shift: [16, 8, 0] })"></span>`:"";_+=`\n                <div class="mv_tt_playlist">\n                  <div class="checkbox ${i.added?"on":""} ${i.disabled?"disabled":""} ${i.private?"private":""}" data-id="${i.id}" onclick="checkbox(this);">${i.title}</div>\n                  ${o}\n                </div>\n              `}));const i=o?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_add_private_playlist"):(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_create_new_playlist_btn");_=`\n            <div id="mv_pl_tt">\n              <div class="mv_tt_private_only ${o?"":"unshown"}">${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_only_private_video")}</div>\n              <div class="mv_tt_playlists ${o?" with_border":""}">${_}</div>\n              <div class="mv_tt_add_playlist" role="link" tabindex="0" onclick="Videoview.addPlaylist(${o})">\n                <span class="mv_tt_plus_icon">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_56__.getIcon12Add)().icon}</span>${i}\n              </div>\n            </div>\n          `,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(e,_),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("checkbox",e),(function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(this,"click",n)}));const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(e,"mv_tt_add_playlist");function s(e){const _=mvcur.addButtonTT.getContent();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(_,"mv_add_eltt_add_playlist_hover",e)}(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(t,"mouseenter",s.pbind(!0)),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(t,"mouseleave",s.pbind(!1)),(0,_web_lib_accessibility__WEBPACK_IMPORTED_MODULE_20__.updateAriaCheckboxes)()},onDestroy:function(e){e&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("checkbox",e),(function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(this)})),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(e,"mv_tt_add_playlist")))}}))},showPlayer(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("video_player");_&&(e||!_.getAttribute("preventhide")||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile)&&(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(_,{position:"static",top:0}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(_):_.style.visibility="visible")},hidePlayer(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("video_player");_&&(e||!_.getAttribute("preventhide")||_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile)&&(_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.msie&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(_,{position:"absolute",top:"-5000px"}),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)(_):_.style.visibility="hidden")},sendLike(e,_,i,o,t,s){window.ajax.post("like.php",{act:e.liked?"a_do_like":"a_do_unlike",hash:e.likeHash,short_view:1,from:"videoview",object:i,info:o,ref:_?.options.module||Videoview.getVideoModule(),track_code:(0,_web_video_video_utils__WEBPACK_IMPORTED_MODULE_30__.getVideoTrackCode)()},{onDone:t,onFail:s})},init(e){window.mvcur={},window.mvLayer?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(window.mvLayer,"mv_layer--vertical",!!e.shortVideo):(window.mvLayer=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ce)("div",{id:"mv_layer"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(window.mvLayer,"mv_layer--vertical",!!e.shortVideo),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.mvLayer,"mousemove",(function(){mvcur.mousemoved=!0,mvcur.blackout&&Videoview.moveCheck()})),window.mvLayerWrap=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ce)("div",{id:"mv_layer_wrap",className:"fixed layer_wrap"}),window.mvLayerWrap&&window.mvLayerWrap.setAttribute(_web_search_SearchTop_constants__WEBPACK_IMPORTED_MODULE_38__.SEARCH_TOP_MODAL_NON_CLOSING_ATTR,"true"),mvLayerWrap.appendChild(window.mvLayer),document.body.appendChild(mvLayerWrap),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(window.mvLayer,{width:lastWindowWidth-(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.sbWidth)()-2+"px"})),Videoview.onScrollHandler||(Videoview.onScrollHandler=(0,_shared_lib_throttle__WEBPACK_IMPORTED_MODULE_58__.throttle)(Videoview.viewScroll,100),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(mvLayerWrap,"scroll",Videoview.onScrollHandler)),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_fix_actions")&&(0,_web_VideoModal_utils__WEBPACK_IMPORTED_MODULE_48__.initPlayerEventListeners)()},moveCheck(){mvcur.mousemoved?mvcur.blackout&&(mvcur.blackout=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)(window.layerBG)?(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animate)(window.layerBG,{opacity:.8},200):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(window.layerBG,{opacity:.8})):mvcur.blackout||mvcur.finished||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)(window.layerBG)||(mvcur.blackout=!0,(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animate)(window.layerBG,{opacity:.9},5e3)),mvcur.mousemoved=!1},logClick(e){const _=e.target.closest(".mv_recom_item");if(_){const e=_.getAttribute("data-id"),i=[...document.querySelectorAll(".mv_recom_item")].findIndex((_=>_.getAttribute("data-id")===e));-1!==i&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("videoview_recom_click_position","",`pos${i+1}`)}},show(e,_,i,o){const t=window.ap;let s=!0;if(o&&o.autoplay){s=!Videoview.playerCallback.onVideoStreamPlaying()}if(s&&t&&t.isPlaying()&&(t.pauseByChangeChannel(),t.pausedByVideo=Date.now()),e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domClosest)("bookmarks_row_type_video",e.target)){const[e,i]=_.split("_");(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("bookmarks_product_analytics",{item_type:"video",item_owner_id:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(e),item_id:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(i),time:(0,_web_lib_date__WEBPACK_IMPORTED_MODULE_8__.getServerTime)()})}const d=e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domClosest)("video_active_live",e.target);(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)("show video "+_),o.fromPreload&&(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_29__.saveStatlogEvents)({name:"video_showcase_web",value:Math.round(performance.now()),keys:[cur.is_showcase?window.cur.section_id:"","show_video_direct","origin"]});const a=window.mvcur?.mvShown,n=window.mvcur?.player;if(a&&(Videoview.isFS&&!o.shortVideo?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(`video_box_wrap${mvcur.videoRaw}`,(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_6__.getProgressHtml)()):Videoview.isMinimized()?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_player_box"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_progress_box"),Videoview.togglePlay(!1)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_player_box",""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_player_box"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_progress_box"))),window.mvcur&&clearInterval(mvcur.nextTimerUpdateInterval),window.mvcur&&mvcur.minimized){if(!o.nomin)return mvcur.fallbackData={videoRaw:mvcur.videoRaw,options:mvcur.options,listId:mvcur.listId,mvData:mvcur.mvData},mvcur.videoRaw=_,mvcur.options=o,mvcur.listId=i,mvcur.mvData=!1,(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")&&o.playlistId?Videoview.buildVideoModalPlayerContext({videoId:_,playlistId:o.playlistId,ownerId:cur.oid}):o.playlistId&&!d?Videoview.initPlaylistBlock(_,o.playlistId,o.catLoadMore):_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.removeBlock(),!0;o.prevLoc&&(mvcur.mvPrevLoc=o.prevLoc),(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)("unminimizing in show"),Videoview.unminimize(!0,!1,!0)}if(o.queue&&((0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)("pushing in videoview.show"),window.layerQueue.push(),o.queue=!1),!o.noLocChange&&nav.objLoc.z&&/^(video|clip)/.test(nav.objLoc.z)&&(cur.mvHistoryBack=cur.mvHistoryBack||1,cur.mvHistoryBack++),window.forcePauseAudio=!0,a||window.layerQueue.hide(),window.forcePauseAudio=!1,this.init(o),mvcur.showTime=Date.now(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",Videoview.onResize),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"focus blur",Videoview.onPageFocusChange),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"keydown",Videoview.onKeyDown),window.mvLayer.removeEventListener("click",Videoview.logClick),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_live_chat_updating")&&document.addEventListener("visibilitychange",Videoview.onVisibilityChange),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",Videoview.onResize),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"focus blur",Videoview.onPageFocusChange),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"keydown",Videoview.onKeyDown),window.mvLayer.addEventListener("click",Videoview.logClick),window.boxQueue.hideAll(),layers.wrapshow(mvLayerWrap,.8),layers.fullhide=Videoview.hide,mvcur.nextTimerUpdateInterval=setInterval(Videoview.playerNextTimerUpdate,1e3),setTimeout((function(){layers.wrapshow(mvLayerWrap,.8),layers.fullhide=Videoview.hide}),0),mvcur.noLocChange=0,o.ad_video&&(o.hideInfo=1,o.noLocChange=1,mvcur.noLocChange=1),mvcur.noHistory=o.noLocChange||o.noHistory,mvcur.blackInterval=setInterval(Videoview.moveCheck,18e4),mvcur.videoRaw=_,mvcur.options=o,mvcur.listId=i,mvcur.mvData=!1,mvcur.mvShown=!0,mvcur.player=n,o.prevLoc?mvcur.mvPrevLoc=o.prevLoc:setTimeout((function(){Videoview.setLocation(o.noLocChange)}),0),e&&e.pageX&&e.pageY&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(mvcur,{mvOldX:e.pageX,mvOldY:e.pageY,mvOldT:Date.now()}),a?(Videoview.disableLayerContent(),window.VideoChat?.destroy()):Videoview.buildLayerContent(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_info","mv_info_invisible",o.hideInfo),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_warning"),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_show_collapse_button")?nav.objLoc.webcast&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_minimize_action_btn"):cur.is_web_streaming&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_minimize_action_btn"),o.expandPlayer){mvcur.player=o.expandPlayer,o.expandPlayer=1;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domClosest)("video_box_wrap",mvcur.player.el);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_player_box").appendChild(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_progress_box"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_player_box"),mvcur.player.onExpanded()}return(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")&&o.playlistId?Videoview.buildVideoModalPlayerContext({videoId:_,playlistId:o.playlistId,ownerId:cur.oid}):o.playlistId&&!d?Videoview.initPlaylistBlock(_,o.playlistId,o.catLoadMore,!a):_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.removeBlock(),Videoview.cleanUpStoredVSegs(),o.minimized&&setTimeout(Videoview.minimize.bind(Videoview),0),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")?Videoview.closeTimeCodesList():_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList.destroy(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_goods_recognition")&&(0,_web_videoview_GoodsRecognition_init__WEBPACK_IMPORTED_MODULE_36__.destroyGoodsBlock)(),!1},onVisibilityChange(){window.Videoview.isHighloadLive&&"hidden"!==document.visibilityState&&window.VideoChat&&!window.VideoChat.isHidden()&&(window.VideoChat.sendBatchOfMessages(),Videoview.queueReconnect())},buildLayerContent(){const e=(0,_shared_stickers_refactor_utils_popup_getDataAttrs__WEBPACK_IMPORTED_MODULE_41__.popUpGetStringDataAttrs)({popupStickerContainerId:_shared_stickers_refactor_utils_popup_constants__WEBPACK_IMPORTED_MODULE_59__.POPUP_STICKER_VIDEO_CONTAINER_ID}),_=cur.is_web_streaming?"window.VideoWebStreaming && window.VideoWebStreaming.hide(event)":`Videoview.hide(${(!window.mvcur?.options?.forceLoc).toString()}, true, event, true)`;document.body.classList.add("Videoview");const i=((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_new_video_page")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_player_new_play_pause_loading_animations"))&&!window.mvcur?.options?.shortVideo?(0,_web_videoplayer_ui_loading_state__WEBPACK_IMPORTED_MODULE_60__.getLoadingStatusHtml)():(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_6__.getProgressHtml)();window.mvLayer.innerHTML=`\n  <div class="mv_layer_bg" onclick="return ${_};"></div>\n  <div id="mv_container" class="scroll_fix_wrap">\n    <div ${e} id="mv_box" class="mv_box">\n      <div id="mv_approve" style="display: none;"></div>\n      <div id="mv_publish" style="display: none;"></div>\n      <div class="mv_min_header">\n        <div class="mv_min_control" onmousedown="return Videoview.hide(false, true);" role="button" tabindex="0" aria-label="${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_close")}">\n          <div class="mv_min_control_close"></div>\n        </div>\n        <div class="mv_min_control" onclick="return Videoview.unminimize();">\n          <div class="mv_min_control_max"></div>\n        </div>\n        <div class="mv_min_title" id="mv_min_title"></div>\n      </div>\n      <div id="mv_main" class="mv_main">\n        <div class="mv_pl_prev_wrap">\n          <div class="mv_playlist_controls" id="mv_pl_prev" onclick="return VideoPlaylist.prevVideo()" onmouseover="Videoview.showPrevTooltip(this)" role="button">\n            <div class="mv_playlist_controls_icon"></div>\n          </div>\n        </div>\n        <div class="mv_pl_next_wrap">\n          <div class="mv_playlist_controls" id="mv_pl_next" onclick="return VideoPlaylist.nextVideo()" onmouseover="Videoview.showNextTooltip(this)" role="button">\n            <div class="mv_playlist_controls_icon"></div>\n          </div>\n        </div>\n        <div id="mv_progress_box">${i}</div>\n        <div id="mv_player_box"></div>\n        <div id="mv_goods_recognition"></div>\n        <div class="VideoLayerInfo__topControlsWrap">\n          <div id="VideoLayerInfo__topControls">\n            <div onclick="return ${_};" onmouseover="Videoview.showCloseTooltip(this)" class="mv_top_button mv_top_close" role="button" tabindex="0" aria-label="${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_close")}">\n              <div class="mv_close_icon"></div>\n            </div>\n            <div id="mv_minimize_action_btn" onclick="return Videoview.minimize(event);" onmouseover="Videoview.showCollapseTooltip(this)" class="mv_top_button mv_top_minimize">\n              <div class="mv_minimize_icon"></div>\n            </div>\n            <div onclick="return Videoview.toggleSideBlock(event);" onmouseover="Videoview.showVideoViewTooltip(this)" class="mv_top_button mv_top_toggle_sideblock" id="mv_top_pl_toggle" role="button" tabindex="0">\n              <div class="mv_toggle_sideblock_icon"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="mv_info" id="mv_info"></div>\n      <div class="mv_warning" id="mv_warning" style="display: none;"></div>\n    </div>\n  </div>\n  <div class="VerticalVideoLayerInfo__topControlsWrap">\n    <div id="VerticalVideoLayerInfo__topControls">\n      <div onclick="return Videoview.hide(false, true, event, true);" class="mv_top_button mv_top_close" onmouseover="Videoview.showCloseTooltip(this, true)" role="button" tabindex="0" aria-label="${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_close")}">\n        <div class="mv_close_icon"></div>\n      </div>\n      <div onclick="return Videoview.minimize(event);" onmouseover="Videoview.showCollapseTooltip(this, true)" class="mv_top_button mv_top_minimize">\n        <div class="mv_minimize_icon"></div>\n      </div>\n    </div>\n  </div>\n    `,Videoview.updateSize()},disableLayerContent(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)("mv_info","mv_info_disabled")},initPlaylistBlock(e,_,i,o){if(window.mvcur?.options?.shortVideo)return;const t=_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getBlock(),s=!!t,d=_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.buildBlock(_,e,o);if(d&&/^wall_/.test(_)&&_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.lists[_]&&cur.wallVideos&&cur.wallVideos[_]&&(_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.extendList(_,cur.wallVideos[_].list),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.updateBlockList(_)),d){if(d!==t){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_main"),_=e.firstChild;_?e.insertBefore(d,_):e.appendChild(d),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.setIsSubscribed()}const o=_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getCurList().list.length;(window.Video&&Video.isInVideosList()&&vk.id==cur.oid||o<5)&&(s||_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.toggle(!1)),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.isFunction)(i)&&i(_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.updateBlockList.pbind(_)),setTimeout((function(){_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.restoreScrollPos(),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.updateScrollbar(),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.setCurVideo(e,s),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.updateControls()}),0)}_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.toggleStateClasses(),Videoview.updateLayoutSizes()},hide(e,_,i,o){let{noLoc:t}="object"==typeof e?e:{noLoc:e};if(document.querySelector(".VideoLayout")?.classList.remove("VideoLayout--hidden"),window.VideoShowcase?.updateLayout(),!window.mvcur||!_&&!mvcur.mvShown)return;if(!_&&mvcur.minimized)return void(mvcur.noLocChange||!0===t||(2===t?nav.setLoc(window.hab.getLoc()):window.layerQueue.count()||Videoview.backLocation()));if(!mvcur.noHistory&&!t){mvcur.noHistory=1,mvcur.forceHistoryHide=_,window.__adsUpdate("very_lazy");const d=cur.mvHistoryBack?-cur.mvHistoryBack:-1;return cur.mvHistoryBack=0,setTimeout((function(){mvcur.mvShown||(Videoview.destroyPlayer(),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.removeBlock())}),10),history.go(d)}if(mvcur.forceHistoryHide&&(_=mvcur.forceHistoryHide,mvcur.forceHistoryHide=!1),mvcur.statusVideo){const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_like_icon");if(a){const n=a.parentNode.tt;n&&n.container&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)(n.container),a.parentNode.tt&&delete a.parentNode.tt}}const s=mvcur.minimized;if(s&&(Videoview.unminimize(!0,!0,!0),mvcur.minimized=!1,t=!0),window.Wall?.cancelEdit(!0),mvcur.replyFormShown&&window.Wall?.hideEditReply(mvcur.post),mvcur.mvData&&(mvcur.mvData.duration>60||mvcur.mvData.is_live)&&!_&&!mvcur.finished){if(Date.now()-mvcur.showTime>3e4&&!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.safari_mobile){const r=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_are_you_sure_close_title"),bodyStyle:"padding: 20px; line-height: 160%;",onShow:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"keydown",l)},onHide:function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"keydown",l)}},(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_are_you_sure_close"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("box_yes"),(function(){r.hide(),Videoview.hide(t,!0)}),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("box_no"));function l(e){e.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.ENTER&&(r.hide(),Videoview.hide(t,!0))}return!0}}if(cur.vSearchLastActionTime&&(cur.vSearchLastActionTime=Date.now()),!window.forcePauseAudio){const c=window.ap;c&&!c.isPlaying()&&c.pausedByVideo&&(Date.now()-c.pausedByVideo<18e4&&c.resumeChannel(),delete c.pausedByVideo),window.Notifier&&Notifier.lcSend("video_hide")}return s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)(mvLayerWrap):(layers.wraphide(mvLayerWrap),layers.fullhide=!1),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("feed_post_video_layer_close_wkview_restore")&&window.wkcur?.shown&&window.wkLayerWrap&&window.WkView?.showLayer(),window.tooltips&&tooltips.destroyAll(cur.mvBox),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(document.body,"Videoview"),mvcur.mvShown=!1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",Videoview.onResize),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"keydown",Videoview.onKeyDown),window.mvLayer.removeEventListener("click",Videoview.logClick),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_live_chat_updating")&&document.removeEventListener("visibilitychange",Videoview.onVisibilityChange),Videoview.onScrollHandler&&((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(mvLayerWrap,"scroll",Videoview.onScrollHandler),Videoview.onScrollHandler=null),clearInterval(mvcur.nextTimerUpdateInterval),mvcur.addButtonTT&&(mvcur.addButtonTT.destroy(),mvcur.addButtonTT=null),window.VideoChat?.destroy(),window.ExternalVideo?.removeExternalVideoFinishBlock(),Videoview.destroyPlayer(),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.removeBlock(),_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList.destroy(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_goods_recognition")&&(0,_web_videoview_GoodsRecognition_init__WEBPACK_IMPORTED_MODULE_36__.destroyGoodsBlock)(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_player_box",""),s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)(layerWrap)||((0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)("pop from videoview.hide"),setTimeout(window.layerQueue.pop,0)),mvcur.blackInterval&&clearInterval(mvcur.blackInterval),o&&nav.objLoc.z?(window.layerQueue.skipVideo=!0,delete nav.objLoc.webcast,delete nav.objLoc.preview,delete nav.objLoc.z,delete nav.objLoc.list,delete nav.objLoc.claim,delete nav.objLoc.screen,nav.setLoc(nav.objLoc)):o?Videoview.backLocation():mvcur.noLocChange||!0===t||(2===t?nav.setLoc(window.hab.getLoc()):Videoview.backLocation(),window.__adsUpdate("very_lazy")),window.__adsUpdate(),mvcur.bodyScrollTop=window.scrollNode.scrollTop,setTimeout((function(){if(void 0!==mvcur.bodyScrollTop&&(window.scrollNode.scrollTop=mvcur.bodyScrollTop,delete mvcur.bodyScrollTop),window.cur&&cur.promoVideo&&cur.aid&&"apps"===cur.module){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("apps_promo_video_thumb"+cur.aid);e&&(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_2__.showInlineVideo)(cur.promoVideo,"",{module:"app_promo"},null,e)}}),0),window.VideoLive?.destroyLiveInfoButton(),Videoview.unmountVideoModalRedesign(),!1},unmountVideoModalRedesign(){(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_recommendations")&&getVideoModalBlocks().then((({unmountVideoModalRecommendations:e})=>{const _=document.querySelector(".js-video-modal-recommendations");_&&e(_)})),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_info")&&this.unmountVideoModalInfo&&this.unmountVideoModalInfo(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_tree_comments")&&!mvcur.mvData.is_active_live&&getVideoModalBlocks().then((({unmountComments:e})=>{const _=document.getElementById("video-modal-comments");_&&e(_)})),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")&&getVideoModalBlocks().then((({unmountVideoModalPlayerSidebar:e,unmountVideoModalEpisodes:_})=>{const i=document.querySelector(".js-video-modal-player-context"),o=document.getElementById("video-modal-episode"),t=document.getElementById("mv_box");if(i&&(t.classList.remove("_hide_recomms"),t.classList.add("_hide_playlist"),e(i)),o){const e=document.getElementById("mv_box");e?.classList.remove("_has_time_codes"),_(o)}}))},destroyPlayer(){mvcur.player&&(mvcur.player.destroy(),delete mvcur.player),document.getElementById("video_yt")&&window.VideoYoutube&&window.VideoYoutube.destroy(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_fix_actions")&&(0,_web_VideoModal_utils__WEBPACK_IMPORTED_MODULE_48__.removePlayerEventListeners)()},cmp(e,_){const i=e.length,o=_.length;return i<o?-1:i>o?1:e<_?-1:e>_?1:0},onKeyDown:e=>!1!==e.returnValue&&(e.keyCode==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.ESC?(mvcur.mvEditing?Videoview.cancelInline():cur.is_web_streaming?window.VideoWebStreaming?.hide(e):Videoview.hide(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)):void 0),onResize(){window.ExternalVideo?.updateExternalVideoFinishBlock(),Videoview.updateReplyFormPos(),window.VideoLiveGifts?.onLiveGiftsScroll(),Videoview.updateLayoutSizes(),window.VideoChat?.onResize(),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.updateScrollbar(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")?getVideoModalBlocks().then((({videoModalEpisodeService:e})=>{e.updateScrollHeight(Videoview.getPlayerHeight())})):_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList.updateScrollbar(),mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight()},onPageFocusChange(){setTimeout(Videoview.playerNextTimerUpdate,10)},onFullscreenChange(e){window.Videoview.isFS=e,mvcur.chatMode&&window.VideoChat?.onFullscreenChange(e)},updateLayoutSizes(){if(mvcur.minimized)return;const e=document.documentElement,_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_box"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_container"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_main"),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_player_box"),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_progress_box");let d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("video_mvpl")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_chat",i)||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_live_preparation",i);const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_main_info"),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_reply_form"),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_info_narrow_column",i),l=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")?document.getElementById("video-modal-episode"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("TimeCodesList",i),c=document.getElementById("GoodsRecognition"),m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("mv_playlist_controls",i);_?.classList.toggle("_no_video_list",Videoview.isVideoListEmpty());const v=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_layer"),"mv_layer--vertical");_?.classList.contains("_has_recomms")&&!_?.classList.contains("_hide_recomms")&&(d=r),_?.classList.contains("_has_time_codes")&&(d=l),_?.classList.contains("_has_goods")&&(d=c);const E=d?d.offsetWidth:0;let u=INFO_HEADER_PADDING_DEFAULT;if(a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)(t)?t:s,_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(e)[1]+e.offsetHeight,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(a)[1]+a.offsetHeight-_;i>u&&(u=i)}const w=window.innerWidth||e.clientWidth||document.body.clientWidth,p=window.innerHeight||e.clientHeight||document.body.clientHeight;let b,h=w,D="auto",P=null,O=p;if(v){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("VerticalVideoLayerInfo__scrollWrap"),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("VerticalVideoLayerInfo__mainInfoWrap"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("VerticalVideoLayerInfo__commentsReply"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_comments_restricted_msg");if(O=p-2*CONTAINER_VERTICAL_SIDE_PADDING,b=O/16*9,P=b,h=b+310,D=O,e){let t=O;_&&(t-=_.offsetHeight),i&&(t-=i.offsetHeight),o&&(t-=o.offsetHeight),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(e,{height:t}),mvcur.uiScroll||(mvcur.uiScroll=new uiScroll(e,{global:!0,theme:"videoview"}))}const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("VerticalVideoLayerInfo__effectsTitle");if(t){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("VerticalVideoLayerInfo__effectsList");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("VerticalVideoLayerInfo__effectWrap").length>3&&new uiScroll(_,{stopScrollPropagation:!1,theme:"thin-dark"}),new _web_lib_element_tooltip__WEBPACK_IMPORTED_MODULE_25__.ElementTooltip(t,{content:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("VerticalVideoLayerInfo__effectsListWrapper"),forceSide:"bottom",appendTo:e})}const s=document.querySelector(".VerticalVideoLayerInfo__underAuthorNameSubtitle"),d=document.querySelector(".VerticalVideoLayerInfo__ordSeparator");s&&d&&s.clientHeight>20&&(d.textContent="")}else{h-=2*CONTAINER_SIDE_PADDING,b=h-E,O=b/VIDEO_RATIO_DEFAULT;const e=p-(CONTAINER_SIDE_PADDING+O+u);e<0&&(O-=Math.abs(e),b=O*VIDEO_RATIO_DEFAULT,h=b+E);const _=a?a.offsetWidth+(r?r.offsetWidth:0):0;(h<CONTAINER_MIN_WIDTH||h<_)&&(h=_<CONTAINER_MIN_WIDTH?CONTAINER_MIN_WIDTH:_,b=h-E,O=b/VIDEO_RATIO_DEFAULT)}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(i,{height:D,width:h}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(o,{width:P}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(t,{height:O}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(s,{height:O}),i.style.setProperty("--player-height",`${O}px`),i.style.setProperty("--player-width",`${b}px`),m.length){const e=O/2;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)(m,(function(_,i){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(i,{paddingBottom:e,paddingTop:e})}))}if(!Videoview.isVideoListEmpty()&&!v&&n){const e=h-(r?r.offsetWidth:0),_=(e-(a?a.offsetWidth:0))/-2;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(n,{marginLeft:Math.ceil(_),marginRight:(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_info")?Math.ceil(_):0,width:e}),Videoview.updateReplyFormPos()}},updateSize(){if(mvcur.minimized)return!1;window.onBodyResize(),Videoview.onResize()},getPrevLoc(){mvcur.mvPrevLoc={};for(let e in nav.objLoc)"z"==e&&0==!nav.objLoc[e].indexOf(`video${mvcur.videoRaw}`)||(mvcur.mvPrevLoc[e]=nav.objLoc[e])},setLocation(e){if(mvcur.options.fromPreload){if(cur.is_showcase){const e=mvcur.listId?mvcur.listId.replace("/video",""):"";if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_standalone")){const _=(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.isVideoStandalone)()&&e.startsWith("/")?e.slice(1):e;mvcur.mvPrevLoc={0:(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.getVideoPrefix)("withoutSlash")+_}}else mvcur.mvPrevLoc={0:"video"+e}}else{const e=mvcur.listId.match(/([a-z]*)([0-9\-]*)/),_=parseInt(e[2]);mvcur.mvPrevLoc={0:"videos"+_},"videos"!=e[1]&&(mvcur.mvPrevLoc.section=e[1])}const e=mvcur.listId.match(/claim=([0-9]+)/);e&&e[1]&&(mvcur.mvPrevLoc.claim=e[1])}else e?mvcur.mvPrevLoc="z":Videoview.getPrevLoc();if(e)return;let _=(mvcur.options.shortVideo?"clip":"video")+mvcur.videoRaw;mvcur.listId&&(_+="/"+mvcur.listId),mvcur.options.playlistId&&(_+="/pl_"+mvcur.options.playlistId),mvcur.options.addParams?.promo_post_hash&&(_+="/ph_"+mvcur.options.addParams.promo_post_hash);const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(nav.objLoc,{z:_});/^video-?\d+/.test(nav.objLoc[0])&&i.z&&!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_fix_url_swich_in_video_modal")&&(delete i.z,document.querySelector(".VideoLayout")?.classList.remove("VideoLayout--hidden"),window.VideoShowcase?.updateLayout()),nav.strLoc!=nav.toStr(i)&&(nav.setLoc(i),(mvcur.options||{}).fromQueue&&(mvcur.noHistory=1)),mvcur.options&&(mvcur.options.fromQueue=!1)},backLocation(){if("z"==mvcur.mvPrevLoc||!mvcur.mvPrevLoc&&nav.objLoc.z){const e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.clone)(nav.objLoc);delete e.z,delete e.claim,nav.setLoc(e)}else if(mvcur.mvPrevLoc){mvcur.mvPrevLoc[0]&&mvcur.mvPrevLoc[0].match(/^videos-?\d+/)&&mvcur.mvData&&mvcur.mvData.artistHref?nav.setLoc({0:mvcur.mvData.artistHref.replace(/^\//,"")}):(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_standalone")&&(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.isVideoStandalone)()&&mvcur.mvPrevLoc[0].startsWith("@id")?window.location.assign(mvcur.mvPrevLoc[0]):nav.setLoc(mvcur.mvPrevLoc)}else("video"==nav.objLoc[0]||nav.objLoc[0].match(/^video-?\d+_\d+/))&&nav.setLoc({0:"video"});mvcur.options.prevTitle&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setDocumentTitle)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.stripHTML)(mvcur.options.prevTitle)),delete mvcur.options.prevTitle),mvcur.noHistory=1},preventHiddingOnBackLocation(){if(!(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_back_action_fixes"))return;const e=window.nav?.strLoc?.startsWith("video");e&&window.Videoview.backLocation()},highlightComment(e){if(!(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)(e)))return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(e,"VideoLayerInfo__commentHighlighting");const _=()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(e,"VideoLayerInfo__commentHighlighting"),setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(e,"VideoLayerInfo__commentHighlighting")}),1e3)},i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(e,!0)[1];if(i<0||i>lastWindowHeight-200){const e=mvLayerWrap.scrollTop+i-50;(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animate)(mvLayerWrap,{scrollTop:e},300,_)}else _()},showComment(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("post"+e);return _?Videoview.highlightComment(_):Videoview.moreComments(e),!1},commActionDone(commId,from,text,del,script){const node=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("post"+commId.split("_").join("video_")+from);if(!node)return;const comment=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(node,"reply_wrap"),msg=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(node,"dld");if(!text)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)(msg),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(comment),"mv"==from&&(++mvcur.mvData.commcount,++mvcur.mvData.commshown),void Videoview.updateCommentsHeader(from);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)(comment),node.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)(text)),del?("mv"==from&&(--mvcur.mvData.commcount,--mvcur.mvData.commshown),Videoview.updateCommentsHeader(from)):"mv"==from&&Videoview.recache(),script)try{eval(script)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.logEvalError)(e,script)}"review"!==from&&Videoview.updateReplyFormPos()},commAction(e,_,i,o,t){if((0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.isVideoPageOpen)())return void window.dispatchEvent(new CustomEvent(_web_video_constants__WEBPACK_IMPORTED_MODULE_51__.VideoCommentsEvents.COMMENT_ACTION,{detail:{act:e,ownerId:_,commentId:i,hash:o,from:t}}));if("spam"===e)return void this.showReportVideoCommentForm(_,i);const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("post"+_+"video_"+i+t),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(s,"post_actions"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("reply_"+e+_+"video_"+i+t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)(s,"data-action",e),a&&tooltips.hide(a),window.ajax.post("al_video.php",{act:e+"_comment",comment:_+"_"+i,hash:o,videoview:1,from:t},{onDone:Videoview.commActionDone.pbind(_+"_"+i,t),showProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass.pbind(d,"post_actions_progress"),hideProgress:_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass.pbind(d,"post_actions_progress"),stat:[window.jsc("web/privacy.js"),"privacy.css"]})},moreComments(e){if(!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)("mv_comments_header")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_comments_header")),"pr"))return;if(e&&Videoview.cmp((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_comments")).id,"post"+e)<0)return;if((0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.isVideoPageOpen)())return void window.dispatchEvent(new CustomEvent(_web_video_constants__WEBPACK_IMPORTED_MODULE_51__.VideoCommentsEvents.SHOW_MORE_COMMENTS,{detail:{replyId:e}}));const _=Videoview.getMvData();window.ajax.post("al_video.php?act=video_comments",{offset:_.commshown,video:_.videoRaw,view_hash:_.itemAccessHash},{onDone:function(_,i,o){o&&(mvcur.mvData.commcount=o),Videoview.receiveComms(_,i,!0,e),e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("post"+e)&&Videoview.showComment(e),Videoview.adaptRecomsHeight()},showProgress:function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_comments_header");mvcur.mvCommInfo=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(e,""),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.showProgress)(e)},hideProgress:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_comments_header",mvcur.mvCommInfo)}})},updateCommentsHeader(e){if("review"===e)return;const _=Videoview.getMvData();let i="";_.commcount>_.commshown&&(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_show_previous_comments",_.commcount-_.commshown)),_.commcount&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_comments_summary",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_comments_summary",_.commcount)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_comments_summary",{display:_.commcount?null:"none"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_comments_header","mv_comments_expanded",!i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_comments_summary","mv_comments_expanded",!i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_comments_header",i),Videoview.recache()},onShowEditReply(){mvcur.replyFormShown=!0,Videoview.updateReplyFormPos(),Videoview.playerNextTimerUpdate()},onHideEditReply(){mvcur.replyFormShown=!1,mvcur.mvReplyTo=!1,Videoview.updateReplyFormPos(),setTimeout(Videoview.updateReplyFormPos,0),Videoview.playerNextTimerUpdate()},commentClick(e,_,i,o){(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.isVideoPageOpen)()?window.dispatchEvent(new CustomEvent(_web_video_constants__WEBPACK_IMPORTED_MODULE_51__.VideoCommentsEvents.COMMENT_CLICK,{detail:{el:e,event:_,from:i,commId:o}})):window.Wall?.checkReplyClick(e,_)||(0,_web_stickers_Stickers_helpers__WEBPACK_IMPORTED_MODULE_14__.checkStopActionOnEventOnStickerPopupIcon)(_)||(mvcur.mvReplyTo=[i,o],Wall.replyTo(mvcur.post,o,i))},receiveComms(e,_,i,o){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ce)("div",{innerHTML:e}),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_comments"),d=Videoview.getMvData();let a,n,r=a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domLC)(s),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(a,!0)[1];for(;n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domLC)(t);){for(;a&&Videoview.cmp(a.id,n.id)>0;)a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domPS)(a);a&&!Videoview.cmp(a.id,n.id)?(s.replaceChild(n,a),a=n):(a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domNS)(a)?s.insertBefore(n,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domNS)(a)):!a&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domFC)(s)?i?s.insertBefore(n,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domFC)(s)):(--d.commshown,t.removeChild(n)):s.appendChild(n),i||++d.commcount,++d.commshown)}o&&r&&(mvLayerWrap.scrollTop+=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(r,!0)[1]-l),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(mvcur.mvReplyNames,_),window.updateWndVScroll&&window.updateWndVScroll(),Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos()},sendComment(e,_,i){if((0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.isVideoPageOpen)())return void window.dispatchEvent(new CustomEvent(_web_video_constants__WEBPACK_IMPORTED_MODULE_51__.VideoCommentsEvents.SEND_COMMENT,{detail:{post:e,options:i}}));const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("reply_field"+e),t=o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(o,"composer"),s=(mvcur.mvReplyNames[(mvcur.mvReplyTo||{})[0]]||[])[1],d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("reply_button"+e);let a;const n=(i=i||{}).stickerId;if(n)a={message:"",attach1_type:"sticker",attach1:n,sticker_referrer:i.sticker_referrer};else{if(a=t?Composer.getSendParams(t,Videoview.sendComment):{message:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(o))},a.delayed)return;if(!a.attach1_type&&(!a.message||s&&!s.indexOf(a.message)))return void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.elfocus)(o)}window.ajax.post("al_video.php?act=post_comment",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(window.Wall?.fixPostParams(a)??a,{video:mvcur.mvData.videoRaw,hash:mvcur.mvData.hash,item_access_hash:mvcur.mvData.itemAccessHash,videoviewer:1,from_oid:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domClosest)("_submit_post_box",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("reply_as_group"+mvcur.post)),"from-oid"),reply_to:(mvcur.mvReplyTo||{})[1]}),{onDone:function(_,i){Videoview.receiveComms(_,i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_comments_summary",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_comments_summary",mvcur.mvData.commcount)),Composer.reset(t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("reply_warn"+e),window.Wall?.cancelReplyTo(e),mvLayerWrap.scrollTop=9e9,mvcur.player&&mvcur.player.vars.short_video&&(window.Wall?.hideEditReply(mvcur.post),mvcur.uiScroll&&mvcur.uiScroll.scrollBottom()),mvcur.player&&mvcur.player.vars.stats_tmr&&(0,_shared_counters_tmr__WEBPACK_IMPORTED_MODULE_26__.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onFail:function(e){if(o)return(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(o,{text:e,showdt:200,forcetodown:0,slide:15}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.elfocus)(o),!0},showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(d),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(d)})},addVideo(videoRaw,hash,obj,gid,accessHash,from){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_remove_video_add_acts")){const{itemId:e,ownerId:_}=(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_61__.splitRawId)(videoRaw);return void Videoview.videoApi.add({video_id:e,owner_id:_}).then((()=>{window.mvcur&&(mvcur.mvData&&mvcur.mvData.afterAdd?mvcur.mvData.afterAdd(videoRaw):mvcur.mvData.addedVideo=videoRaw);const e=document.getElementById("video_cont"+videoRaw);e&&e.classList.add("video_row_added"),Videoview.setAddButtonStateAdded()})).catch()}let url,params;return window.mvcur?.statusVideo?(params={status:videoRaw,hash,from:from||"videoviewer"},url="al_video_external.php?act=external_add"):(params={video:videoRaw,hash,from:from||"videoviewer",module:Videoview.getVideoModule(),context:Videoview.getVideoContext(),info:window.Video&&Video.isInCatalog()?_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getCurListId():""},gid&&(params.gid=gid),url="al_video.php?act=a_add"),accessHash&&(params.access_hash=accessHash),window.ajax.post(url,params,{onDone:function(text,row,hash,shareHash){if(obj&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domPN)(obj),text),!(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.isArray)(row))try{row=eval("("+row+")")}catch(e){}window.mvcur&&(mvcur.mvData&&mvcur.mvData.afterAdd?mvcur.mvData.afterAdd(row[0]+"_"+row[1],shareHash):row&&(mvcur.mvData.addedVideo=row[0]+"_"+row[1],mvcur.mvData.addedVideoHash=hash,mvcur.mvData.addedVideoShareHash=shareHash));const videoEl=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("video_cont"+videoRaw);videoEl&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(videoEl,"video_row_added"),"list"===from&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.showDoneBox)(text),Videoview.setAddButtonStateAdded()}}),!1},likeUpdate(e,_,i,o){_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(_);const t=Videoview.getMvData();t.likes=_,t.liked=e,window.Likes.update((window.mvcur?.statusVideo?"wall":"video")+t.videoRaw,{like_num:_,like_my:e});const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_like_wrap"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(s,"_count");if(!d)return;const a=s.tt||{},n=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.clone)(a.opts||{}),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(a.container,"_value"),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(a.container,"_content"),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(a.container,"_title");i&&c&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(c,i),r&&(r.value=_),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_19__.animateCount)(d,_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(s,"my_like",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(s,"no_likes",!_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(l,"me_hidden",!e),_?o||!a.el||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)(a.container)||i||tooltips.show(a.el,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(n,{showdt:0})):a.el&&a.hide()},_isCurrentVideoPublished(){const e=Videoview.getMvData();return e&&e.published},addSmall(e,_,i,o){if(Videoview._isCurrentVideoPublished()){window.mvcur?.mvShown?Videoview.setAddButtonStateAdded():Videoview.addVideo(e,_,!1,i,o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("video_add_action_link"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_like_line"),"VideoCard--videoAdded"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_finish_add","mv_external_finish"),"selected");Videoview.getMvData().added=!0}else Videoview.showAddDialog(e)},showAddDialog(e){if(cur._recentAddedVideos=cur._recentAddedVideos||{},cur._recentAddedVideos[e])return;const _=Videoview.getMvData();(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("al_video.php?act=show_add_video_box",{oid:_.oid,vid:_.vid},{onDone:function(i,o){o&&(i.removeButtons(),i.addButton((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("Save"),(function(i){const t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_video_add_title"));if(!t)return(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.notaBene)("mv_video_add_title");window.ajax.post("al_video.php?act=a_add_publish_video",{title:t,video_privacy:Privacy.getValue("video_add"),videocomm_privacy:Privacy.getValue("videocomm_add"),hash:o,oid:_.oid,vid:_.vid},{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(i),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(i),onDone:function(){cur._recentAddedVideos[e]=!0,Videoview.hide(!0,!0),Videoview.recache(e),(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_2__.showVideo)(e,mvcur.listId)}})})))}})},share(e,_,i){if(!vk.id)return;const o=Videoview.getMvData();return o&&!o.addedVideo&&(o.addedVideo=o.videoRaw),(o||e)&&(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("like.php?act=publish_box",{object:"video"+(o.addedVideo||e),action_type:i},{onDone:function(){Videoview.isLayerShown()&&Videoview.playerNextTimerUpdate()}}),!1},like(e,_){if(!vk.id)return;const i=Videoview.getMvData();if(!i)return;const{mvcur:o}=window;let t="video";i.shortVideo?t="clip":o?.statusVideo&&(t="wall");const s=t+i.videoRaw;let d="";window.Video?.isInCatalog()&&(d=_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getCurListId());const a=i.liked;if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_info")&&"video"===t)getVideoModalBlocks().then((({videoModalService:e})=>{e.toggleLikesEvent({params:{type:t,owner_id:i.oid,item_id:i.vid,ref:o?.options.module||Videoview.getVideoModule()}})}));else{const e=Videoview.likeUpdate.pbind(!a),_=()=>{window.Likes.clientUpdate(s,_web_likes_likes_constants__WEBPACK_IMPORTED_MODULE_35__.LikeButtonTypes.like,a?1:-1,a)};Videoview.sendLikeDebounced||(Videoview.sendLikeDebounced=(0,_shared_lib_debounce__WEBPACK_IMPORTED_MODULE_62__.debounce)(Videoview.sendLike,150)),Videoview.sendLikeDebounced(i,o,s,d,e,_)}_||Videoview.playerOnLiked(!a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_finish_like","mv_external_finish"),"selected",!a),window.Likes.clientUpdate(s,_web_likes_likes_constants__WEBPACK_IMPORTED_MODULE_35__.LikeButtonTypes.like,a?-1:1,!a),Videoview.recache()},showEditBox(e,_,i,o,t=!1,s=!1,d={isNewVideo:!1,isFromEditor:!1},a){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("al_video.php?act=edit_box",{vid:e,oid:_,is_publish:+o,is_short_video:+t,is_web_streaming:+s,is_new_video:+d?.isNewVideo,is_from_editor:+d?.isFromEditor},{onDone:a,containerClass:"video_edit",stat:[window.jsc("web/privacy.js"),"privacy.css",window.jsc("web/video.js"),"video.css",window.jsc("web/video_upload.js"),"video_edit.css",window.jsc("web/upload.js"),"video_showcase.css"]})},onRestoreVideo(e,_,i){const o=(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_63__.joinRawId)({ownerId:_,itemId:e});if("list"==i&&cur.restoreRaw&&cur.restoreRaw[o]){const e=document.getElementById(`video_row${o}`);e&&(e.innerHTML=cur.restoreRaw[o],e.classList.remove("video_row_loading"),e.classList.remove("video_row_deleted")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("video_row_icon_delete",e),{opacity:.8})}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_warning"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)("mv_info","mv_info_invisible"),cur.videoEditItem){const e=cur.videoEditItem;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(e,e.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now");let _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.data)(e,"restoreTO");clearTimeout(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_video_restore",e))}cur.claimedVideoText&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("video_player",cur.claimedVideoText),cur.claimedVideoText=""),"videoviewer"===i&&Videoview.updateVideoCardInProfileTabs(o,!1)},restoreVideo(e,_,i,o,t){const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_warning");return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(s,""),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.showProgress)(s,"","pr_medium"),window.ajax.post("al_video.php?act=restore_video",{vid:e,oid:_,hash:i,from:o||"videoviewer"},{onDone:function(){Videoview.onRestoreVideo(e,_,o)},onFail:function(e){return setTimeout((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)({title:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_error"),bodyStyle:"padding: 20px; line-height: 160%;"},e).hide,5e3),!0}}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t)},publish(e,_,i,o,t=!1){o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(o,"loading")||Videoview.showEditBox(_,e,null,!0,t)},stopStreaming(e,_){Videoview.stopStreamingWarning((function(){const{oid:i,vid:o}=mvcur.mvData;if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.curBox)().hide(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_live_stop_streaming_act")){_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_31__.FlatButton.lock(e);const _={video_id:o};_shared_ranges__WEBPACK_IMPORTED_MODULE_37__.Ranges.isGroupId(i)?_.group_id=_shared_ranges__WEBPACK_IMPORTED_MODULE_37__.Ranges.convertGroupIdToOwnerId(i):_.user_id=i;try{Videoview.videoApi.stopStreaming(_),_web_videoview_components_LiveInfo_store__WEBPACK_IMPORTED_MODULE_42__.sharedLiveStatsInfoService.setIsDisabled(!0)}catch(e){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_error"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_error_occured"))}_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_31__.FlatButton.unlock(e)}else window.ajax.post("al_video.php?act=live_stop_streaming",{owner_id:i,video_id:o,hash:_},{showProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_31__.FlatButton.lock(e),hideProgress:()=>_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_31__.FlatButton.unlock(e),onFail:e=>((0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_error"),e||(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_error_occured")),!0),onDone:()=>{_web_videoview_components_LiveInfo_store__WEBPACK_IMPORTED_MODULE_42__.sharedLiveStatsInfoService.setIsDisabled(!0)}})}))},stopStreamingWarning(e,_){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_are_you_sure_stop_streaming_title"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_are_you_sure_stop_streaming"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("box_yes"),e,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("box_no"),_)},showLiveInfo(){Promise.all([__webpack_require__.e(56329),__webpack_require__.e(54173),__webpack_require__.e(64497),__webpack_require__.e("langs/web/LiveInfo")]).then(__webpack_require__.bind(__webpack_require__,951981)).then((({showModal:e})=>{e()}))},deleteVideo(e,_,i,o,t,s,d){s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)(s,"loading")||window.ajax.post("al_video.php?act=delete_video",{vid:e,oid:_,hash:i,from:t,sure:o?1:0},{onDone:function(o,a,n,r,l,c){const m=(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_63__.joinRawId)({ownerId:_,itemId:e});if(Videoview.recache(m),"sure"===o){Videoview.hidePlayer();const o=(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)({title:a,bodyStyle:"padding: 20px; line-height: 160%;"},n);o.setOptions({onHide:function(){Videoview.showPlayer()}}),o.removeButtons(),o.addButton(l,o.hide,"no"),o.addButton(r,(function(){o.showProgress(),Videoview.deleteVideo(e,_,i,!0,t,s,o.hide)}),"yes")}else if("result"===o){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_playlist_page_redesign")){const i={videoId:e,ownerId:_};window.dispatchEvent(new CustomEvent("video_deleted",{detail:i}))}if(d&&d(n),cur.videoEditItem&&c){const e=cur.videoEditItem;e.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)(c)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(e,e.classList.contains("VideoCard")?"VideoCard--deleted":"video_deleted_now"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("_video_restore_act",e))}if("videoviewer"===t){const i=document.getElementById("mv_info"),o=document.getElementById("mv_warning"),s=document.getElementById("mv_publish");i&&((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_remove_restore_video_act")&&getVideoRestoreButton().then((({initVideoRestoreButton:i})=>{const s=(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_63__.joinRawId)({itemId:e,ownerId:_});i(document.getElementById(`video-restore-button-widget-${s}-${t}`),{videoId:e,ownerId:_,onClick:()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(o,""),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.showProgress)(o,"","pr_medium")},onRestore:()=>Videoview.onRestoreVideo(e,_,t),isVideoModal:!0})})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(i,"mv_info_invisible"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(o,n),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)(s)),Videoview.updateVideoCardInProfileTabs(m)}if(window.Video&&Video.isInVideosList())return!0}},showProgress:!!s&&_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass.pbind(s,"loading"),hideProgress:!!s&&_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass.pbind(s,"loading")})},deleteVideoOnClaim(e,_,i,o,t,s){Videoview.deleteVideo(e,_,i,o,t,s,(function(e){"videoviewer"==t&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)("mv_info","mv_info_invisible"),cur.claimedVideoText=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("video_player"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("video_player",e))}))},recache(e){!e&&window.mvcur?.mvData.videoRaw&&(e=mvcur.mvData.videoRaw);const _=window.ajaxCache;for(let i in _)i.match(/^\/al_video\.php\?act=show/)&&i.match(new RegExp("&video="+e+"([^0-9]|$)",""))&&delete _[i]},setStyle(e,_,i){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)(_),mvcur.restoreStyles||(mvcur.restoreStyles={});for(let o in i)i.hasOwnProperty(o)&&(mvcur.restoreStyles[e]||(mvcur.restoreStyles[e]={}),mvcur.restoreStyles[e][o]=_.style[o],_.style[o]=i[o])},restoreStyle(e,_){_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)(_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(_,mvcur.restoreStyles[e])},showVideo(videoRaw,title,html,js,desc,opt){const checkVideoRow=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_minimized_player_infinity_loading_bugfix")?videoRaw!=mvcur.videoRaw&&!mvcur.minimized:videoRaw!=mvcur.videoRaw;if(!mvcur.mvShown||checkVideoRow)return;if(!vk.id&&!html&&!mvcur.options.expandPlayer)return void setTimeout((function(){Videoview.hide(!1,!0),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.showDoneBox)(title)}),500);if(title&&!html&&!mvcur.options.expandPlayer)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_player_box",'<div class="mv_video_unavailable_message_wrap"><div class="mv_video_unavailable_message">'+title+"</div></div>"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_player_box"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_progress_box"),void(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)("mv_info","mv_info_invisible");opt=opt||{},cur.share_timehash=cur.share_timehash||opt.share_timehash,cur.preparationEnabled=opt.preparation_enabled||cur.webcast_preview,mvcur.post=opt.post,mvcur.maxReplyLength=opt.maxReplyLength,mvcur.maxChatReplyLength=opt.maxChatReplyLength,mvcur.maxDescriptionLength=opt.maxDescriptionLength,mvcur.mvData=opt.mvData,mvcur.videoRaw=opt.mvData.videoRaw,mvcur.commentsTpl=opt.commentsTpl,mvcur.mvMediaTypes=opt.media,mvcur.mvMediaShare=opt.share,mvcur.mvReplyNames=opt.names||{},mvcur.rmedia_types=opt.rmedia_types,mvcur.pl_is_subscribed=opt.pl_is_subscribed,mvcur.pl_can_subscribe=opt.pl_can_subscribe,mvcur.chatMode=!!opt.chatMode,mvcur.wallTpl=opt.wallTpl,mvcur.finished=!1,mvcur.preparationBlock=!1,mvcur.forcePlaylistLayout=opt.forcePlaylistLayout,mvcur.chatBlock=opt.chatBlock,mvcur.chatForceStickerPack=opt.chatForceStickerPack,mvcur.messageData=opt.messageData,mvcur.noStickers=!!opt.noStickers,opt.lang&&((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.addLangKeys)(opt.lang,!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)("mv_pl_prev","aria-label")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)("mv_pl_prev","aria-label",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_player_prev_video_tt")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)("mv_pl_next","aria-label")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)("mv_pl_next","aria-label",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_player_next_video_tt"))),opt.queueParams&&(mvcur.queueKey=opt.queueParams.key,mvcur.qversion=opt.qversion),window.Wall?.cancelEdit(!0);let needRemin=!0;if(!mvcur.options.expandPlayer){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)("mv_player_box","video_box_wrap");if(!opt.player_unavailable&&opt.is_vk_player&&mvcur.player&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domClosest)("video_box_wrap",mvcur.player.el)===e)(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)(e,"id","video_box_wrap"+videoRaw),needRemin=!1;else if(mvcur.player&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)(mvcur.player.el),Videoview.isFS&&!mvcur.mvData.shortVideo&&e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)(e,"id","video_box_wrap"+videoRaw);const _=new DOMParser,i=_.parseFromString(html,"text/html");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(e,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("video_box_wrap",i).innerHTML)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_player_box",html);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_progress_box")}if(opt.player){const{type:e,params:_}=opt.player,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)("mv_player_box","video_box_wrap");if(cur.is_web_streaming&&_[0].live!==_web_videoplayer_lib_live_phases__WEBPACK_IMPORTED_MODULE_34__.ENDED){const{module:e,autoplay:i,oid:o,vid:t,action_hash:s,viewer_id:d}=_[0];mvcur.webcast_params={module:e,autoplay:i,oid:o,vid:t,actionHash:s,viewerId:d},window.VideoWebStreaming.init()}else _video_initializer__WEBPACK_IMPORTED_MODULE_23__.default.initPlayer(i,e,_);mvcur.options.fromPreload&&(0,_shared_lib_web_stats__WEBPACK_IMPORTED_MODULE_29__.saveStatlogEvents)({name:"video_showcase_web",value:Math.round(performance.now()),keys:[cur.is_showcase?window.cur.section_id:"","init_player_direct","origin"]})}if(document.getElementById("mv_info").innerHTML=desc,opt.videoModalInfoData){const{ordInfo:e,trendsPosition:_,trendsLink:i,ownerName:o,ownerHref:t,ownerSubscribersCount:s,views:d,date:a,isArchivalContent:n,archivalPublishDate:r,ownerVerified:l,isFavorite:c,canAddToFavorite:m,withUMA:v,secondaryOwner:E,ownerVerifiedByServices:u,mainOwnerId:w,ownerId:p,ownerFullNameGenitive:b,canSubscribeToAuthor:h,canDownloadVideo:D,isSubscribeToAuthor:P,isSubscriptionHidden:O,moderationVideoInfo:M,subTitle:g,isExplicit:I,releaseDate:C,genre:L,featuredArtists:T,otherArtists:y,moderActions:A,claimedBlock:R,unauthLikesBox:B,statisticLink:f,isFromMessage:V,isScheduled:W,publishDate:U,canShare:K,isExternal:S,videoType:k}=opt.videoModalInfoData;getVideoModalBlocks().then((({initVideoModalInfo:x})=>{const N={id:opt.mvData.vid,likes:opt.mvData.likes,duration:opt.mvData.duration,videoId:opt.mvData.vid,isLiked:opt.mvData.liked,title:opt.mvData.title,description:opt.mvData.desc,ordInfo:e,trendsPosition:_,trendsLink:i,isArchivalContent:n,archivalPublishDate:(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.getFormattedVideoDate)(r),views:(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.getFormattedFullVideoViews)(d),formattedViewsText:(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.getFormattedBigViewsToShortCase)(d),date:(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.getFormattedVideoDate)(a),formattedDateText:(0,_web_video_video_utils__WEBPACK_IMPORTED_MODULE_30__.getFormattedUpdatedTime)(a,!0),canSubscribeToAuthor:h,isSubscribeToAuthor:P,isSubscriptionHidden:O,canAddToGroups:Boolean(mvcur?.mvData?.canAddToGroups),canReport:Boolean(mvcur?.mvData?.canReport),canEditVideo:Boolean(mvcur?.mvData?.editHash),canDeleteVideo:Boolean(mvcur?.mvData?.deleteHash),canAddToFavorite:Boolean(m),canViewStatistic:Boolean(!isNaN(Number(mvcur?.mvData?.stats?.stat_vid))&&!isNaN(Number(mvcur?.mvData?.stats?.stat_oid))),isFavorite:Boolean(c),isActiveLive:Boolean(opt.mvData.is_active_live),isShortVideo:opt.mvData.shortVideo,addedToMy:opt.mvData.added,playlists:opt.mvData.playlists,withUMA:v,mainOwnerId:w,owner:{id:p,screen_name:(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_author_link_bugfix")?t:opt.mvData.authorHref,photo_50:opt.mvData.authorPhoto,href:(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_author_link_bugfix")?t:opt.mvData.authorHref,name:o,verified:l,ownerFullNameGenitive:b,ownerVerifiedByServices:u,formattedSubscribersText:s>0?(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.getFormattedBigSubscribersToShortCase)(s):""},trackCode:opt.mvData.track_code,moderationVideoInfo:M,featuredArtists:T,subTitle:g,isExplicit:I,releaseDate:C,genre:L,otherArtists:y,canDownloadVideo:D,moderActions:A,claimedBlock:R,unauthLikesBox:B,statisticLink:f,isFromMessage:V,isScheduled:W,publishDate:U,canLike:!opt.mvData.nolikes||!window.vk.id,canShare:K,canAddToPlaylist:Boolean(window.vk.id&&opt.mvData.can_add),isExternal:S,videoType:k};E&&(N.secondaryOwner={...E,formattedSubscribersText:(0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.getFormattedBigSubscribersToShortCase)(s)});const z=x(document.getElementById("mv_main_info"),N);z&&(this.unmountVideoModalInfo=z)}))}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_tree_comments")&&!mvcur.mvData.is_active_live){const e={ownerId:opt.mvData.oid,videoId:opt.mvData.vid};getVideoModalBlocks().then((({initComments:_})=>{_(document.getElementById("video-modal-comments"),e)}))}if(opt.videoModalPlayerContextRefactoringEnabled&&mvcur.options.playlistId)Videoview.buildVideoModalPlayerContext({videoId:mvcur.videoRaw,playlistId:mvcur.options.playlistId,ownerId:cur.oid});else{if(opt.pl_list&&!mvcur.mvData.shortVideo&&!mvcur.mvData.is_active_live){const e=JSON.parse(opt.pl_list);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)(e,((e,_)=>{_.is_subscribed=mvcur.pl_is_subscribed,_.can_subscribe=mvcur.pl_can_subscribe,_.force_layout=mvcur.forcePlaylistLayout,_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.addList(_)})),Videoview.initPlaylistBlock(mvcur.videoRaw,mvcur.options.playlistId)}_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.toggleStateClasses(),Videoview.toggleRecommsColumn(!0)}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_goods_recognition")&&(0,_web_videoview_GoodsRecognition_init__WEBPACK_IMPORTED_MODULE_36__.renderGoodsRecognitionPanel)(),opt.interactiveVideoOnboardingData&&getInteractiveVideoOnboardingChunk().then((({showOnboarding:e})=>{mvcur.isInteractiveOnboardingShowed=Boolean(opt.interactiveVideoOnboardingData.length);e(opt.interactiveVideoOnboardingData,(()=>{mvcur.isInteractiveOnboardingShowed=void 0}))})),js){const jsExpr=`(function(){${js}})()`;try{eval(jsExpr)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.logEvalError)(e,jsExpr)}}if(opt.publishAction){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_publish");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(e,opt.publishAction),cur.is_web_streaming||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(e),setTimeout((()=>{document.getElementById("mv_layer_wrap").scroll({top:0,behavior:"smooth"})}),150)}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_publish");Videoview.initAsyncComment();const mvMain=document.getElementById("mv_main");if(opt.livePreparationBlock)_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.removeBlock(),mvcur.preparationBlock=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)(opt.livePreparationBlock),mvMain?.appendChild(mvcur.preparationBlock);else if(mvcur.chatMode&&opt.chatBlock){_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.removeBlock();const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.se)(opt.chatBlock);mvMain?.appendChild(e),window.VideoChat&&(window.VideoChat.init(e,{forceStickerPack:opt.chatForceStickerPack,noStickers:!!opt.noStickers,messageData:opt.messageData,chatActionHash:opt.chatActionHash}),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_live_comments_from_api")||window.VideoChat.toggleStateClasses(),opt.publishAction&&document.getElementById("mv_chat_block")?.classList.add("mv_chat--no-rounding"))}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_box","_has_preparation",!!mvcur.preparationBlock&&!mvcur.minimized),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_layer","mv_layer--vertical",!!mvcur.mvData.shortVideo),mvcur.mvData.shortVideo?window.mvLayer.setAttribute("scheme","vkcom_dark"):window.mvLayer.removeAttribute("scheme"),mvcur.mvData.shortVideo&&(_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.removeBlock(),mvcur.onReplyFormSizeUpdate=mvcur.onMediaChanged=()=>{Videoview.updateLayoutSizes()},mvcur.scrollBottom=()=>{mvcur.uiScroll.scrollBottom(0,!0)});const replyField=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("reply_field"+mvcur.post);if(replyField&&(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_5__.placeholderInit)(replyField,{editable:1}),mvcur.minimized&&needRemin&&Videoview.minimizePlayer(),mvcur.statusVideo){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("like_count"+mvcur.mvData.videoRaw);if(e){const _=e.parentNode.tt;_&&_.container&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)(_.container),e.parentNode.tt&&delete e.parentNode.tt}}if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_player_box"),opt.player_unavailable&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("video_player")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("video_player").focus(),window.updateWndVScroll&&window.updateWndVScroll(),(mvcur.options||{}).scroll&&(mvLayerWrap.scrollTop=mvcur.options.scroll,mvcur.options.scroll=0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_info","mv_info_invisible",!!(mvcur.options.hideInfo&&mvcur.mvData.noControls&&mvcur.minimized)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)("mv_info","mv_info_disabled"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_warning"),!mvcur.mvData.noControls){const e=!!mvcur.minimized&&mvcur.minSize.wrap.w;Videoview.setTitle(e),Videoview.initAddButton(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_edit_button"),mvcur.mvData.editHash&&!mvcur.mvData.hideEdit&&!mvcur.mvData.editFromDropdown)}mvcur.mvData.is_active_live||Videoview.adaptRecomsHeight(),Videoview.updateSize(),opt.queueParams&&window.stManager.add(window.jsc("web/notifier.js"),(function(){Videoview.queueCheckUpdates(opt.queueParams)})),mvcur.mvData.uploaded||Videoview.recache(),mvcur.mvData.is_live&&setTimeout(window.VideoLive?.checkOtherLives.pbind(videoRaw),6e4),Videoview.isVideoListEmpty()&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)("mv_box","_no_video_list"),Videoview.viewScroll())},buildVideoModalPlayerContext(e){if(document.querySelector(".js-video-modal-player-context"))return;const _=document.getElementById("mv_main"),i=document.getElementById("mv_box"),o=document.createElement("div"),t=_.firstChild;o.setAttribute("id","video_mvpl"),o.classList.add("mv_playlist","js-video-modal-player-context"),i.classList.add("_has_playlist","_hide_recomms"),i.classList.remove("_hide_playlist"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)("mv_top_pl_toggle","aria-label",(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_aria_minimize_playlist")),_.insertBefore(o,t),getVideoModalBlocks().then((({initVideoModalPlayerSidebar:_})=>{_(o,e)}))},adaptRecomsHeight:(0,_shared_lib_throttle__WEBPACK_IMPORTED_MODULE_58__.throttle)((()=>{const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_info_wrapper","mv_info"),_=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_recommendations")?null:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)("mv_info_narrow_column","mv_info");if(!e||!_)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("mv_recom_item",_);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(...i);const o=document.querySelector("#mv_box")?.classList.contains("_has_recomms"),t=document.querySelector("#mv_box")?.classList.contains("_hide_recomms"),s=document.getElementById("react_rootVideoMarketItemsCarousel"),d=document.querySelector(".VideoLayerInfo__recommended");if(o&&!d)return;const a=document.querySelector("#mv_box")?.classList.contains("_has_playlist"),n=null!==s?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(s)[1]:0,r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(_)[1]-n;let l=i.length;const c=mvcur?.mvData?.isMusicVideo?2:3;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)(i.reverse(),((i,s)=>{const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(_)[1],m=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(e)[1],v=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(d)[1];if(o&&!t){if(v<=r&&(!a||n<=m)||l===c)return!1}else if(n<=m||l===c)return!1;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)(s),l--}))}),50),liveHighloadStateChanged(e){window.Videoview.isHighloadLive=e,(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_live_unauth_reload_bugfix")&&!window.VideoChat||e||(window.VideoChat?.sendBatchOfMessages(),window.Videoview.queueReconnect())},queueCheckUpdates(e){window.mvcur&&mvcur.mvShown&&mvcur.queueKey===e.key&&(window.Videoview.isHighloadLive&&(window.VideoChat?.isHidden()||window.Videoview.isFS)||(window.Notifier&&Notifier.addKey(e,Videoview.queueReceiveUpdates),setTimeout(Videoview.queueCheckUpdates.pbind(e),25e3)))},queueReconnect(e){const _=Videoview.getMvData(),i=_.oid,o=_.vid,t=i+"_"+o;e?window.ajax.post("al_video.php?act=get_queue_params",{oid:i,vid:o,hash:_.hash},{onDone:function(e){e&&Videoview.isLayerShown(t)&&(mvcur.queueKey=e.key,Videoview.queueCheckUpdates(e))},onFail:function(){return!0}}):(mvcur.queueReconnectDelay=mvcur.queueReconnectDelay?2*mvcur.queueReconnectDelay:500,mvcur.queueReconnectTimeout&&clearTimeout(mvcur.queueReconnectTimeout),mvcur.queueReconnectTimeout=setTimeout((()=>{window.Videoview.isLayerShown(t)&&window.Videoview.queueReconnect(!0),mvcur.queueReconnectTimeout=null}),mvcur.queueReconnectDelay))},queueReceiveUpdates(e,_){if(window.mvcur&&mvcur.mvShown&&mvcur.queueKey===e&&_){if(_.failed)return(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)("video queue failed",_),mvcur.queueKey=null,void Videoview.queueReconnect();delete mvcur.queueReconnectDelay,mvcur.queueBatchId=(mvcur.queueBatchId||0)+1,_.events&&_.events.length&&_.events.forEach((e=>{const _=e.split("<!>"),o=Number(_[0]),t=_[1];if(o===mvcur.qversion)switch(t){case"new_reply":mvcur.chatMode||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_tree_comments")||(Videoview.appendNewComment.apply(Videoview,_.slice(2)),Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos());break;case"new_reply_chat":{const e=+_[10],i=!!_[11];mvcur.chatMode&&window.VideoChat?.receiveMessage.apply(window.VideoChat,_.slice(2)),i&&!e&&mvcur.player&&mvcur.player.pushDonation("comment",{senderId:_[4],senderName:_[5],senderPhoto:_[6],senderHref:_[7],senderSex:_[8],commentText:_[9]})}break;case"edit_reply":{const e=_[2],o=_[3],t=_[4],s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("wpt"+i(e,o));s&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)(s,"data-action")&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(s,t),Videoview.updateReplyFormPos())}break;case"del_reply":{const e=_[2],o=_[3];if(mvcur.chatMode)window.VideoChat?.receiveDelete(e,o);else{const _=document.getElementById("post"+i(e,o));_?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)(_,"data-action")||(mvcur.mvData.commcount--,mvcur.mvData.commshown--,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)(_)):mvcur.mvData.commcount--,Videoview.updateCommentsHeader(),Videoview.updateReplyFormPos()}}break;case"like_reply":{const e=_[2],o=_[3],t=+_[4],s=+_[5],d=_[6],a=document.getElementById("wpe_bottom"+i(e,o));if(a){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(a,"_like_wrap"),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domByClass)(e,"_count");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(_,t>0?t:""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(e,"no_likes",!t),s==vk.id&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)(e,"my_like",!d)}}break;case"like":{const e=_[4],i=_[5];mvcur.chatMode&&!i&&window.VideoChat&&window.VideoChat.appendSticker("like",e)}break;case"sticker":{const e=_[3],i=_[4];mvcur.chatMode&&window.VideoChat&&window.VideoChat.appendSticker(e,i)}break;case"video_view":window.VideoLive?.updateLiveViewersCount(_[2]);break;case"gift":mvcur.player&&mvcur.player.pushDonation("gift",{senderId:_[2],senderName:_[3],senderPhoto:_[4],senderHref:_[5],senderSex:_[6],giftId:_[7]});break;case"end_live":{const e=_[2];if(!window.Videoview.isLayerShown(e))break;const i=document.querySelector("#mv_publish .mv_stop_streaming_button");i&&(_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_31__.FlatButton.setLabel(i,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_live_finished")),_web_ui_FlatButton__WEBPACK_IMPORTED_MODULE_31__.FlatButton.setDisabled(i,!0));Number(_[3])!==o&&Boolean(_[3])&&(window.cur.is_web_streaming?window.VideoWebStreaming?.stopOnDelete():(window.Videoview.hide(!0,!0,null,!0),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showFastBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_live_display_screen_ended_title"),(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_live_ended_deleted"))))}break;case"live_midroll":if(mvcur.player){const e=_[2];mvcur.player.pushLiveMidroll(e)}break;case"set_action_button":{const e=(0,_shared_lib_parse__WEBPACK_IMPORTED_MODULE_7__.parseJSON)(_[2]);mvcur.player.setActionButton(e)}break;case"pin_comment":if(mvcur.chatMode&&window.VideoChat){const e=_[2],i=_[3],o=_[4],t=_[5],s=_[6],d=_[7],a=_[9],{canDeleteComment:n,canReportComment:r,canPinComment:l}=VideoChat.getMessageAccessFlags(e,i);window.VideoChat.showPinnedMessage(e,i,o,t,s,d,l,n,r,a)}break;case"unpin_comment":mvcur.chatMode&&window.VideoChat&&window.VideoChat.hidePinnedMessage();break;case"start_live":case"live_edit":case"live_change_phase":break;default:(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)("Videoview: unhandled video event",_)}}))}function i(e,_){return e+"video_"+_+"mv"}},appendNewComment(e,_,i,o,t,s,d,a,n,r,l){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("post"+e+"video_"+_+"mv"))return;const{adminLevel:c,canDeleteComments:m}=Videoview.getMvData();let v="";c>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_33__.GroupAdminLevel.USER||m||e==vk.id||i==vk.id?v+=mvcur.commentsTpl.del_reply:e!=i&&(v+=mvcur.commentsTpl.spam_reply),(c>_shared_groups_constants__WEBPACK_IMPORTED_MODULE_33__.GroupAdminLevel.MODERATOR&&e==i||o==vk.id)&&(v+=mvcur.commentsTpl.edit_reply),v=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.rs)(mvcur.commentsTpl.actions,{actions:v});const E=langDate(1e3*a,(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("global_short_date_time","raw"),0,[]),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.rs)(mvcur.commentsTpl.reply,{actions:v,post_oid:e,reply_id:e+"video_"+_+"mv",reply_msg_id:_,from_id:i,name:o,photo:t,href:s,message:d,date:E,to_link:n,likes:window.Likes.makeTemplate(mvcur.commentsTpl.likes,{object_raw:`${e}_${_}`})});mvcur.mvReplyNames[i]=[r,l],(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_comments").insertAdjacentHTML("beforeend",u),mvcur.mvData.commcount++,mvcur.mvData.commshown++},reload(){const{videoRaw:e,shortVideo:_}=Videoview.getMvData();e&&(Videoview.hide(!0,!0),Videoview.recache(e),(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_2__.showVideo)(e,mvcur.listId,{autoplay:1,shortVideo:_?1:0}))},onVideoShared(e,_,i){"publish"!=e||Videoview._isCurrentVideoPublished()||(Videoview.hide(!0,!0),setTimeout((function(){0==_.indexOf("video")&&(_=_.substr(5)),Videoview.recache(_),(0,_web_lib_video__WEBPACK_IMPORTED_MODULE_2__.showVideo)(_,i)}),100))},_onAddToCommunity(e=mvcur.mvData.oid,_=mvcur.mvData.vid){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("al_video.php?act=add_to_club_pl_box",{oid:e,vid:_})},_onEdit(e=!1,_=!1,i=!1){const{oid:o,vid:t,videoRaw:s}=Videoview.getMvData();if(i)(0,_web_lib_snackbar__WEBPACK_IMPORTED_MODULE_47__.showSnackbar)({text:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_clips_promo_edit_warning").replace(/<br>/g,"\n"),type:"warning",timeout:3e3});else if(e&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("clips_syncing_clips_with_posts_web")){(()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,908987)))().then((({initEditClipModal:e})=>{e(s,(e=>{Videoview.setDesc(e.description);const _=document.getElementById(`post${(0,_vkontakte_internal_shared__WEBPACK_IMPORTED_MODULE_63__.joinRawId)({ownerId:e.ownerId,itemId:e.wallPostId})}`);if(e.wallPostId&&_)return(0,_web_feed_utils_updatePost__WEBPACK_IMPORTED_MODULE_50__.updatePost)(e.wallPostId,e.ownerId)}))}))}else Videoview.showEditBox(t,o,null,!1,e,_)},_onDelete(e=!1){if(e)return void(0,_web_lib_snackbar__WEBPACK_IMPORTED_MODULE_47__.showSnackbar)({text:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_clips_promo_delete_warning").replace(/<br>/g,"\n"),type:"warning",timeout:3e3});const{oid:_,vid:i,deleteHash:o}=Videoview.getMvData();Videoview.deleteVideo(i,_,o,!1,"videoviewer")},_onExport(e){Videoview.sendVideo(e,{isExport:!0})},_onViewStats(){(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("al_stats.php",{act:"video_stat",oid:mvcur.mvData.stats.stat_oid,vid:mvcur.mvData.stats.stat_vid},{params:{width:795,bodyStyle:"padding: 0"}})},addToClubPlaylistCheckboxChanged(e){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.checkbox)(e);let _=!1;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("mv_add_to_club_albums_list_item"),((e,i)=>{if((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(i))return _=!0,!1}));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_add_to_club_albums_save");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)(i,!1),_||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)(i,!0)},addToClubPlaylistBoxInit(e,_,i,o,t){WideDropdown.deinit("add_to_pl_club_dd");const s=WideDropdown.init("add_to_pl_club_dd",{defaultItems:_,noResult:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("search_nothing_found"),introText:"choose",onChange:function(e,_){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_add_to_club_albums"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_add_to_club_albums_list",""),-1==e)return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_add_to_club_gid",""),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_add_to_club_albums_save"),!0);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_add_to_club_albums_progress"),window.ajax.post("al_video.php?act=a_get_club_playlists",{gid:_,oid:window.mvcur?.mvData.oid||o,vid:window.mvcur?.mvData.vid||t},{onDone:function(e){let i="",o=0;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)(e,(function(_,t){const s=t.added||1===e.length;s&&o++,i+=`<div class="mv_add_to_club_albums_list_item checkbox ${s?"on":""}" data-id="${t.id}" onclick="Videoview.addToClubPlaylistCheckboxChanged(this)">${t.title}</div>`})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_add_to_club_albums_list",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_add_to_club_gid",_),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_add_to_club_albums_progress"),e.length>1&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_add_to_club_albums");const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_add_to_club_albums_save");(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)(t,!1),o||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)(t,!0)}})}});window.mvcur&&(window.mvcur.addToClubPl=s),setTimeout(_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.elfocus.pbind("add_to_pl_club_dd_input"),0),e.removeButtons();const d=e.addButton((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("Save"),(function(e){const _=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)("mv_add_to_club_albums_list_item"),(function(e,i){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.isChecked)(i)&&_.push((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)(i,"data-id"))})),window.ajax.post("al_video.php?act=a_add_to_playlist",{hash:i,gid:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_add_to_club_gid"),oid:window.mvcur?.mvData.oid||o,vid:window.mvcur?.mvData.vid||t,playlists:_.length?_:"0",module:Videoview.getVideoModule(),context:Videoview.getVideoContext()},{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.lockButton)(e),hideProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.unlockButton)(e),onDone:function(e,_){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.curBox)().hide(),_.added.length?(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.showDoneBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_add_to_playlist_added")):(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.showDoneBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_add_to_playlist_error"))}})}),null,!0);d.id="mv_add_to_club_albums_save",(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.disableButton)(d,!0)},setTitle(e){const _=mvcur.mvData.title||"",i=mvcur.mvData.subtitle||"";e=e||590,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_min_title",Videoview._isCurrentVideoPublished()?(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.stripHTML)(_):""),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_min_title",{maxWidth:Math.max(0,e-70)});const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_title");o&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(o,_+i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(o,{display:"block"}),o.scrollHeight>o.offsetHeight&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.attr)(o,"title",(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.stripHTML)(_))),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(o,{display:""}))},timeTagClick(e,_,i){const o=Videoview.getPlayerObject();if(o.interactive)return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(i);if(o){o.seekTo(e,!1,!0,"episode"),o.play(!1);const i=o.el.getBoundingClientRect();window.mvLayerWrap&&i.top<.5*-i.height&&(mvLayerWrap.scrollTop+=i.top),this.isVideoPageEnabled()&&o.el.scrollIntoView({behavior:"smooth",block:"center"}),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("video_time_codes_seek","",_)}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(i)},clipDescriptionLinkClickHandler(e){const _=e.target;if("A"!==_.tagName)return;const i=(e,_)=>{_shared_production_stats__WEBPACK_IMPORTED_MODULE_45__.clipDescriptionStatsCollector.logEvent({event_type:_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_46__.ClipDescriptionEventTypes.CLICK_TO_DESCRIPTION,video_owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid,object_type:e,object_value:_})},o=_.getAttribute("mention_id"),t=_.href,s=_.innerText;o?i(_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_46__.ClipDescriptionLinkTypes.MENTION,o):t.indexOf("/clips/hashtag/")>0?i(_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_46__.ClipDescriptionLinkTypes.HASHTAG,s):i(_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_46__.ClipDescriptionLinkTypes.LINK,t)},expandDescr(e){if(e){const e=document.querySelector("#mv_descr_field"),_=document.querySelector("#mv_desc_full_text"),i=document.querySelector("#mv_descr_expand_toggle");"block"!==_.style.display?(e.style.display="none",_.style.display="block",i.textContent=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_collapse_extended_description"),_shared_production_stats__WEBPACK_IMPORTED_MODULE_45__.clipDescriptionStatsCollector.logEvent({event_type:_shared_production_stats_types__WEBPACK_IMPORTED_MODULE_46__.ClipDescriptionEventTypes.CLICK_TO_EXPAND_DESCRIPTION,video_owner_id:mvcur.mvData.oid,video_id:mvcur.mvData.vid})):(e.style.display="block",_.style.display="none",i.textContent=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_view_expand_description"))}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_descr_field",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)("mv_desc_full_text")),Videoview.cleanExpandDescrEls();Videoview.onResize()},cleanExpandDescrEls(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)("mv_desc_full_text"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)("mv_descr_expand_toggle")},formatClipDescription:e=>(0,_shared_utils_replaceHashtags__WEBPACK_IMPORTED_MODULE_44__.replaceHashtags)((0,_shared_video__WEBPACK_IMPORTED_MODULE_39__.formatTextWithLinks)(e),(e=>`<a href="/clips/hashtag/${encodeURIComponent(e.slice(1))}">${e}</a>`)),setDesc(e){const _=document.getElementById("mv_descr_field"),i=document.getElementById("mv_desc_full_text"),o=document.getElementById("mv_descr_expand_toggle"),t=e||mvcur.mvData.desc||"";if(!_)return;if(!mvcur.mvData.shortVideo||!i)return void(_.innerHTML=t);const s=t.length>300?t.substring(0,300).replace(/\s+\S*$/,"")+"...":t;_.innerHTML=Videoview.formatClipDescription(s),_.style.display="none",i.innerHTML=Videoview.formatClipDescription(t),i.style.display="block",o&&(o.textContent=s.length<t.length?(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_collapse_extended_description"):"")},setPostponePublicationDesc(e){const _=document.querySelector(".mv_title_info");_&&e&&(_.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_postponed_publication")+": "+e)},setUpcomingLiveDesc(e){const _=document.querySelector(".mv_title_info");if(_&&e){const i=(0,_web_video_video_utils__WEBPACK_IMPORTED_MODULE_30__.getFormattedPostponePublishDateTime)(e);_.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_upcoming_live_title_info")+" "+i.toLowerCase()}},getContSize:()=>(mvcur.contSize||(mvcur.contSize=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)("mv_box")),mvcur.contSize),getContPlace(e){let _=0;const i=Videoview.getContSize(),o=e.clientX-mvcur.minSize.wrap.l,t=e.clientY-mvcur.minSize.wrap.t;return t<6&&(_+=1),o>i[0]-20&&(_+=2),t>i[1]-10&&(_+=4),o<10&&(_+=8),1==_&&o>i[0]-55&&(_=0),!_&&t<25&&o<i[0]-55&&(_+=16),_},changeCursor(e){if(Videoview.isFS)return;const _=Videoview.getContPlace(e);let i="default";if(_&&mvcur.minimized){let e="";1&_&&(e+="n"),4&_&&(e+="s"),2&_&&(e+="e"),8&_&&(e+="w"),i=e+"-resize",16&_&&(i="move")}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_box",{cursor:i})},getMinSize(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_player_box")||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_progress_box");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(mvcur.minSize,{wrap:{t:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(mvLayerWrap.style.top),l:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(mvLayerWrap.style.left),w:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(mvLayerWrap.style.width),h:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(mvLayerWrap.style.height)},player:{w:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(e.style.width),h:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.intval)(e.style.height)}})},startDrag(e){if(Videoview.isFS||e.button&&1!==e.button)return;const _=Videoview.getContPlace(e);if(!_)return;const i=Date.now();Videoview.getMinSize(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(mvcur.minSize,{x:e.clientX,y:e.clientY}),mvcur.resizeDiff=0;const o=!_||16&_?Videoview.onMinMove:Videoview.onMinResize;mvcur.resizeMask=_;const t=function(e){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"mouseup",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"mousemove",o),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"drag",o);const s=Date.now();return Videoview.getMinSize(),mvcur.resizeDiff<8&&s-i<400&&(16&_||1==_)&&Videoview.unminimize(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(mvLayerWrap,"mv_resizing"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)("mv_player_box","no_events"),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)("mv_box","mousemove",Videoview.changeCursor),ls.set("mv_minSize",mvcur.minSize),!1};return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(mvLayerWrap,"mv_resizing"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)("mv_player_box","no_events"),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"mouseup",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"mousemove",o),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"drag",o),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)("mv_box","mousemove",Videoview.changeCursor),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},onMinMove(e){let _=0,i=0;return e&&(i=e.clientY-mvcur.minSize.y,_=e.clientX-mvcur.minSize.x),mvcur.minSize.wrap.t+i>mvcur.minSize.ch-mvcur.minSize.wrap.h-15&&(i=mvcur.minSize.ch-mvcur.minSize.wrap.h-mvcur.minSize.wrap.t),mvcur.minSize.wrap.l+_>mvcur.minSize.cw-mvcur.minSize.wrap.w-15&&(_=mvcur.minSize.cw-mvcur.minSize.wrap.w-mvcur.minSize.wrap.l),mvcur.minSize.wrap.t+i<15&&(i=-mvcur.minSize.wrap.t),mvcur.minSize.wrap.l+_<15&&(_=-mvcur.minSize.wrap.l),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(mvLayerWrap,{top:mvcur.minSize.wrap.t+i+"px",left:mvcur.minSize.wrap.l+_+"px"}),mvcur.resizeDiff=Math.max(Math.abs(_),Math.max(Math.abs(i),mvcur.resizeDiff)),!!e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},onMinResize(e){const _=mvcur.resizeMask;let i=0,o=0,t=1&_||4&_?e.clientY-mvcur.minSize.y:0,s=2&_||8&_?e.clientX-mvcur.minSize.x:0;4&_&&mvcur.minSize.wrap.t+t>mvcur.minSize.ch-mvcur.minSize.wrap.h&&(t=mvcur.minSize.ch-mvcur.minSize.wrap.h-mvcur.minSize.wrap.t),1&_&&mvcur.minSize.wrap.t+t<0&&(t=-mvcur.minSize.wrap.t),2&_&&mvcur.minSize.wrap.l+s>mvcur.minSize.cw-mvcur.minSize.wrap.w-14&&(s=mvcur.minSize.cw-mvcur.minSize.wrap.w-mvcur.minSize.wrap.l-14),8&_&&mvcur.minSize.wrap.l+s<0&&(s=-mvcur.minSize.wrap.l),8&_&&(i=s,s=-s),1&_&&(o=t,t=-t),mvcur.minSize.wrap.w+s<307&&(s=307-mvcur.minSize.wrap.w,8&_&&(i=-s)),mvcur.minSize.wrap.h+t<200&&(t=200-mvcur.minSize.wrap.h,1&_&&(o=-t)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(mvLayerWrap,{left:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.positive)(mvcur.minSize.wrap.l+i)+"px",top:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_18__.positive)(mvcur.minSize.wrap.t+o)+"px",width:mvcur.minSize.wrap.w+s+"px",height:mvcur.minSize.wrap.h+t+"px"});const d={width:mvcur.minSize.player.w+s+"px",height:mvcur.minSize.player.h+t+"px"};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_player_box",d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_progress_box",d);const a=Math.abs(s)+Math.abs(t);return mvcur.resizeDiff=Math.max(a,mvcur.resizeDiff),mvcur.contSize=!1,Videoview.setTitle(mvcur.minSize.wrap.w+s),Videoview.playerOnResize(),window.ExternalVideo?.updateExternalVideoFinishBlock(),!1},minimize(e){if(e&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e),mvcur.minimized)return!1;document.querySelector(".VideoLayout")?.classList.remove("VideoLayout--hidden"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_min_header"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)("mv_info","mv_info_invisible"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("VerticalVideoLayerInfo__topControls"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("VideoLayerInfo__topControls"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.isVisible)("mv_approve")?(mvcur.needShowApprove=!0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_approve")):mvcur.needShowApprove=!1,mvcur.options.fromPreload&&(mvcur.options.fromPreload=!1),window.Wall?.cancelEdit(!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(mvLayerWrap,"mv_minimized"),mvcur.minSize||(mvcur.minSize=ls.get("mv_minSize")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(document.body,"Videoview"),layers.fullhide=!1,mvcur.minSize&&Videoview.enabledResize()&&mvcur.minSize.wrap.w||(mvcur.minSize={wrap:{w:307,h:200}}),mvcur.mvData.shortVideo&&(mvcur.minSize={wrap:{w:307,h:520}},(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_main"),{width:"auto"}));const _=mvcur.minSize.wrap;mvcur.minSize.player={w:_.w-12,h:_.h-34},Videoview.setStyle("mvContainer","mv_container",{height:"auto",marginTop:0,marginBottom:0,width:"100%"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(window.mvLayer,{width:"auto"}),Videoview.minimizePlayer(),window.tooltips&&tooltips.destroyAll("mv_container"),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",Videoview.onResize),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(document,"keydown",Videoview.onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",Videoview.minResize),Videoview.enabledResize()?((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)("mv_box","mousedown",Videoview.startDrag),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)("mv_box","mousemove",Videoview.changeCursor),mvcur.minDestroy=function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)("mv_box","mousedown",Videoview.startDrag),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)("mv_box","mousemove",Videoview.changeCursor),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_box",{cursor:"default"})}):((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_min_title"),"click",Videoview.unminimize),mvcur.minDestroy=function(){(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)("mv_min_title","click",Videoview.unminimize)}),Videoview.setTitle(_.w),Videoview.minResize(),Videoview.setStyle("mvLayerWrap",mvLayerWrap,{width:mvcur.minSize.wrap.w+"px",height:mvcur.minSize.wrap.h+"px"}),mvcur.minimized=!0,layers.wraphide(),setTimeout(Videoview.playerOnResize,10);let i=window.layerQueue.count();return mvcur.noLocChange||(Videoview.backLocation(),mvcur.noHistory=1),window.layerQueue.skipVideo=!0,i&&((0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_17__.debugLog)("pop from minimize"),window.layerQueue.pop()),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("feed_post_video_layer_close_wkview_restore")&&window.wkcur?.shown&&window.wkLayerWrap&&window.WkView?.showLayer(),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.toggleStateClasses(),window.VideoChat&&(window.VideoChat.toggleStateClasses(),Videoview.toggleRecommsColumn()),mvcur.preparationBlock&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)("mv_box","_has_preparation"),window.ExternalVideo?.updateExternalVideoFinishBlock(),!1},isLayerShown:e=>!(!window.mvcur||!mvcur.mvShown||null!=e&&mvcur.videoRaw!=e),isMinimized:()=>!!(window.mvcur&&mvcur.mvShown&&mvcur.minimized),getRelatedVideos(e,_){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass1)(e,"mv_info");return i?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.geByClass)(_,i):[]},getOtherVideosCount:()=>Videoview.getRelatedVideos("mv_info_narrow_column","mv_recom_item").length,getRecommendationsCount:()=>Videoview.getRelatedVideos("mv_playlist_list_cont","VideoRecomsItem").length,isVideoListEmpty:()=>0===Videoview.getOtherVideosCount()&&0===Videoview.getRecommendationsCount(),enabledResize:()=>!_shared_lib_browser__WEBPACK_IMPORTED_MODULE_1__.browser.mobile,minimizePlayer(){const e={width:mvcur.minSize.player.w+"px",height:mvcur.minSize.player.h+"px"};(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_player_box",e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_progress_box",e),Videoview.playerOnResize()},minResize(){mvcur.minSize.ch=window.innerHeight||htmlNode.clientHeight||document.body.clientHeight,mvcur.minSize.cw=window.innerWidth||htmlNode.clientWidth||document.body.clientWidth;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("page_layout"));void 0===mvcur.minSize.wrap.t&&(mvcur.minSize.wrap.t=mvcur.minSize.ch-mvcur.minSize.wrap.h),void 0===mvcur.minSize.wrap.l&&(mvcur.minSize.wrap.l=Math.max(String(e[0]-mvcur.minSize.player.w/2),30)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(mvLayerWrap,{left:mvcur.minSize.wrap.l+"px",top:mvcur.minSize.wrap.t+"px"}),Videoview.onMinMove(),mvcur.minimized&&Videoview.getMinSize()},unminimize(e,_,i){if(!mvcur.minimized)return;const o=window.wkcur,t=window.WkView;return o&&"story"==o.type&&window.Stories&&t.hide(!1,!0),i||window.layerQueue.push(),_||(window.layerQueue.hide(),setTimeout((function(){mvcur.noHistory=1,window.layerQueue.noHistory(),layers.wrapshow(mvLayerWrap,.7),layers.fullhide=Videoview.hide}),0)),Videoview.hidePlayer(!0),mvcur.minimized=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(mvLayerWrap,"mv_minimized"),Videoview.restoreStyle("mvLayerWrap",mvLayerWrap),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_info","mv_info_invisible",!!(mvcur.options.hideInfo&&mvcur.mvData.noControls&&mvcur.minimized)),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_min_header"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("VerticalVideoLayerInfo__topControls"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("VideoLayerInfo__topControls"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(document.body,"Videoview"),mvcur.needShowApprove&&(mvcur.needShowApprove=!1,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_approve")),Videoview.restoreStyle("mvContainer","mv_container"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_player_box",{width:"",height:""}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)("mv_progress_box",{width:"",height:""}),Videoview.updateSize(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",Videoview.onResize),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(document,"keydown",Videoview.onKeyDown),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",Videoview.minResize),mvcur.minDestroy&&mvcur.minDestroy(),mvcur.noLocChange||!0===e||Videoview.setLocation(),window.onBodyResize(!0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(mvLayerWrap,{left:"0px",top:"0px"}),Videoview.showPlayer(!0),Videoview.setTitle(),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.toggleStateClasses(),mvcur.chatMode&&window.VideoChat&&(window.VideoChat.initChatComponent(mvcur.messageData),window.VideoChat.initChatHideButton(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_live_comments_from_api")||window.VideoChat.toggleStateClasses()),mvcur.preparationBlock&&!cur.is_web_streaming&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)("mv_box","_has_preparation"),Videoview.toggleRecommsColumn(),Videoview.viewScroll(),Videoview.playerOnResize(),Videoview.updateLayoutSizes(),mvcur.mvData.is_active_live&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hasClass)("mv_box","_has_recomms")||Videoview.adaptRecomsHeight(),mvcur.chatMode&&window.Videoview.isHighloadLive&&!window.VideoChat?.isHidden()&&(window.VideoChat?.sendBatchOfMessages(),window.Videoview.queueReconnect()),!1},toggleSideBlock(e){let _=!1;const i=document.querySelector(".js-video-modal-player-context"),o=document.getElementById("mv_box");if(mvcur.chatMode&&window.VideoChat){window.VideoChat.toggle();const e=!window.VideoChat.isHidden();mvcur.player?.onChatVisibilityChange?.(e)}else if(i&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context"))o.classList.toggle("_hide_playlist");else if(_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getBlock())_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.toggle();else if(o.classList.contains("_has_recomms")){const e=o.classList.contains("_hide_recomms");o.classList.toggle("_hide_recomms",!e),_=!0}if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_goods_recognition")&&(0,_web_videoview_GoodsRecognition_init__WEBPACK_IMPORTED_MODULE_36__.hideGoodsBlock)(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")){const e=document.getElementById("mv_box");e?.classList.contains("_has_time_codes")&&Videoview.closeTimeCodesList()}else _web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList.isShowed()&&_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList.close();return Videoview.updateLayoutSizes(),_&&Videoview.adaptRecomsHeight(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},sendVideo(e,{fromTime:_=0,isExport:i=!1}){Videoview.hidePlayer();const o={stat:[window.jsc("web/page.js"),"page.css",window.jsc("web/wide_dd.js"),"wide_dd.css",window.jsc("web/sharebox.js")],params:{}};e&&(o.params.width=686);(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_15__.showBox)("like.php?act=publish_box",{object:"video"+mvcur.videoRaw,list:mvcur.listId,is_export:Number(i),from_time:_},o).setOptions({onHideAttempt:function(){return Videoview.showPlayer(),!0}}),Videoview.playerNextTimerUpdate()},showReportVideoForm(e=mvcur.mvData.oid,_=mvcur.mvData.vid,i){i=i&&"function"==typeof i?i:()=>{},(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__.showReportForm)("video",e,_,i)},showReportVideoCommentForm(e,_){(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__.showReportForm)("video_comment",e,_,(()=>(0,_web_reports_reports__WEBPACK_IMPORTED_MODULE_27__.afterCommentReportSubmit)("video",e,_)))},reportComment(e,_,i){window.stManager.add([window.jsc("web/privacy.js"),"privacy.css"],(function(){return Privacy.show(e,_,"report_"+i)}))},descTT:e=>(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_16__.showTooltip)(e,{text:(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_edit_desc"),black:1,shift:[0,7,0],showdt:0,appendEl:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.domPN)(e)}),viewScroll(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)("mv_main",!0)[1],_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)("mv_player_box")[1];let i=e-6;i=i<0?-i:0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("VideoLayerInfo__topControls","VideoLayerInfo__topControls--fixed",i>0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_pl_prev","fixed",i>0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_pl_next","fixed",i>0),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.toggleClass)("mv_top_pl_toggle","hidden",i>_),mvcur.scrolledAway=i>_/3,Videoview.playerNextTimerUpdate(),Videoview.updateReplyFormPos()},updateReplyFormPos(){if(mvcur.mvData?.shortVideo)return;const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_reply_form");if(!e)return;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_comments_wrap"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_reply_form_wrap"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.clientHeight)(),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(e),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(mvLayerWrap)[1],d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getXY)(_)[1]-s,[a,n]=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.getSize)(_);if(o<d+n+t[1]&&n>0){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.addClass)(e,"mv_reply_form_fixed");const{marginRight:_,marginLeft:s}=getComputedStyle(e),n=isNaN(parseInt(s,10))?0:parseInt(s,10),r=isNaN(parseInt(_,10))?0:parseInt(_,10);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(e,{width:a-n-r+"px",bottom:Math.min(o-d-t[1],0)+"px"}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(i,{height:t[1]+"px"})}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeClass)(e,"mv_reply_form_fixed"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(e,{width:null,bottom:null}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(i,{height:null})},editInline(e){if(e&&"A"==e.target.tagName||!window.mvcur||mvcur.mvEditing||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_description"))return;const _=mvcur.videoRaw,i=mvcur.mvShown,o=mvcur.mvData,t=function(e){if(!mvcur.mvShown||mvcur.videoRaw!=_||mvcur.mvShown!=i||mvcur.mvEditing)return;Videoview.cleanExpandDescrEls(),mvcur.mvEditing=_;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ce)("div",{id:"mv_edit_text_wrap",innerHTML:`\n          <textarea id="mv_edit_text" onkeydown="onCtrlEnter(event, Videoview.saveInline)" onkeyup="checkTextLength(mvcur.maxDescriptionLength, this, ge('mv_caption_warn'));" placeholder="${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_edit_desc_intro")}">${e}</textarea>\n          <div id="mv_caption_warn"></div>\n        `});(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_description").appendChild(o);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_edit_text");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.setStyle)(t,{width:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_description").offsetWidth+"px"}),(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_5__.placeholderInit)(t),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_6__.autosizeSetup)(t,{minHeight:26,addHeight:2}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(t,"keyup change",Videoview.onResize),setTimeout((function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.elfocus)(t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(t,"blur",Videoview.saveInline),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.hide)("mv_descr_field")}),1)};!o.desc?t(""):window.ajax.post("al_video.php?act=edit_desc",{oid:o.oid,vid:o.vid},{onDone:t,progress:"mv_inline_edit_pr"})},cancelInline(){mvcur.mvEditing=!1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)("mv_edit_text","blur"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)("mv_descr_field"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)("mv_edit_text_wrap")},saveInline(){if(!mvcur.mvEditing)return;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)("mv_edit_text","blur");const e=mvcur.mvEditing,_=Videoview.getMvData(),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_edit_text");window.ajax.post("al_video.php?act=save_desc",{oid:_.oid,vid:_.vid,hash:_.editHash,desc:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(i)},{onDone:function(o,t){if(_.desc=o,!Videoview.isLayerShown(e))return;mvcur.mvEditing=!1;const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.ge)("mv_descr_field");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.val)(s,o||`<span class="mv_desc_edit">${(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_edit_desc")}</span>`),s.onmouseover=o?Videoview.descTT.pbind(s):null,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.show)(s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.removeData)(i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_0__.re)("mv_edit_text_wrap"),Videoview.setTimeCodes(t),Videoview.onResize()},progress:"mv_inline_edit_pr"})},toggleRecommsColumn:e=>{const _=Videoview.getMvData(),i=document.getElementById("mv_box");if(!_||_.shortVideo||!_.autoplay_other_videos||Videoview.isVideoListEmpty())return void i.classList.remove("_has_recomms");if(e){const e=document.querySelector(".VideoLayerInfo__recommendedTitleAction");e&&((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_new_video_page")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_refactored_autoplay_btn")?e.style.setProperty("display","none"):e.classList.toggle("_active",_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.isAutoplayEnabled()))}const o=!!_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.getBlock(),t=Videoview.isMinimized();i.classList.toggle("_has_recomms",!o&&!mvcur.chatMode&&!t)},openTimeCodesList:e=>{Videoview.isMinimized()&&(Videoview.unminimize(),e=!0),_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.isCollapsed()||_video_playlist__WEBPACK_IMPORTED_MODULE_22__.VideoPlaylist.toggle(!1);const _=document.getElementById("mv_box");_?.classList.contains("_has_recomms")&&_.classList.add("_hide_recomms"),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")?_.classList.contains("_has_time_codes")?Videoview.closeTimeCodesList():Videoview.showTimeCodesList():(_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList.draw(e),Videoview.onResize()),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("video_time_codes_open","")},showTimeCodesList:()=>{const e=Videoview.getTimeCodes(),_=document.getElementById("mv_main"),i=document.createElement("div");i.setAttribute("id","video-modal-episode"),i.classList.add("videoModalTimeCodes"),_.insertBefore(i,_.firstChild);document.getElementById("mv_box").classList.add("_has_time_codes"),getVideoModalBlocks().then((({initVideoModalEpisodes:_,videoModalEpisodeService:o})=>{o.updateScrollHeight(Videoview.getPlayerHeight()),_(i,{timeCodes:e}),Videoview.onResize()}))},closeVideoModalPlaylistSidebar:()=>{getVideoModalBlocks().then((({unmountVideoModalPlayerSidebar:e})=>{const _=document.getElementById("mv_box"),i=document.querySelector(".js-video-modal-player-context");_.classList.remove("_hide_recomms"),_.classList.add("_hide_playlist"),e(i),i.remove(),Videoview.onResize()}))},closeTimeCodesList:()=>{getVideoModalBlocks().then((({unmountVideoModalEpisodes:e})=>{const _=document.getElementById("video-modal-episode"),i=document.getElementById("mv_box");e(_),i?.classList.remove("_has_time_codes"),_?.remove(),Videoview.onResize()}))},getPlayerHeight:()=>{const e=Videoview.getPlayerObject(),_=e?.el.getBoundingClientRect();return _?.height},updateCurrentTimeCode:e=>{(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_21__.partConfigEnabled)("video_modal_refactoring_of_player_context")?getVideoModalBlocks().then((({videoModalEpisodeService:_})=>{_.changeActiveEpisode(e)})):_web_videoview_TimeCodesList__WEBPACK_IMPORTED_MODULE_32__.TimeCodesList.updateCurrentTimeCode(e)},initAsyncComment:()=>{const e=Videoview.getMvData();if(!e.asyncCommentsEnabled)return void(window.mvcur?.options?.replyId&&window.Videoview.showComment(window.mvcur.options.replyId));const _=document.querySelector(".VideoLayerInfo__commentsRoot--empty");_&&window.ajax.post("al_video.php?act=async_video_comments",{video:e.videoRaw,view_hash:e.itemAccessHash},{onDone:(i,o,t,s)=>{if(i){_.innerHTML=i,(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_11__.extend)(mvcur.mvReplyNames,o);const d=document.getElementById("reply_field"+mvcur.post);d&&(0,_web_lib_input_utils__WEBPACK_IMPORTED_MODULE_5__.placeholderInit)(d,{editable:1}),e.commcount=t,e.commshown=s,window.mvcur?.options?.replyId&&window.Videoview.showComment(window.mvcur.options.replyId),setTimeout((()=>{Videoview.onResize()}),50)}},showProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.showProgress)(_,"","VideoLayerInfo__commentsLoader")},hideProgress:()=>{(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_13__.hideProgress)(_)},onFail:()=>!0})},copyToClipboard(e){(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_12__.copyTextToClipboard)(e).then((()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_10__.showDoneBox)((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_3__.getLang)("video_erid_copied"))}))},updateVideoCardInProfileTabs(e,_=!0){const i=document.querySelector(`.VideoSectionCard[data-id='${e}']`);if(i){const e=i.closest(".ui_gallery_item");e&&(e.classList.toggle("ui_gallery_item_deleted",_),window.cur.videoTabBlock?.refresh())}}}},44755:(e,_,i)=>{i.d(_,{HASHTAG_ENTITIES_ALL:()=>n,HASHTAG_ENTITIES_NEW:()=>r,RE_HASHTAG_EXTRACTION_PATTERN:()=>a,RE_HASHTAG_EXTRACTION_PATTERN_NEW:()=>c});var o=i(175819);const t="a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’",s="(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)",d=`(?:[${t}_\\d]|${s})`,a=`(^|[s.,:'";>)(]?)(${`(#${d}{0,100}${`(?:[${t}]|${s})`}${d}{0,100})`})(@${o.RE_DOMAIN_PATTERN})?(?=$|[s.,:'"&;?<)(]?)`,n="&#(\\d{3,5});",r="(?:&#\\d{3,5};)",l=`(?:[${t}_\\d]|${r})`,c=`(^|[s.,:'";>)(]?)(${`(#${l}{0,100}${`(?:[${t}]|${r})`}${l}{0,100})`})(@${o.RE_DOMAIN_PATTERN})?(?=$|[s.,:'"&;?<)(]?)`},3171:(e,_,i)=>{i.d(_,{ANALYTICS_SCREEN_OTHER:()=>s,ANALYTICS_SCREEN_SETTINGS:()=>t,GroupAdminLevel:()=>o});const o={USER:0,MODERATOR:1,EDITOR:2,ADMINISTRATOR:3,HOST:4,EVENT_CREATOR:5,CREATOR:6,PSEUDO_LEVEL_ADVERTISER:100},t="settings",s="other"},33732:(e,_,i)=>{i.d(_,{POPUP_STICKER_CLASS:()=>s,POPUP_STICKER_ICON_CLASS:()=>d,POPUP_STICKER_ICON_CLASS_ANIMATED:()=>a,POPUP_STICKER_ICON_CLASS_ROTATED:()=>n,POPUP_STICKER_WRAPPER_CLASS:()=>o,POPUP_STICKER_WRAPPER_CLASS_ANIMATION_IS_PLAYING:()=>t,STICKER_CLASS:()=>r,StickersSettingsApiMethods:()=>l});const o="popupStickerWrapper",t="popupStickerWrapperAnimationIsPlaying",s="popupSticker",d="popupStickerIcon",a="popupStickerIconAnimated",n="popupStickerIconRotated",r="stickerImageWrapper",l={getSettings:"stickers.getSettings",setPopupSettings:"stickers.setPopupSettings"}},126075:(e,_,i)=>{i.d(_,{POPUP_STICKER_MARKET_CONTAINER_ID:()=>o,POPUP_STICKER_PHOTO_CONTAINER_ID:()=>s,POPUP_STICKER_PRODUCT_CONTAINER_ID:()=>t,POPUP_STICKER_VIDEO_CONTAINER_ID:()=>d});const o="popup-sticker-market-react-container",t="popup-sticker-product-container",s="popup-sticker-photoview-container",d="popup-sticker-videoview-container"},924712:(e,_,i)=>{i.d(_,{popUpGetStringDataAttrs:()=>s});var o=i(693217),t=i(224194);const s=e=>(0,t.isPopUpStickersEnabled)()?(0,o.getStringDataAttrs)(e):""},485910:(e,_,i)=>{i.d(_,{replaceHashtags:()=>n});var o=i(44755),t=i(540462);let s;const d=[[192,1399],[12352,12543],[19968,40959],[44032,55215]];function a(e){const _=e.match(o.HASHTAG_ENTITIES_ALL)?.[1];if(!_)return!1;const i=parseInt(_);for(const e of d)if(i>=e[0]&&i<=e[1])return!0;return!1}function n(e,_){return e.replace((s||(s=(0,t.partConfigEnabled)("new_hashtags_parser")?new RegExp(o.RE_HASHTAG_EXTRACTION_PATTERN_NEW,"ig"):new RegExp(o.RE_HASHTAG_EXTRACTION_PATTERN,"ig")),s),((e,i,s,d,n)=>{let r="";if((0,t.partConfigEnabled)("new_hashtags_parser")){const e=s.matchAll(new RegExp(o.HASHTAG_ENTITIES_NEW,"ig"));for(const _ of e){const[e]=_;if(!a(e)){r=s.slice(_.index),s=s.slice(0,_.index);break}}}return"#"===s?(i||"")+s+(n||"")+r:(i||"")+_(s+(n||""),s)+r}))}},68586:(e,_,i)=>{i.d(_,{updatePost:()=>s});var o=i(581197),t=i(538522);function s(e,_){return new Promise(((i,s)=>{window.ajax.post("al_wall.php",{act:"s_one",post_id:e,owner_id:_,render_context:"feed",only_post:!0},{onDone:d=>{if(!d)return s();const a=document.getElementById(`post${(0,t.joinRawId)({ownerId:_,itemId:e})}`),n=document.querySelector(`#wl_post[data-post-id="${(0,t.joinRawId)({ownerId:_,itemId:e})}"]`),r=window.wkcur?.pageReplaced?.[0][0];if(!a&&!n)return s();const l=(0,o.createElementFromHTML)(d);if(l){const e=".PostHeaderInfo",_=".wall_post_cont",i=l.querySelector(e),o=l.querySelector(_);[a,n,r].filter(Boolean).forEach((t=>{i&&t?.querySelector(e)?.replaceWith(i.cloneNode(!0)),o&&t?.querySelector(_)?.replaceWith(o.cloneNode(!0))}))}i(e)}})}))}},626586:(e,_,i)=>{i.d(_,{CATALOG_API_METHODS:()=>o,SEARCH_INPUT_BLUR_TIMEOUT:()=>d,SEARCH_INPUT_ID:()=>t,SEARCH_TOP_MODAL_NON_CLOSING_ATTR:()=>s});const o={GET_SEARCH_TOP:"catalog.getSearchTop",GET_SECTION:"catalog.getSection",GET_STORIES:"stories.get",JOIN_GROUP:"groups.join",LEAVE_GROUP:"groups.leave",ADD_FRIEND:"friends.add",DELETE_FRIEND:"friends.delete",ADD_RECENT:"search.addRecents",CLEAR_RECENT:"search.clearRecents"},t="SearchTopInput",s="data-search-top-target",d=150},996849:(e,_,i)=>{i.d(_,{checkStopActionOnEventOnSticker:()=>m,checkStopActionOnEventOnStickerPopupIcon:()=>c,previewSticker:()=>a,showPackByClickOnSticker:()=>n,wrapSticker:()=>l});var o,t=i(614098),s=i(565703),d=i(33732);!function(e){e.MESSAGE="message"}(o||(o={}));const a=(e,_)=>window.Emoji.previewSticker(e,!1,{sticker_referrer:"message",randomPackAttemptId:_}),n=(e,_)=>{(0,s.isNewStickerPicker)()?window.StickerPickerViewer?.api.getPack({productId:e}).then((i=>{Boolean(i?.product?.active)?window.StickerPickerViewer?.showPack(e,_):a(e)})).catch((()=>{a(e)})):window.Emoji.getStickerPack(e).then((i=>{Boolean(i&&i[window.Emoji.PACK_FIELD_IS_ACTIVE])?window.Emoji.showPackInKeyboard(e,_):a(e)}))},r=e=>`stickerSize${e}`,l=({stickerHtml:e,stickerWrapperClass:_="",icon:i,iconClass:o,size:s,iconTqAttrs:d})=>{const a=i?`<div class="${t.STICKER_ICON_CLASS} ${o}" ${d}>${i}</div>`:"";return`\n  <div class="${[t.STICKER_ROW_CLASS,_,r(s)].join(" ")}">\n    ${e}\n    ${a}\n  </div>\n`},c=e=>{const _=e?.target;return!!_?.closest("."+d.POPUP_STICKER_ICON_CLASS)},m=e=>{const _=e?.target;return!!_?.closest("."+t.STICKER_ROW_CLASS)||(!!_?.closest("."+d.POPUP_STICKER_WRAPPER_CLASS)||!!c(e))}},781956:(e,_,i)=>{i.d(_,{showMutePopup:()=>c});var o=i(474848),t=i(98967),s=i(211413),d=i(694244),a=i(720836),n=i(454154),r=i(699304);const l=({faqLink:e,title:_,text:i,buttonText:l,onClose:c})=>(0,o.jsxs)(d.ModalBox,{children:[(0,o.jsx)(s.MessageBoxDismissButton,{onClick:c}),(0,o.jsx)(a.Placeholder,{icon:(0,o.jsx)(t.Icon56LockOutline,{className:r.default.icon}),header:_,action:(0,o.jsx)(n.Button,{mode:"primary",size:"m",onClick:()=>{window.open(e,"_blank")},children:l}),children:(0,o.jsx)("span",{className:r.default.text,children:i})})]});function c(e){(0,s.showMessageBoxModal)((_=>(0,o.jsx)(l,{..._,...e})))}},417465:(e,_,i)=>{function o(e){return e.interactive_info.src}function t(e){return!!e.interactive_info}function s(e,_,i,o){return new Promise(((t,s)=>{const d=()=>{s(new DOMException("Operation aborted","AbortError"))};o&&(o.aborted&&d(),o.addEventListener("abort",d,{once:!0})),window.ajax.post(e,_,{...i,onDone:(...e)=>{o&&o.removeEventListener("abort",d);const _=[...e];t(_)},onFail:e=>(s(e),!0)})}))}function d(e){const _=window.structuredClone(e),i=window.structuredClone(function(e){return e.interactive_info.current_video}(e)),o=_.url_interactive_manifest;return delete _.interactive_info.current_video,delete _.url_interactive_manifest,_.interactive_info={enable_interactive_graph:_.interactive_info.enable_interactive_graph,enable_interactive_time_indicator_hint:_.interactive_info.enable_interactive_time_indicator_hint,src:o},i.interactive_info={src:o,project:_},i}function a(){return Promise.all([i.e(28458),i.e(90513),i.e("langs/web/videoplayer_interactives")]).then(i.bind(i,960608))}i.d(_,{getManifestSrc:()=>o,interactivePlayerLazyLoad:()=>a,isInteractiveVideo:()=>t,prepareInteractivePlayerVars:()=>d,promisifyAct:()=>s})},299692:(e,_,i)=>{i.d(_,{getLoadingStatusHtml:()=>t});var o=i(818732);const t=(e="")=>`\n    <div class="${e} videoplayer_loading_spinner">\n      ${(0,o.getIcon36Spinner)().icon}\n    </div>`},759264:(e,_,i)=>{i.d(_,{GoodsRecognition:()=>P});var o=i(474848),t=i(296540),s=i(865708),d=i(753457),a=i(285056),n=i(700272),r=i(744440),l=i(8520),c=i(126876),m=i(293721),v=i(416767),E=i(866467),u=i(703468),w=i(683968),p=i(636576),b=i(59902),h=i(48921),D=i(251703);const P=()=>{const e=(0,m.useStore)(v.$isProcessing),_=(0,m.useStore)(v.$isVisible),i=(0,m.useStore)(v.$queueIsActive),P=(0,m.useStore)(v.$goods),O=(0,m.useStore)(v.$startProcessingData);let M=null;const g=(0,t.useRef)(null),I=e=>{e.data.length?(0,p.statlogsValueEvent)("video_goods_recognition","","success"):(0,p.statlogsValueEvent)("video_goods_recognition","","empty"),(0,v.setGoods)(e.data),(0,v.setIsProcessing)(!1)};(0,t.useEffect)((()=>(i&&(M=new b.GoodsQueue(I),M.start()),()=>{M?.stop()})),[i]);const C=()=>{(0,v.setVisible)(!1)},L=()=>{(0,p.statlogsValueEvent)("video_goods_recognition","","click_on_good"),(0,D.tmrTrackCustomGoal)("click_on_item")};return(0,t.useEffect)((()=>{const e=document.querySelector("#mv_box");return e&&e.classList.toggle("_has_goods",_),window.Videoview?.onResize(),()=>{e&&e.classList.remove("_has_goods")}}),[_]),(0,t.useEffect)((()=>{const _=_=>{const{eventType:i}=_.detail;switch(i){case w.CustomEventType.START:e||(o=_.detail.data,(0,v.setStartProcessingData)(o),(0,v.startProcessing)(o),(0,v.setVisible)(!0));break;case w.CustomEventType.HIDE_UI:C()}var o};return window.addEventListener(h.CustomEventName,_),()=>{window.removeEventListener(h.CustomEventName,_)}}),[e]),(0,t.useEffect)((()=>()=>{(0,v.destroyBlock)()}),[]),_?(0,o.jsx)(s.AppRootProvider,{sizeY:d.SizeType.REGULAR,children:(0,o.jsxs)("div",{className:c.default.wrapper,id:"GoodsRecognition",children:[(0,o.jsxs)("div",{className:c.default.header,children:[(0,o.jsx)(a.Headline,{level:"1",weight:"3",className:c.default.headerTitle,children:(0,E.getLang)("video_goods_in_frame")}),(0,o.jsx)("div",{className:c.default.headerAction,onClick:C,children:(0,o.jsx)(d.Caption,{level:"1",weight:"2",children:(0,E.getLang)("global_close")})})]}),e&&(0,o.jsxs)("div",{className:(0,l.classNames)(c.default.container,c.default.stub),children:[(0,o.jsx)(n.Spinner,{size:"regular",className:c.default.spinner}),(0,o.jsx)("div",{children:(0,E.getLang)("video_goods_recognition_in_progress")})]}),!e&&!P.length&&(0,o.jsxs)("div",{className:(0,l.classNames)(c.default.container,c.default.stub),children:[(0,o.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,E.getLang)("video_goods_recognition_empty_result")}}),(0,o.jsx)("div",{className:c.default.retryBtn,onClick:()=>{if(O){const e=window.mvcur?.player?.curTime?.()||0,_=Math.floor(1e3*e);(0,v.startProcessing)({...O,frame_time:_||O.frame_time}),(0,p.statlogsValueEvent)("video_goods_recognition","","retry")}},children:(0,E.getLang)("video_goods_recognition_try_again")})]}),!e&&P.length>0&&(0,o.jsx)("div",{className:c.default.container,ref:g,children:(0,o.jsx)(r.CustomScrollView,{boxRef:g,autoHideScrollbar:!0,children:P.map(((e,_)=>(0,o.jsxs)("div",{className:c.default.goodWrapper,children:[(0,o.jsx)(a.Headline,{level:"2",weight:"3",className:c.default.goodTitle,children:(0,E.langReplace)((0,E.getLang)("video_goods_recognition_order"),{order:String(_+1)})}),(0,o.jsx)(d.HorizontalScroll,{arrowSize:"l",showArrows:"always",getScrollToLeft:u.handleScrollToLeft,getScrollToRight:u.handleScrollToRight,children:(0,o.jsxs)("div",{className:c.default.goodItems,children:[(0,o.jsx)("div",{className:c.default.goodItemsGap}),e.items.map(((e,_)=>(0,o.jsxs)("a",{onClick:L,className:c.default.goodLink,href:e.store_url,target:"_blank",children:[(0,o.jsx)("div",{className:c.default.goodPhoto,children:e.image_url&&(0,o.jsx)("img",{className:c.default.goodPhotoImg,src:e.image_url,alt:""})}),(0,o.jsx)("div",{className:c.default.goodLinkTitle,children:e.good_name}),(0,o.jsx)("div",{className:c.default.goodLinkDomain,children:e.store_name})]},_))),(0,o.jsx)("div",{className:c.default.goodItemsGap})]})})]},_)))})})]})}):null}},48921:(e,_,i)=>{i.d(_,{CARD_GAP:()=>t,CARD_WIDTH:()=>o,CustomEventName:()=>s});const o=128,t=12,s="VideoCustomEvent/GoodRecognition"},317093:(e,_,i)=>{i.d(_,{GoodsRecognition:()=>o.GoodsRecognition});var o=i(759264)},774753:(e,_,i)=>{i.d(_,{destroyGoodsBlock:()=>c,hideGoodsBlock:()=>l,renderGoodsRecognitionPanel:()=>r});var o=i(474848),t=i(440961),s=i(317093),d=i(683968),a=i(48921);const n="mv_goods_recognition",r=()=>{const e=document.getElementById(n);e&&t.render((0,o.jsx)(s.GoodsRecognition,{}),e)},l=()=>{window.dispatchEvent(new CustomEvent(a.CustomEventName,{detail:{eventType:d.CustomEventType.HIDE_UI}}))},c=()=>{const e=document.getElementById(n);e&&t.unmountComponentAtNode(e)}},59902:(e,_,i)=>{i.d(_,{GoodsQueue:()=>d});var o=i(957994),t=i(342018),s=i(105330);class d{getUrl(e){return`${this.base}?act=${e}&key=${this.key}&id=${this.userId}&ts=${this.ts}&wait=${this.WAIT_TIMEOUT}`}_subscribe(){this.unsubscribe=()=>{this._unsubscribe(),this.unsubscribe=s.noop};const e=this.getUrl("a_check");return fetch(e).then((e=>e.json())).catch((()=>{this.statusActive=!1}))}_unsubscribe(){const e=this.getUrl("a_release");fetch(e).then((e=>e.json()))}start(){this.statusActive||((0,o.api)("queue.subscribe",{queue_ids:this.QUEUE_NAME}).then((({base_url:e,queues:_})=>{const i=_&&_[0];if(!i)throw new Error("No queue to subscribe");return this.base=e,this.key=i.key,this.ts=i.timestamp,this.subscribe(),!0})).catch((()=>{this.statusActive=!1})),this.statusActive=!0)}stop(){this.destroy()}destroy(){this.statusActive=!1,this.unsubscribe()}subscribe(){this._subscribe().then((e=>{this.statusActive&&e?.ts&&(this.ts=e.ts,this.subscribe(),this.processEvents(e.events))}))}processEvents(e){this.statusActive&&e&&e.forEach((e=>{this.processEvent(e)}))}constructor(e){this.userId=window.vk.id,this.WAIT_TIMEOUT=45,this.QUEUE_NAME=`videogoodsrecognition_${this.userId}`,this.unsubscribe=s.noop,this.processEvent=s.noop,this.processEvent=e;const _=()=>{window.removeEventListener("beforeunload",_),this.destroy()};window.addEventListener("beforeunload",_),(0,t.pushNavDestroy)((()=>{window.removeEventListener("beforeunload",_),_()}))}}},416767:(e,_,i)=>{i.d(_,{$goods:()=>E,$isProcessing:()=>l,$isVisible:()=>m,$queueIsActive:()=>u,$startProcessingData:()=>n,destroyBlock:()=>w,setGoods:()=>v,setIsProcessing:()=>r,setStartProcessingData:()=>a,setVisible:()=>c,startProcessing:()=>d});var o=i(32489),t=i(957994);const s=(0,o.createDomain)("GoodsRecognition"),d=s.createEvent("startProcessing"),a=s.createEvent("setFrameData"),n=(0,o.restore)(a,null),r=s.createEvent("setIsProcessing"),l=(0,o.restore)(r,!1),c=s.createEvent("setVisible"),m=(0,o.restore)(c,!1),v=s.createEvent("setGoods"),E=(0,o.restore)(v,[]),u=s.createStore(!0,{name:"queueIsActive"}),w=s.createEvent("destroyBlock");s.onCreateStore((e=>{e.reset([w])}));const p=s.createEffect((e=>(0,t.api)("video.findGoodsInFrameAsync",e)));(0,o.sample)({clock:d,target:p}),(0,o.sample)({clock:d,fn:()=>!0,target:l}),(0,o.sample)({clock:p.doneData,fn:e=>!!e,target:u})},683968:(e,_,i)=>{var o;i.d(_,{CustomEventType:()=>o}),function(e){e.START="START",e.HIDE_UI="HIDE_UI"}(o||(o={}))},703468:(e,_,i)=>{i.d(_,{handleScrollToLeft:()=>t,handleScrollToRight:()=>s});var o=i(48921);const t=e=>e-2*(o.CARD_WIDTH+o.CARD_GAP),s=e=>e+2*(o.CARD_WIDTH+o.CARD_GAP)},421954:(e,_,i)=>{i.d(_,{sharedLiveStatsInfoService:()=>n});var o=i(558137),t=i(32489),s=i(957994);const d=(0,t.createDomain)("LiveInfo"),a=(0,o.makeSharedState)("live-stats-info",(()=>(({domain:e})=>{const _=e.createStore(null,{name:"liveStatsInfo"}),i=e.createEvent("resetStore");e.onCreateStore((e=>{e.reset([i])}));const o=e.createEvent("setIsDisabled"),d=(0,t.restore)(o,!1),a=e.createEvent("getLiveStats"),n=e.createEffect((e=>(0,s.api)("video.getLiveStats",e)));return(0,t.sample)({clock:a,target:n}),(0,t.sample)({clock:n.doneData,target:_}),{$liveStatsInfo:_,getLiveStats:a,resetStore:i,setIsDisabled:o,$isDisabled:d}})({domain:d})),{version:0}),n=a()},848603:(e,_,i)=>{i.d(_,{APIClientDeprecatedImpl:()=>d});var o=i(331635),t=i(132028),s=i(957994);class d{request(e,_,i={}){return(0,s.api)(e,_,{...void 0!==i.version?{version:i.version}:{},...void 0!==i.grouping?{grouping:i.grouping}:{},...void 0!==i.accessToken?{accessToken:i.accessToken}:{}},{signal:i?.signal})}fetchWebToken(e,_){return(0,s.login)("web_token",e,_)}}d=(0,o.__decorate)([t.scope.global()],d)},157951:(e,_,i)=>{var o;i.d(_,{LottiePlayerDirection:()=>o}),function(e){e[e.FORWARD=1]="FORWARD",e[e.BACKWARD=-1]="BACKWARD"}(o||(o={}))},761894:(e,_,i)=>{i.d(_,{CONTAINER_ID_DATASET_PROPERTY:()=>n,CONTAINER_ID_DATA_DEFAULT_VALUE:()=>s,CONTAINER_ID_DATA_PROPERTY:()=>a,ConflictActionsTypes:()=>y,CustomPopUpLayerTypes:()=>D,DEDUCTIBLE_DATA_PROPERTY:()=>c,DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY:()=>m,DEFAULT_LOOP_LIMIT:()=>O,DEFAULT_PLAYER_OPTIONS:()=>p,DEFAULT_POPUP_CONTAINER_DATA_PROPERTY:()=>v,DEFAULT_POSITION_X:()=>g,DEFAULT_POSITION_Y:()=>I,DEFAULT_SCALE_RATIO:()=>M,FULL_SCREEN_CONTAINER_DATA_PROPERTY:()=>l,FULL_SCREEN_DATA_DEFAULT_VALUE:()=>d,MIN_SIZE_FOR_PLAY:()=>L,MIN_SIZE_FOR_SCALE:()=>C,POPUP_LOTTIE_GROUP:()=>T,POPUP_POSITION_DEFAULT_VALUE:()=>u,POPUP_POSITION_PROPERTY:()=>E,POPUP_STICKER_IM_CONTAINER:()=>r,PopUpLayerTypes:()=>h,PopUpPositionTypes:()=>P,SCREEN_MODIFICATOR:()=>w,SPEED_ON_DESTROY:()=>b});var o=i(157951),t=i(351089);const s="common_container",d="body",a="data-popup-sticker-container-id",n=(0,t.dataAttrKeyToDatasetKey)(a),r="popup-sticker-im-container",l="data-popup-sticker-full-screen-container",c="data-popup-sticker-deductible",m="data-popup-sticker-deductible-full-screen",v="data-popup-sticker-use-common",E="data-popup-sticker-position",u="fixed",w="screen",p={speed:1,loop:!0,autoplay:!1,cache:!1,lazyLoading:!0,direction:o.LottiePlayerDirection.FORWARD,strictCache:!0},b=3,h={Gradient:"gradient",FullScreen:"animation_fullscreen",Fixed:"animation_fixed"},D={Background:"background"},P={FullScreen:"fullscreen",Fixed:"fixed",TopFullScreen:"topFullScreen"},O=1,M=1,g="center",I="middle",C=384,L=64,T="Popup",y={ChangeModificator:"changeModificator",DontShow:"dontShow"}},693217:(e,_,i)=>{i.d(_,{findFixedElement:()=>a,getDataAttrs:()=>t,getDeductibleDataAttrs:()=>d,getPopupElementsFromFixedElement:()=>r,getStringDataAttrs:()=>s});var o=i(761894);const t=e=>{const{popupStickerUseCommon:_="false",popupStickerContainerId:i,popupStickerFullScreenContainer:t,popupStickerPosition:s=o.POPUP_POSITION_DEFAULT_VALUE}=e,d={[o.DEFAULT_POPUP_CONTAINER_DATA_PROPERTY]:_,[o.POPUP_POSITION_PROPERTY]:s,[o.CONTAINER_ID_DATA_PROPERTY]:i};return t&&(d[o.FULL_SCREEN_CONTAINER_DATA_PROPERTY]=t),d},s=e=>{let _="";const i=t(e);return Object.entries(i).forEach((([e,i])=>{_+=`${e}='${i}' `})),_.trim()},d=e=>{const{popupStickerDeductible:_,popupStickerDeductibleFullScreen:i}=e,t={};return _&&(t[o.DEDUCTIBLE_DATA_PROPERTY]=_),i&&(t[o.DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY]=i),t},a=e=>e.closest(`[${o.CONTAINER_ID_DATA_PROPERTY}]`)||document.body;function n(e,_,i,t,s,d=null){let a=[...document.querySelectorAll(`[${_}=${t}]`)];switch(s&&(a=[...a,...document.querySelectorAll(`[${_}=${o.CONTAINER_ID_DATA_DEFAULT_VALUE}]`)]),a.push(i),e){case"lower":case"parent":a=a.sort(((e,_)=>e.getBoundingClientRect().top-_.getBoundingClientRect().top));break;case"upper":a=a.sort(((e,_)=>e.getBoundingClientRect().bottom-_.getBoundingClientRect().bottom))}const n=a.findIndex((e=>e===i));let r;switch(e){case"upper":case"parent":r=a[n-1]||null;break;case"lower":r=a[n+1]||null;break;default:r=a[0]||null}return r||d}const r=(e,_)=>{const{popupStickerContainerId:i,popupStickerPosition:t,popupStickerUseCommon:s}=(e=>{const{popupStickerUseCommon:_="false",popupStickerPosition:i=o.POPUP_POSITION_DEFAULT_VALUE,popupStickerContainerId:t=o.CONTAINER_ID_DATA_DEFAULT_VALUE}=e.dataset;return{popupStickerContainerId:t,popupStickerUseCommon:_,popupStickerPosition:i}})(e);let d="true"===s;return{fixedElement:e,headerElement:n("upper",o.DEDUCTIBLE_DATA_PROPERTY,_,i,d),footerElement:n("lower",o.DEDUCTIBLE_DATA_PROPERTY,_,i,d),fullScreenElement:n("parent",o.FULL_SCREEN_CONTAINER_DATA_PROPERTY,_,i,d,document.body),fullScreenHeaderElement:n("upper",o.DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY,_,i,d),fullScreenFooterElement:n("lower",o.DEDUCTIBLE_FULL_SCREEN_DATA_PROPERTY,_,i,d),position:t}}},351089:(e,_,i)=>{i.d(_,{dataAttrKeyToDatasetKey:()=>o});const o=e=>e.slice(5).split("-").map(((e,_)=>0!==_?e.charAt(0).toUpperCase()+e.slice(1):e)).join("")},699304:(e,_,i)=>{i.d(_,{default:()=>o});const o={icon:"MutePopup__icon--hk0FJ",text:"MutePopup__text--8KHO3"}},126876:(e,_,i)=>{i.d(_,{default:()=>o});const o={wrapper:"GoodsRecognition__wrapper--AjuKj",header:"GoodsRecognition__header--Dg6Ib",headerTitle:"GoodsRecognition__headerTitle--rlaab",headerAction:"GoodsRecognition__headerAction--fRj1w",container:"GoodsRecognition__container--BaBFH",stub:"GoodsRecognition__stub--hCiRf",spinner:"GoodsRecognition__spinner--n0EJY",retryBtn:"GoodsRecognition__retryBtn--mO0D7",goodWrapper:"GoodsRecognition__goodWrapper--eCv9E",goodTitle:"GoodsRecognition__goodTitle--gJsen",goodItems:"GoodsRecognition__goodItems--DCkea",goodItemsGap:"GoodsRecognition__goodItemsGap--TucCW",goodLink:"GoodsRecognition__goodLink--cHvTY",goodPhoto:"GoodsRecognition__goodPhoto--i2ghb",goodPhotoImg:"GoodsRecognition__goodPhotoImg--ynWYH",goodLinkTitle:"GoodsRecognition__goodLinkTitle--S7vIA",goodLinkDomain:"GoodsRecognition__goodLinkDomain--gZZPT"}}}]);try{stManager?.done("dist/web/chunks/c3d0c803.bddeaaf5.js")}catch(e){}