"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[31299],{902235:(e,t,i)=>{i.d(t,{useLazyLoad:()=>r});var o=i(296540),s=i(150585);const r=(e,t,i=window,r)=>{(0,o.useEffect)((()=>{let o;if(i)return e?(o=(0,s.throttle)((()=>{const e=i instanceof Window?Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight):Math.max(i.scrollHeight,i.clientHeight),o=i instanceof Window?document.documentElement.clientHeight:i.clientHeight,s=i instanceof Window?i.scrollY:i.scrollTop,a=o+s,n=Math.max(e-2*o,0);(!r&&a>=n||r&&s<o/2)&&t?.()}),34),o(),i.addEventListener("scroll",o)):o&&i.removeEventListener("scroll",o),()=>{o&&i.removeEventListener("scroll",o)}}),[e,t,i,r])}},89219:(e,t,i)=>{i(474848),i(296540),i(822062),i(783856),i(988418),i(723723),i(194528),i(285056),i(373080),i(454154),i(26027),i(98967),i(866467),i(57)},57:(e,t,i)=>{i.d(t,{VideoPlayerWidget:()=>u});var o=i(474848),s=i(296540),r=i(689900),a=i(132028),n=i(456921),d=i(946780),l=i(676599);const c=(0,n.observer)((function(){const e=(0,l.useVideoPlayerModel)(),{loop:t=!0,muted:i,volume:a,playing:n,mode:c,platform:u,video:h,onLooped:p,onPlayingChanged:_,onPositionChanged:v,onStalledChanged:g,onStarted:m,onVideoCurQualityChanged:y,onVideoEndedChanged:b,onVideoVolumeChanged:C,newCurrentTime:f,onDurationChanged:I,onCurrentTimeChanged:S,onVideoFormatChanged:P,onVideoBitrateChanged:w,onEnded:A,onFirstBytes:L,onFirstFrame:E}=e.props.current,[M,F]=(0,s.useState)(null),[k,x]=(0,s.useState)(!0),{play:V,pause:O,setMuted:T,setLooped:j,setVolume:R,setCurrentTime:D}=(0,d.useVkPlayer)(h,M,u,{onLooped:p,onPlayingChanged:_,onPositionChanged:v,onStalledChanged:g,onStarted:m,onVideoCurQualityChanged:y,onVideoEndedChanged:b,onVideoVolumeChanged:C,onDurationChanged:I,onCurrentTimeChanged:S,onEnded:A,onFirstBytes:L,onFirstFrame:e=>{x(!1),E?.(e)},onVideoFormatChanged:P,onVideoBitrateChanged:w},e.playerConfigData);return(0,s.useEffect)((()=>{n?V():O()}),[n,V,O]),(0,s.useEffect)((()=>{R(a??0)}),[a,R]),(0,s.useEffect)((()=>{T(i)}),[i,T]),(0,s.useEffect)((()=>{j(t)}),[t,j]),(0,s.useEffect)((()=>{"number"==typeof f&&D(f)}),[f,D]),(0,o.jsx)(r.ClipPlayerContainer,{mode:c,setContainer:F,hidden:k})})),u=(0,a.createWidget)(l.VideoPlayerModelProvider,c)},411512:(e,t,i)=>{i.d(t,{VideoPlayerWrapper:()=>r});var o=i(474848),s=i(57);const r=e=>(0,o.jsx)(s.VideoPlayerWidget,{...e})},609601:(e,t,i)=>{i.d(t,{VideoPlayerWrapper:()=>o.VideoPlayerWrapper});i(89219);var o=i(411512)},172064:(e,t,i)=>{i.d(t,{VideoPlayerModelProvider:()=>c,useVideoPlayerModel:()=>l});var o=i(331635),s=i(852487),r=i(979549),a=i(327813),n=i(132028);class d{async[n.init](){this.getConfig()}async getConfig(){const e=this.props.current.module??"clips",t=await this.videoPlayerConfigProvider.ensure({module:e});this.playerConfigData={config:t,loadingConfig:!1}}constructor(e,t,i){this.props=e,this.videoPlayerConfigProvider=t,this.videoViewSegmentsService=i,this.playerConfigData={config:null,loadingConfig:!0},this.sendViewSegments=e=>{const{id:t,ownerId:i,trackCode:o=""}=this.props.current.video;t&&i&&this.videoViewSegmentsService.send({video_id:t,owner_id:i,ranges:e,ref:"clips",muted:this.props.current.muted?1:0,track_code:o})},(0,a.makeAutoObservable)(this)}}d=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.Props?Object:n.Props,void 0===s.VideoPlayerConfigProvider?Object:s.VideoPlayerConfigProvider,void 0===r.VideoViewSegmentsService?Object:r.VideoViewSegmentsService])],d);const{useModel:l,Provider:c}=(0,n.createProvider)(d)},676599:(e,t,i)=>{i.d(t,{VideoPlayerModelProvider:()=>o.VideoPlayerModelProvider,useVideoPlayerModel:()=>o.useVideoPlayerModel});var o=i(172064)},530102:(e,t,i)=>{i.d(t,{useOneStat:()=>n});var o=i(296540),s=i(89923),r=i(191977),a=i(859738);function n(e,t,i){(0,o.useEffect)((()=>{if(!e)return;const o=!!window.vk.id,n=o?()=>(0,r.get)({refresh:!0}).catch((()=>{(0,a.trackOneStatError)("video.getStatsToken")})):void 0,d=new s.OneStat({movieId:Number(t),place:window.cur?.module??"",mobile:"mvk"===i,autoplay:!0},{apiEnv:s.ApiEnv.PROD,refreshAuthToken:n,config:{requestRetryCount:1}});return d.pause(),o?(0,r.get)().then((e=>{d.authorize(e),d.resume()}),(()=>{(0,a.trackOneStatError)("video.getStatsToken")})):(d.authorize(),d.resume()),d.attachTo(e),()=>{d.destroy()}}),[e,t])}},525745:(e,t,i)=>{i.d(t,{useVideoSegments:()=>a});var o=i(296540),s=i(773439),r=i(676599);function a(e){const t=(0,o.useRef)([]),{sendViewSegments:i}=(0,r.useVideoPlayerModel)(),a=(0,o.useCallback)((o=>{if(e){if(o)t.current=[];else if(!t.current.length)return;t.current.push(Math.trunc(e.info.position$.getValue())),2===t.current.length&&(i(t.current.join("-")),t.current=[])}}),[e,i]);(0,o.useEffect)((()=>{if(!i)return;const t=new s.Subscription;return e&&(t.add(e.events.playing$.subscribe((()=>a(!0)))),t.add(e.events.paused$.subscribe((()=>a(!1)))),t.add(e.events.willSeek$.subscribe((()=>a(!1)))),t.add(e.events.ended$.subscribe((()=>a(!1)))),t.add(e.events.looped$.subscribe((()=>a(!1))))),()=>{a(!1),t.unsubscribe()}}),[e,a,i])}},946780:(e,t,i)=>{i.d(t,{useVkPlayer:()=>u});var o=i(296540),s=i(773439),r=i(897976),a=i(540462),n=i(786398),d=i(530102),l=i(525745);const c=new n.ObjectPool((()=>{const e=document.createElement("video");return e.muted=!0,e.playsInline=!0,e.disablePictureInPicture=!0,e}));function u(e,t,i,{onPlayingChanged:n,onPositionChanged:u,onStalledChanged:h,onStarted:p,onLooped:_,onVideoEndedChanged:v,onVideoCurQualityChanged:g,onVideoVolumeChanged:m,onDurationChanged:y,onCurrentTimeChanged:b,onEnded:C,onFirstBytes:f,onFirstFrame:I,onVideoFormatChanged:S,onVideoBitrateChanged:P}={},w){const[A,L]=(0,o.useState)(null);(0,d.useOneStat)(A,e?.ovId,i),(0,l.useVideoSegments)(A),(0,o.useEffect)((()=>{let i=null,o=null;if(e&&t&&!w?.loadingConfig){i=new s.Player(w?.config?.core),o=c.allocate(),t.innerHTML="",t.appendChild(o);const n=(0,r.constructSources)(e);if((0,a.partConfigEnabled)("video_clips_mvk_hls_min_quality_from_backend")){const e=n[s.VideoFormat.HLS];e&&(e.url+="&lq=480")}i.setMuted(!0).setLooped(!0).setAutoQualityLimits({min:s.VideoQuality.Q_480P}).initVideo({container:t,sources:n,failoverHosts:e.files?.failover_host?[e.files.failover_host]:void 0,meta:{videoId:e.ovId}}).prepare()}return L(i),()=>{i?.destroy(),t&&(t.innerHTML=""),o&&c.free(o)}}),[e,t,w]),(0,o.useEffect)((()=>{const e=new s.Subscription;return A&&(h&&e.add(A.info.isStalled$.subscribe(h)),v&&e.add(A.info.isEnded$.subscribe(v)),_&&e.add(A.events.looped$.subscribe(_)),m&&e.add(A.info.volume$.subscribe(m)),g&&e.add(A.info.currentQuality$.subscribe((e=>e!==s.VideoQuality.INVARIANT&&g(e)))),y&&e.add(A.info.duration$.subscribe(y)),u&&e.add(A.info.position$.subscribe(u)),n&&(e.add(A.events.playing$.subscribe((()=>n(!0)))),e.add(A.events.paused$.subscribe((()=>n(!1))))),p&&e.add(A.events.started$.subscribe(p)),f&&e.add(A.events.firstBytes$.subscribe(f)),I&&e.add(A.events.firstFrame$.subscribe(I)),S&&e.add(A.info.currentFormat$.subscribe(S)),P&&e.add(A.info.videoBitrate$.subscribe(P)),C&&(e.add(A.events.ended$.subscribe(C)),e.add(A.events.looped$.subscribe(C))),b&&(e.add(A.events.started$.subscribe((()=>{b(0)}))),e.add(A.info.position$.subscribe((e=>{e&&b(e)}))))),()=>{e.unsubscribe()}}),[A,v,n,h,m,p,_,u,g,y,C,f,I,S,P]);const E=(0,o.useCallback)((()=>{A?.play()}),[A]),M=(0,o.useCallback)((()=>{A?.pause()}),[A]),F=(0,o.useCallback)((e=>{A?.setMuted(e)}),[A]),k=(0,o.useCallback)((e=>{e&&A?.setVolume(e)}),[A]);return{play:E,pause:M,setMuted:F,setLooped:(0,o.useCallback)((e=>{A?.setLooped(e)}),[A]),setVolume:k,setCurrentTime:(0,o.useCallback)((e=>{A?.seekTime(e)}),[A])}}},786398:(e,t,i)=>{i.d(t,{ObjectPool:()=>o});class o{allocate(){const e=[...this.pool.entries()].find((([,e])=>e)),[t]=e||[this.makeItem()];return this.pool.set(t,!1),t}free(e){this.pool.has(e)&&this.pool.set(e,!0)}size(){return this.pool.size}constructor(e){this.makeItem=e,this.pool=new Map}}},123164:(e,t,i)=>{i.d(t,{VideoPlayerWidget:()=>o.VideoPlayerWrapper});var o=i(609601)},267377:(e,t,i)=>{i.d(t,{PlaylistCheckbox:()=>u});var o=i(474848),s=i(293721),r=i(335797),a=i(361121),n=i(944048),d=i(412888),l=i(231867),c=i(134128);const u=({playlistId:e,videoId:t,videoPlaylistsModalService:i})=>{const u=(0,r.useEntitiesStore)(i.$entitiesPlaylists,e),{itemId:h}=(0,a.splitRawId)(e),p=(0,l.useVideoInPlaylist)(i.$entitiesVideoBinding,t,h),_=(0,s.useEvent)(i.toggleBindingEvent);return u?(0,o.jsx)(n.Checkbox,{checked:p,onChange:()=>_({album_id:h,video_id:t}),titleAfter:(0,o.jsx)(c.PlaylistCheckboxTooltip,{privacy:u?.privacy?.category}),children:(0,o.jsx)(d.TextClamp,{lines:1,children:u.title})}):null}},134128:(e,t,i)=>{i.d(t,{PlaylistCheckboxTooltip:()=>l});var o=i(474848),s=i(866467),r=i(373206),a=i(562791),n=i(578392),d=i(389900);const l=({privacy:e})=>{const t=(()=>{switch(e){case"all":return{Icon:r.Icon16UnlockOutline,text:(0,s.getLang)("video_playlist_available_to_all_tooltip")};case"only_me":return{Icon:a.Icon16LockOutline,text:(0,s.getLang)("video_playlist_private_tooltip")};default:return}})();if(!t)return null;const{Icon:i,text:l}=t;return(0,o.jsx)(n.TextTooltip,{placement:"top",appearance:"black",offsetByCrossAxis:-56,offsetByMainAxis:4,text:l,children:(0,o.jsx)(i,{className:d.default.playlistPrivateIcon})})}},198258:(e,t,i)=>{i.d(t,{PlaylistCheckbox:()=>o.PlaylistCheckbox});var o=i(267377);i(134128)},889177:(e,t,i)=>{i.d(t,{showPlaylistsModal:()=>F});var o=i(474848),s=i(293721),r=i(296540),a=i(884945),n=i(468073),d=i(694244),l=i(782174),c=i(63614),u=i(944048),h=i(194528),p=i(582192),_=i(303800),v=i(753457),g=i(723723),m=i(299494),y=i(700272),b=i(908242),C=i(454154),f=i(866467),I=i(540462),S=i(856289),P=i(902235),w=i(211413),A=i(423151),L=i(826619),E=i(198258);const M=({video:e,ownerId:t,isGroupOwner:i=!1,onClose:w,refreshCoordinates:M,videoPlaylistsModalService:F})=>{const{$videosAlbumsIds:k,$videosAlbumsLoading:x,$videoAlbumsFullyLoaded:V,$wasToggled:O,toggleBindingEvent:T,saveChangesEvent:j,fetchMorePlaylists:R,resetBindingsEvent:D,initModalEvent:B,createPlaylistEvent:N}=(0,s.useUnit)(F),[U,G]=(0,r.useState)(null);(0,r.useEffect)((()=>{M(),D()}),[]),(0,r.useEffect)((()=>{B({ownerId:t,isGroupOwner:i,videoId:e.id,videoOwnerId:e.owner_id})}),[]);const H=(0,S.useVideoInPlaylist)(F.$entitiesVideoBinding,e.id,S.MY_VIDEO_ALBUM_ID);return(0,P.useLazyLoad)(!V&&!x,R,U),(0,o.jsxs)(d.ModalBox,{height:365,children:[(0,o.jsx)(l.ModalHeader,{closeAriaLabel:(0,f.getLang)("box_cancel"),onClose:w,children:(0,f.getLang)("video_playlist_modal_header")}),(0,o.jsx)(c.ModalBody,{insetLevel:1,children:k?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Checkbox,{checked:H,disabled:Boolean(x)&&!k?.length,onChange:()=>{T({video_id:e.id,album_id:S.MY_VIDEO_ALBUM_ID})},children:i?(0,f.getLang)("video_all_groups_videos"):(0,f.getLang)("video_my_added_videos_playlist")}),(0,o.jsx)(h.Spacing,{size:8}),(0,o.jsx)(p.Separator,{}),(0,o.jsx)(h.Spacing,{size:8}),(0,o.jsx)(_.Div,{mode:"horizontal",spacing:6,children:(0,o.jsx)(v.Footnote,{className:(0,g.getColorClass)("color_text_subhead"),weight:"3",children:(0,f.getLang)("video_playlists")})}),!!k.length&&(0,o.jsxs)(m.ModalScrollView,{height:108,maxHeight:108,getRef:G,children:[!!k&&k.map((t=>(0,o.jsx)(E.PlaylistCheckbox,{playlistId:t,videoId:e.id,videoPlaylistsModalService:F},t))),(x||!k)&&(0,o.jsx)(_.Div,{mode:"horizontal",spacing:4,children:(0,o.jsx)(y.Spinner,{})})]}),(0,o.jsx)(v.CellButton,{onClick:o=>{w();const s=i?n.Ranges.convertGroupIdToOwnerId(Math.abs(t)):t;(0,I.partConfigEnabled)("video_playlist_redesign_popup")?(0,A.showPlaylistModal)({ownerId:s,onCreate:N,hasOnCreateSnackbar:!1}):(0,L.createPlaylistPopup)({event:o,ownerId:s,videoId:e.id,videoOwnerId:e.owner_id,requestOrigin:L.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL}).catch()},before:(0,o.jsx)(a.Icon28AddOutline,{}),children:(0,f.getLang)("video_add_video_to_new_playlist")}),!k.length&&(0,o.jsx)(h.Spacing,{size:106})]}):(0,o.jsxs)(_.Div,{mode:"horizontal",children:[(0,o.jsx)(h.Spacing,{size:104}),(0,o.jsx)(y.Spinner,{}),(0,o.jsx)(h.Spacing,{size:104})]})}),(0,o.jsx)(b.ModalFooter,{actions:[(0,o.jsx)(C.Button,{mode:"secondary",size:"m",onClick:w,children:(0,f.getLang)("box_cancel")},1),(0,o.jsx)(C.Button,{mode:"primary",size:"m",onClick:()=>{j(),w()},disabled:!O,children:(0,f.getLang)("Save")},2)]})]})},F=({onDestroy:e,ownerId:t,isGroupOwner:i,video:s,videoPlaylistsModalService:r})=>{(0,w.showMessageBoxModal)((e=>(0,o.jsx)(M,{ownerId:t,isGroupOwner:i,video:s,videoPlaylistsModalService:r,...e})),{onDestroy:e,width:420})}},575312:(e,t,i)=>{i.d(t,{showPlaylistsModal:()=>o.showPlaylistsModal});var o=i(889177)},609152:(e,t,i)=>{i.d(t,{usePlaylistSubscriptionListener:()=>o.usePlaylistSubscriptionListener,useRestrictedPlaylist:()=>s.useRestrictedPlaylist,useSearchTrackCode:()=>n.useSearchTrackCode,useUnavailablePlaylist:()=>r.useUnavailablePlaylist,useWatchLaterTooltipViewed:()=>a.useWatchLaterTooltipViewed});var o=i(887216),s=i(302996),r=i(963147),a=i(257259),n=i(580145)},887216:(e,t,i)=>{i.d(t,{usePlaylistSubscriptionListener:()=>n});var o=i(293721),s=i(296540),r=i(174269),a=i(977780);const n=e=>{const t=e??r.appCatalogService,i=(0,o.useEvent)(t.playlistService.updatePlaylistSubscriptionState);(0,s.useEffect)((()=>{const e=({detail:e})=>i({album_id:e.albumId,owner_id:e.ownerId,is_subscribed:e.isSubscribed});return window.addEventListener(a.VideoPlaylistEvents.SUBSCRIPTION_STATE_CHANGE,e),()=>window.removeEventListener(a.VideoPlaylistEvents.SUBSCRIPTION_STATE_CHANGE,e)}),[])}},302996:(e,t,i)=>{i.d(t,{useRestrictedPlaylist:()=>a});var o=i(293721),s=i(768797),r=i(29593);const a=()=>{const e=(0,o.useStore)(s.playlistService.$videosError);return(0,r.isAccessDenied)(e)}},580145:(e,t,i)=>{i.d(t,{useSearchTrackCode:()=>r});var o=i(296540),s=i(231450);const r=()=>{const[e]=(0,o.useState)((()=>(0,s.getTrackCode)("search_track_code")));return e}},963147:(e,t,i)=>{i.d(t,{useUnavailablePlaylist:()=>a});var o=i(293721),s=i(768797),r=i(29593);const a=()=>{const e=(0,o.useStore)(s.playlistService.$videosError);return(0,r.isIdInvalid)(e)||(0,r.isVideosEnabled)(e)}},257259:(e,t,i)=>{i.d(t,{useWatchLaterTooltipViewed:()=>r});var o=i(296540),s=i(615494);const r=()=>{const[e,t]=(0,o.useState)(!1),i=(0,o.useCallback)((()=>{window.isVideoWatchLaterTooltipViewed=!0}),[]);return(0,o.useEffect)((()=>{const e=()=>t(!0);return window.addEventListener(s.VIDEO_SHOWCASE_WATCH_LATER_TOOLTIP_VIEWED_EVENT,e),()=>window.removeEventListener(s.VIDEO_SHOWCASE_WATCH_LATER_TOOLTIP_VIEWED_EVENT,e)}),[]),{isWatchLaterTooltipViewed:e,handleWatchLaterTooltipClose:i}}},58697:(e,t,i)=>{i.d(t,{getSubscriptionsPageServices:()=>a});var o=i(32489),s=i(558137),r=i(768797);const a=(0,s.makeSharedState)("static/js/modules/web/VideoShowcase/pages/SubscriptionsPage/getSubscriptionsPageServices.ts",(()=>({catalogService:(0,r.createPageCatalogService)((0,o.createDomain)("VideoShowcase/SubscriptionsPage"))})),{version:1})},352986:(e,t,i)=>{i.d(t,{ACCEPT_THUMB_FILES:()=>f,DEFAULT_VIDEO_GROUPS_PRIVACY:()=>u,DEFAULT_VIDEO_PRIVACY:()=>c,ENCODE_ATTEMPTS:()=>P,EUsersPrivacyCategories:()=>h,GROUPS_PRIVACY_BY_LINK:()=>l,GROUPS_PRIVACY_LIST:()=>v,MAX_LENGTH_OF_DESCRIPTION:()=>C,MAX_LENGTH_OF_TITLE:()=>b,MAX_SUBTITLES_COUNT:()=>g,PREVIEW_COLUMN_WIDTH:()=>d,SUBTITLES_INPUT_ACCEPT:()=>m,TAB_NAME_TO_VIDEO_PUBLISH_ACTION_EVENT_TYPE_MAPPER:()=>w,THUMB_HEIGHT:()=>S,THUMB_WIDTH:()=>I,UPLOAD_PATHNAME:()=>a,UPLOAD_SDK_SETTINGS:()=>y,USERS_PRIVACY_LIST:()=>p,YANDEX_DISK_ORIGIN:()=>n});var o=i(395846),s=i(210986),r=i(317216);const a=`${(0,i(856289).getVideoPrefix)("backSlash")}upload`,n="https://disk.yandex.ru",d=319,l=3,c=[0,1,[0],[]],u=[1,1,[1],[]];var h;!function(e){e[e.all=0]="all",e[e.friends=1]="friends",e[e.friendsOfFriends=2]="friendsOfFriends",e[e.onlyMe=3]="onlyMe",e[e.allExcept=4]="allExcept",e[e.someFriends=5]="someFriends",e[e.someFriendLists=6]="someFriendLists",e[e.byLink=8]="byLink"}(h||(h={}));const p=[{alias:"all",value:0},{alias:"by_link",value:8},{alias:"friends_of_friends",value:2},{alias:"friends",value:1},{alias:"only_me",value:3},{alias:"all_except",value:4},{alias:"some_friends",value:5},{alias:"some_friend_lists",value:6}];var _;!function(e){e[e.notPublished=-1]="notPublished",e[e.all=0]="all",e[e.members=1]="members",e[e.editors=2]="editors",e[e.byLink=3]="byLink",e[e.nobody=4]="nobody",e[e.donut=5]="donut"}(_||(_={}));const v=[{alias:"all",value:0},{alias:"members",value:1},{alias:"editors",value:2},{alias:"by_link",value:3},{alias:"nobody",value:4},{alias:"donut",value:5},{alias:"not_published",value:-1}],g=5,m=".srt",y={chunkSize:o.VIDEO_UPLOAD_CHUNK_SIZE,threadNumber:o.VIDEO_UPLOAD_FILE_THREAD_NUMBER,maxRetryNumber:o.VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER,debugMode:window.videoUploadSdkConfig&&!0===window.videoUploadSdkConfig.debugMode},b=128,C=5e3,f=".jpg,.jpeg,.png",I=142,S=80,P=4,w={[s.TabType.Information]:r.VideoPublishActionEventTypes.EVENT_TYPE_GO_TO_INFORMATION,[s.TabType.Additional]:r.VideoPublishActionEventTypes.EVENT_TYPE_GO_TO_ADDITIONAL,[s.TabType.Publication]:r.VideoPublishActionEventTypes.EVENT_TYPE_GO_TO_PUBLICATION}},210986:(e,t,i)=>{var o,s;i.d(t,{EditSubtitleAction:()=>s,TabType:()=>o}),function(e){e.Information="Information",e.Additional="Additional",e.Publication="Publication"}(o||(o={})),function(e){e.Remove="remove",e.EditLang="edit_lang",e.SetDefault="set_default"}(s||(s={}))},72966:(e,t,i)=>{i.d(t,{checkFileParams:()=>K,filterBatchedEditVideoResponse:()=>U,filterBatchedPublishVideoRejectedResponse:()=>N,filterBatchedPublishVideoResponse:()=>B,filterRejectedResponse:()=>z,filterRejectedResponseWithErrorSubcode:()=>Y,getBatchedRequestsResponsesMapper:()=>D,getExitConfirmInfo:()=>F,getFormattedOrdData:()=>w,getMyVideosUrl:()=>j,getPlaylistOption:()=>E,getPrivacyLabel:()=>x,getResponseForCurrentVideo:()=>T,getUploadFormId:()=>P,getValidVideoFiles:()=>M,getVideoEditParams:()=>H,getVideoPrivacyKey:()=>k,getVideoPublishParams:()=>G,hasUnpublishedVideos:()=>$,isAbortApiError:()=>f,isSuccessfulVideoDeletingResponseForCurrentVideo:()=>R,ordMiniAppOpen:()=>A,parsePrivacyNewFormatToOld:()=>O,parsePrivacyOldFormatToNew:()=>V,shouldDisableDate:()=>L,showNotification:()=>W,videoUploadLogEvent:()=>I});var o=i(60411),s=i(866467),r=i(636576),a=i(479672),n=i(27813),d=i(782399),l=i(538522),c=i(615650),u=i(352986),h=i(664331),p=i(395846),_=i(856289),v=i(172479),g=i(898848),m=i(807978),y=i(540462),b=i(652547),C=i(248812);const f=e=>e&&(0,d.isNetworkError)(e)&&(0,h.isRequestAbortError)(e.error),I=(e,t)=>{let i;"boolean"==typeof t&&(i=t?"on":"off"),(0,r.statlogsValueEvent)("video_upload_page","",e,i)},S=(e=!0)=>{const t=e?"visible":"hidden",i=e?"1":"0",o=document.getElementById("box_layer_bg"),s=document.getElementById("box_layer_wrap");s&&o&&(s.style.visibility=t,o.style.visibility=t,s.style.opacity=i)},P=e=>e.fileObject?(0,l.joinRawId)({ownerId:e.fileObject.owner_id||0,itemId:e.fileObject.video_id||0}):e.externalFileObject?String(e.externalFileObject.extraData):"",w=e=>JSON.stringify({is_ads:e.is_ad,advertisers:[{ord_pred_id:e.ord_pred_id,er_id:e.erid}]}),A=(e,t,i,r=!0,a)=>{const n={edit:!1,options:{noLocChange:1,skipBoxesHide:1,hideBackButton:1,hideCloseButton:1,noClickHide:1,onLoaded:()=>{const e=document.querySelector(".app_actions_menu_wrap");e&&(e.style.display="none"),window.wkcur.onFail=S,window.wkcur.onHide=()=>{S(),window.cur.onExternalAppDone=null,window.wkcur.onFail=null,window.wkcur.onHide=null},window.cur.onExternalAppDone=()=>{window?.WkView.hide(!1,!0)},S(!1)},onFail:()=>S()},isSnackbar:!1};(0,o.handleOrdMiniappOpen)(e,(e=>{e&&(t(e),e.is_ad?i((0,s.getLang)("video_clip_ads_from_author_added")):i((0,s.getLang)("video_clip_ads_from_author_empty")),S()),r&&I("onAddAdvertisement")}),n,a)},L=e=>{const t=new Date,i=new Date;return t.setDate(t.getDate()-1),i.setMonth(i.getMonth()+3),(0,a.default)(e,i)||(0,n.default)(e,t)},E=e=>({label:e.title,value:e.id,preview:e.image?.[0]?.url||"",privacy:"all"!==e.privacy?.category}),M=e=>{const t=new DataTransfer;if(e?.length)for(let i=0;i<e.length;i++){const o=e.item(i);o&&(0,c.checkFileType)(o,p.SHORT_VIDEO_UPLOAD_EXTS)&&t.items.add(o)}return t.files},F=({notUploadedVideosCount:e=0,unsavedVideosCount:t=0,unsavedPostponedVideosCount:i=0,externalVideosCount:o=0,notUploadedClipCount:r=0,unsavedClipCount:a=0,unsavedClipPostponedCount:n=0,publishedNotUploadedVideosCount:d=0})=>{let l="",c="",u=(0,s.getLang)("video_publish_btn"),h=(0,s.getLang)("video_upload_come_back_later");return 1!==e||1!==o||t||i?o>1&&e===o&&!t&&!i?(l=(0,s.getLang)("video_upload_publish_video"),c=(0,s.getLang)("video_upload_cancel_externals_uploading"),h=(0,s.getLang)("global_cancel")):d?(l=(0,s.getLang)("video_uploader_page_exit_title"),c=(0,s.getLang)("video_uploader_page_exit_message"),u=(0,s.getLang)("video_uploader_leave"),h=(0,s.getLang)("global_cancel")):e&&e!==o||r?(l=(0,s.getLang)("video_upload_cancel_uploading"),c=(0,s.getLang)("video_upload_cancel_uploading_exit"),u=(0,s.getLang)("video_upload_interrupt_and_exit"),h=(0,s.getLang)("global_cancel")):t&&!i&&a&&!n?(l=(0,s.getLang)("video_upload_publish_video"),c=(0,s.getLang)("video_upload_publish_video_clip_text")):!t&&i&&!a&&n?(l=(0,s.getLang)("video_upload_schedule_publication"),c=(0,s.getLang)("video_upload_schedule_publication_video_clip_text"),u=(0,s.getLang)("video_upload_schedule_post")):(t||i)&&(a||n)?(l=(0,s.getLang)("video_upload_publish_video"),c=(0,s.getLang)("video_upload_publish_many_video_clip_text")):1!==t||i?1!==i||t?i>1&&!t?(l=(0,s.getLang)("video_upload_schedule_publications"),c=(0,s.getLang)("video_upload_schedule_publications_text"),u=(0,s.getLang)("video_upload_schedule_publications_btn")):i||t||o?(l=(0,s.getLang)("video_upload_publish_video"),c=(0,s.getLang)("video_upload_publish_many_videos_text")):a?(l=(0,s.getLang)("video_upload_publish_clip"),c=(0,s.getLang)("video_upload_publish_clip_text"),h=(0,s.getLang)("global_cancel")):a||1!==n?!a&&n>1&&(l=(0,s.getLang)("video_upload_schedule_publications"),c=(0,s.getLang)("video_upload_schedule_publications_text"),u=(0,s.getLang)("video_upload_schedule_publications_btn"),h=(0,s.getLang)("global_cancel")):(l=(0,s.getLang)("video_upload_schedule_publication"),c=(0,s.getLang)("video_upload_schedule_publication_modal_text"),u=(0,s.getLang)("video_upload_schedule_post"),h=(0,s.getLang)("global_cancel")):(l=(0,s.getLang)("video_upload_schedule_publication"),c=(0,s.getLang)("video_upload_schedule_publication_modal_text"),u=(0,s.getLang)("video_upload_schedule_post")):(l=(0,s.getLang)("video_upload_publish_video"),c=(0,s.getLang)("video_upload_publish_video_modal_text")):(l=(0,s.getLang)("video_upload_publish_video"),c=(0,s.getLang)("video_upload_cancel_external_uploading"),h=(0,s.getLang)("global_cancel")),{title:l,text:c,primaryBtn:u,secondaryBtn:h}},k=(e,t="",i="")=>t+[e.ownerId,e.fileObject?.video_id??e.externalFileObject?.extraData??0,i].filter(Boolean).join("_"),x=e=>{switch(e){case"all":return(0,s.getLang)("privacy_options_all_users");case"members":return(0,s.getLang)("video_privacy_group_for_members");case"editors":return(0,s.getLang)("video_privacy_group_for_editors");case"by_link":return(0,s.getLang)("video_privacy_group_by_link");case"donut":return(0,s.getLang)("video_privacy_group_for_donut");case"friends":return(0,s.getLang)("privacy_options_friends_only");case"friends_of_friends":return(0,s.getLang)("privacy_options_friends_and_friends");case"only_me":return(0,s.getLang)("privacy_options_only_me");case"nobody":return(0,s.getLang)("privacy_options_nobody");case"all_except":return(0,s.getLang)("privacy_options_advanced_settings");case"some_friends":return(0,s.getLang)("privacy_options_some_friends");case"some_friend_lists":return(0,s.getLang)("privacy_options_some_friend_lists");case"best_friends":return(0,s.getLang)("video_clips_privacy_options_best_friends_only");default:return""}},V=(e,t)=>{const i=(window.Privacy.getValue(e)||"").split("_");if(1===i.length)return t.find((e=>String(e.value)===i[0]))?.alias||"";if(2===i.length)return Number(i[0])+1===u.EUsersPrivacyCategories.someFriendLists?i[1].split(",").map((e=>`list${e}`)).join(","):i[1];if(4===i.length){const e=i[3].split(",").map((e=>Number(e)<0?`-list${Math.abs(Number(e))}`:String(-e))).join(",");if("0"===i[1]){return`${i[2].split(",").map((e=>Number(e)<0?`list${Math.abs(Number(e))}`:e)).join(",")},${e}`}return`${t.find((e=>String(e.value)===i[2]))?.alias||""},${e}`}return""},O=(e,t)=>{const i=e.owners?.allowed||[],o=e.owners?.excluded||[],s=e.lists?.allowed?.map((e=>-e))||[],r=e.lists?.excluded?.map((e=>-e))||[],a=e.category;if(a&&"list28"!==a){const e=String(t.find((e=>e.alias===a))?.value||0);return o.length||r.length?[u.EUsersPrivacyCategories.allExcept,1,[e],r.concat(o)]:[e,1,[e],[]]}return o.length||r.length?[u.EUsersPrivacyCategories.allExcept,0,s.concat(i),r.concat(o)]:i.length?[String(u.EUsersPrivacyCategories.someFriends),0,i,[]]:s.length?[String(u.EUsersPrivacyCategories.someFriendLists),0,s,[]]:["0",1,["0"],[]]},T=(e,t)=>{const i=t?.fileObject;if(!t||!i)return!1;const o=i.owner_id,s=i.video_id;if(!o||!s)return!1;return e[(0,l.joinRawId)({ownerId:o,itemId:s})]},j=(e,t)=>{const i=(0,v.getOwnerUrl)(e,(0,_.getOwnerVideosPageBasePath)());return e?.id&&t?[i,new URLSearchParams({section:t}).toString()].join("?"):i},R=(e,t)=>{const i=T(e,t);return i&&"fulfilled"===i?.status&&1===i?.value},D=(e,t)=>t.reduce(((t,i,o)=>{const s=e[o];if(s&&"owner_id"in s&&"number"==typeof s.owner_id&&"video_id"in s&&"number"==typeof s.video_id){const e=(0,l.joinRawId)({ownerId:s.owner_id,itemId:s.video_id});return{...t,[e]:{...i,query:s}}}return t}),{}),B=({uploadData:e},t)=>{const i=T(t,e);return i&&"fulfilled"===i?.status&&!!i?.value?.video},N=({uploadData:e},t)=>{const i=T(t,e);if(!i||"rejected"!==i?.status)return!1;const{error:o}=i?.reason;return o&&"error_subcode"in o&&-1!==Number(o.error_subcode)},U=({uploadData:e},t)=>{const i=T(t,e);if(!i||"fulfilled"!==i.status)return!1;const o=i?.value;return!!o.success},G=({uploadData:e,title:t,description:i,isRepeat:o,publishDate:s,ordInfo:r,selectedThumb:a,uploadedThumb:n,isImproveQuality:d,isHideAutoSubs:c,actionLink:u,actionLinkError:h,isPublishOnWall:p,checkContentId:_,privacyVideoList:v,privacyCommentsList:g,improveQualityDisabled:b,clipsForVideo:C,donutSelectedLevelId:f})=>{const S=e?.fileName||"",P={owner_id:Number(e?.fileObject?.owner_id),video_id:Number(e?.fileObject?.video_id),title:t,description:i,repeat:o?1:0,hide_auto_subs:c?1:0,improve:d&&!b?1:0,add_to_wall:p?1:0,file_ext:S.match(/\.([^.]+)$/)?.[1],check_content_id:_?1:0,donut_level_id:f??void 0};if(!h&&u&&(P.action_link=u,I("onLinkInVideo")),s&&(P.publish_at=Math.floor(s.getTime()/m.SECOND)),a&&(P.thumb_id=String(a),a===n?.photo_id&&(P.thumb_id=(0,l.joinRawId)({ownerId:a,itemId:Number(n?.photo_owner_id)}),P.thumb_hash=n.photo_hash)),r&&(P.ord_info=w(r)),window.nav?.objLoc?.ocl&&(P.ocl=1),e&&(P.privacy_video=V(k(e,"video"),v),P.privacy_video_comments=V(k(e,"videocomm"),g)),(0,y.partConfigEnabled)("video_attach_clips_to_video")){const e=C.map((e=>(0,l.joinRawId)({itemId:Number(e.id),ownerId:Number(e.owner_id)})));P.attach_short_videos=e.join(",")}return I(i.length?"onSaveWithDesc":"onSaveVideo"),P},H=({uploadData:e,title:t,description:i,isRepeat:o,publishDate:s,ordInfo:r,selectedThumb:a,uploadedThumb:n,isImproveQuality:d,isHideAutoSubs:c,actionLink:u,isPublished:h,savedVideo:p,isExternal:_,privacyVideoList:v,privacyCommentsList:g,actionLinkError:y,improveQualityDisabled:b})=>{const C={owner_id:p?.owner_id?p.owner_id:Number(e?.fileObject?.owner_id),video_id:p?.id?p.id:Number(e?.fileObject?.video_id),name:t,desc:i};return _||(C.repeat=o?1:0,C.hide_auto_subs=c?1:0,C.improve=d&&!b?1:0,a&&(C.thumb_id=String(a),a===n?.photo_id&&(C.thumb_id=(0,l.joinRawId)({ownerId:a,itemId:Number(n?.photo_owner_id)}),C.thumb_hash=n.photo_hash)),h||(C.publish_date=Math.floor((s?s.getTime():Date.now())/m.SECOND)),!y&&u&&(C.action_link=u,I("onLinkInVideo"))),r&&(C.ord_info=w(r)),h&&e&&(C.privacy_view=V(k(e,"video"),v),C.privacy_comment=V(k(e,"videocomm"),g)),I(i.length?"onSaveWithDesc":"onSaveVideo"),C},z=({uploadData:e},t)=>{const i=T(t,e);return i&&"rejected"===i?.status},Y=({uploadData:e},t)=>{const i=T(t,e);if(!i||"rejected"!==i?.status)return!1;const{error:o}=i?.reason;return o&&"error_subcode"in o&&-1!==Number(o.error_subcode)},W=({fileType:e,ownerType:t,groupName:i,amount:o})=>{if(!("Notifier"in window)||!("showEvent"in window.Notifier))return;const r=(({ownerType:e,groupName:t,amount:i})=>{if("multiple"===i)return"user"===e?(0,s.getLang)("global_video_uploader_success_videos_publication_notification_for_user"):t?(0,s.langReplace)((0,s.getLang)("global_video_uploader_success_videos_publication_notification_for_community"),{name:t}):void 0})({ownerType:t,groupName:i,amount:o})??(({fileType:e,ownerType:t,groupName:i})=>{if("video"===e)return"user"===t?(0,s.getLang)("global_video_uploader_success_video_publication_notification_for_user"):i?(0,s.langReplace)((0,s.getLang)("global_video_uploader_success_video_publication_notification_for_community"),{name:i}):void 0})({fileType:e,ownerType:t,groupName:i})??(({fileType:e,ownerType:t,groupName:i})=>{if("clip"===e)return"user"===t?(0,s.getLang)("global_video_uploader_success_clip_publication_notification_for_user"):i?(0,s.langReplace)((0,s.getLang)("global_video_uploader_success_clip_publication_notification_for_community"),{name:i}):void 0})({fileType:e,ownerType:t,groupName:i})??"";window.Notifier.showEvent({type:"done_box",preventHideByClick:!0,text:`<div style="min-height: 32px; display: flex; align-items: center;"><div className="notifier_snackbar_text">${(0,g.clean)(r)}</div></div>`,avatar_custom_content:(0,C.getIcon24CheckCircleOutline)().icon,tooltipHandler:e=>{e.classList.add("notifier_snackbar_with_custom_before"),e.classList.add("notifier_snackbar_type_ok")}})},$=e=>e.unsavedClipCount>0||e.unsavedVideosCount>0||e.externalVideosCount>0||e.notUploadedClipCount>0||e.notUploadedVideosCount>0||e.unsavedClipPostponedCount>0||e.unsavedPostponedVideosCount>0||e.publishedNotUploadedVideosCount>0;async function K(e,t){const i=await(0,c.getVideoMetadata)(e),o=(0,y.getConfigValue)("short_video_publish_video_to_clips_duration_min")??b.CLIP_MIN_LIMIT,s=(0,y.getConfigValue)("short_video_publish_video_to_clips_duration_max")??b.CLIP_MAX_LIMIT;return{hasMetadata:!!i&&"duration"in i&&"height"in i&&"width"in i,isVideoAsClip:!t?.is_closed&&(null!==i&&i.duration<s&&i.duration>o&&i.height>=i.width)}}},60411:(e,t,i)=>{i.d(t,{handleOrdMiniappOpen:()=>l});var o=i(494565),s=i(52905),r=i(866467),a=i(310338),n=i(432465),d=i(545537);const l=(e,t,i,l)=>{const c=l?{...e,service:l}:e,u=c?(0,o.objectToQuerystring)(c,"#"):"",h=(0,a.getStore)().onOrdData.watch((o=>{i?.isSnackbar&&(o?.is_ad&&!e?.is_ad?(0,n.showSnackbar)({text:(0,r.getLang)("global_ads_wall_post_ord_mark_as_ads_added"),timeout:3e3,type:"ok28"}):!o?.is_ad&&e?.is_ad&&(0,n.showSnackbar)({text:(0,r.getLang)("global_ads_wall_post_ord_mark_as_ads_removed"),timeout:3e3,type:"loudspeaker28"})),t(o,i?.ref),h()}));i=i||{};const p={...i,options:{...i.options||{}}},{onDestroy:_,onLoaded:v}=p.options;p.options.asBox?p.options.onDestroy=(...e)=>{_?.(...e),h()}:p.options.onLoaded=(...e)=>{v?.(...e),(0,d.addWkViewHideQueue)((()=>h()))},window.showWiki?.({w:`app${s.ORD_APP_ID}${u}`},p?.edit,p?.ev,p?.options)}},279515:(e,t,i)=>{i.d(t,{VideoCardWrapper:()=>p});var o=i(474848),s=i(618068),r=i(296540),a=i(174269),n=i(317216),d=i(856289),l=i(29593),c=i(35674),u=i(290874),h=i(540462);const p=({controls:e,actions:t,owner:i,video:p,onVideoOpen:_,onToggleFav:v,onAuthorClick:g,collectClick:m,videoContainerWidth:y,direction:b,...C})=>{const f=(0,r.useRef)(null),I=(0,h.partConfigEnabled)("video_card_controls_focus_fix"),S=(0,u.useMenuActions)(p,t),P=(0,u.useControls)({video:p,controls:e??[],onToggleFav:v}),w=(0,a.useRefLogView)({type:n.EventItemType.VIDEO,trackCode:p?.track_code});return(0,o.jsx)(s.VideoCard,{getRef:I?e=>{w?.(e),f.current=e}:w,controlItems:(0,o.jsx)(c.VideoCardControls,{video:p,cardRef:I?f:void 0,collectClick:m,controls:P??[]}),menuItems:S,video:{...(0,d.mapVideoToVideoCardItem)(p),owner:{...(0,d.mapArtistToVideoCardOwner)(p)??(0,d.mapUserOrGroupToVideoCardOwner)(i,(0,d.getOwnerVideosPageBasePath)()),badge:(0,l.getVerifiedBadge)(i)}},onVideoOpen:_,onAuthorClick:g,direction:b,videoContainerWidth:"horizontal"===b?y:void 0,...C})}},949963:(e,t,i)=>{i.d(t,{VideoCardControls:()=>a});var o=i(474848),s=i(618068),r=i(642311);const a=({video:e,controls:t,collectClick:i,cardRef:a})=>t?.length?(0,o.jsx)(o.Fragment,{children:t.map((t=>{if(t.type===r.ControlTypes.ICON){const{text:i,onClick:r,component:a}=t;return(0,o.jsx)(s.VideoCard.IconControl,{tooltipText:i,onClick:t=>r(t,e),icon:a},i)}if(t.type===r.ControlTypes.PLAYLIST_POPOVER){const{component:s}=t;return(0,o.jsx)(s,{video:e,collectClick:i,cardRef:a},e.id)}}))}):null},331934:(e,t,i)=>{i.d(t,{VideoCardControls:()=>o.VideoCardControls});var o=i(949963)},35674:(e,t,i)=>{i.d(t,{VideoCardControls:()=>o.VideoCardControls});var o=i(331934)},524236:(e,t,i)=>{i.d(t,{showEditVideoForm:()=>s});var o=i(270959);const s=({oid:e,vid:t})=>{const i={vid:t,oid:e};(0,o.showBox)("al_video.php?act=edit_box",i,{containerClass:"video_edit"})}},867783:(e,t,i)=>{i.d(t,{reportHandler:()=>o.reportHandler,showEditVideoForm:()=>s.showEditVideoForm});var o=i(269533),s=i(524236)},269533:(e,t,i)=>{i.d(t,{reportHandler:()=>s});var o=i(866467);const s=async(e,t)=>{e&&t&&(window.Videoview||await window.stManager.add([window.jsc("web/videoview.js")]),window.Videoview.showReportVideoForm(t,e,(()=>{window.VideoShowcase?.showCardFeedback(t,e,(0,o.getLang)("global_report_spam"))})))}},290874:(e,t,i)=>{i.d(t,{useControls:()=>o.useControls,useMenuActions:()=>s.useMenuActions});var o=i(277553),s=i(634341)},277553:(e,t,i)=>{i.d(t,{useControls:()=>v});var o=i(296540),s=i(868687),r=i(48876),a=i(379539),n=i(947962),d=i(866467),l=i(636826),c=i(109889),u=i(642311),h=i(142553),p=i(540462),_=i(174269);const v=({video:e,controls:t,onToggleFav:i})=>(0,o.useMemo)((()=>{const{id:o,owner_id:v,can_edit:g,can_download:m,title:y,type:b,can_add:C}=e,f=Array.isArray(t)?t:[],I=(0,p.partConfigEnabled)("video_bookmarks_renaming_to_watch_later"),S=(0,p.partConfigEnabled)("video_can_show_playlist_popover_with_watch_later");return I&&e.can_add_to_faves&&f.push({type:u.ControlTypes.ICON,component:e.is_favorite?s.Icon16Clock:r.Icon16ClockOutline,text:e.is_favorite?(0,d.getLang)("video_remove_from_watch_later"):(0,d.getLang)("video_catalog_showcase_section_my_watch_later_title"),onClick:()=>i(_.FAVORITE_SOURCES.VIDEO_CARD_BUTTON)}),g&&o&&v&&f.push({component:a.Icon16PenOutline,text:(0,d.getLang)("video_edit"),onClick:()=>(0,c.showEditVideoForm)({oid:String(v),vid:String(o)}),type:u.ControlTypes.ICON}),3===m&&o&&v&&y&&b&&f.push({component:n.Icon16DownloadOutline,text:(0,d.getLang)("video_download_short"),onClick:()=>(0,l.downloadVideo)({oid:String(v),title:y,type:b,vid:String(o)}),type:u.ControlTypes.ICON}),!C||!S&&I||f.push({type:u.ControlTypes.PLAYLIST_POPOVER,component:h.AddToPlaylistControl}),f}),[e,t])},634341:(e,t,i)=>{i.d(t,{useMenuActions:()=>c});var o=i(474848),s=i(296540),r=i(405816),a=i(866467),n=i(109889),d=i(671112),l=i(540462);const c=(e,t)=>(0,s.useMemo)((()=>{const i=Array.isArray(t)?t:[],s=(0,l.partConfigEnabled)("vk_live_integration")&&!!e.vk_live_channel_url&&(0,d.isLiveVideo)(e);if(e.owner_id!==window.vk.id&&e.owner_id&&e.id&&!s&&i.push({before:(0,o.jsx)(r.Icon20ReportOutline,{}),children:(0,a.getLang)("global_report_spam"),onClick:()=>(0,n.reportHandler)(String(e.id),String(e.owner_id))}),i.length)return i}),[e])},109889:(e,t,i)=>{i.d(t,{VideoCardControls:()=>s.VideoCardControls,VideoCardWrapper:()=>o.VideoCardWrapper,reportHandler:()=>a.reportHandler,showEditVideoForm:()=>a.showEditVideoForm,useControls:()=>r.useControls,useMenuActions:()=>r.useMenuActions});var o=i(279515),s=i(35674),r=i(290874),a=i(867783)},916637:(e,t,i)=>{i.d(t,{showVideo:()=>d});var o=i(174269),s=i(134551),r=i(856289),a=i(540462),n=i(538522);const d=({event:e,id:t,video:i})=>{e.preventDefault();const d=i.viewed_duration?(0,o.getPlayFromByDuration)(i.viewed_duration):"",l=!(0,r.isVideoStandalone)(),c=!((0,a.partConfigEnabled)("video_new_video_page")&&(0,r.isVideoSection)()),u="music_video"===i.type&&l,h="live"===i.type&&i.live_status&&["started","waiting"].includes(i.live_status),p="short_video"===i.type;l&&c||u||h||p?s.Video.show(e,t,{autoplay:1,queue:0,playFrom:d,addParams:{track_code:i.track_code}},e.target):(window.VideoShowcase?.setVideoPageOpts({module:window.cur.currentModule?window.cur.currentModule():window.cur.module,trackCode:i.track_code,context:window.cur.ref_context}),window.nav.go(`/video${(0,n.joinRawId)({ownerId:Number(i.owner_id),itemId:Number(i.id)})}`))}},92600:(e,t,i)=>{i.d(t,{AddToPlaylistControl:()=>f});var o=i(474848),s=i(293721),r=i(296540),a=i(618068),n=i(335797),d=i(344634),l=i(711032),c=i(866467),u=i(856289),h=i(574479),p=i(687320),_=i(29593),v=i(826619),g=i(296761),m=i(317216),y=i(540462),b=i(450927),C=i(423151);const f=({video:e,collectClick:t,cardRef:i,searchTrackCode:f,...I})=>{const[S,P]=(0,r.useState)(!1),{owner_id:w=0,id:A=0,added:L}=e,E=(0,p.ensurePlaylistPopoverService)(),M=(0,_.getVideoCardKey)(w,A),F=(0,n.useEntitiesStore)(E.videoCardEntities,M),k=(0,g.usePlaylists)(E.$playlistEntityStore),x=(0,s.useStore)(E.$playlistsLoading),V=(0,s.useStore)(E.$playlistsFullyLoaded),O=(0,s.useStore)(E.$ownerId),T=(0,s.useEvent)(E.addVideoCardEntity),j=(0,s.useEvent)(E.togglePlaylistAddedEvent),R=(0,s.useEvent)(E.fetchPlaylistsEvent),D=(0,s.useEvent)(E.fetchMorePlaylistsEvent),B=(0,s.useStore)(E.$curVideoAddedToMy),N=(0,s.useEvent)(E.clearStoreEvent),U=(0,s.useEvent)(E.createPlaylistEvent),G=(0,y.partConfigEnabled)("video_bookmarks_renaming_to_watch_later"),H=(0,y.partConfigEnabled)("video_can_show_playlist_popover_with_watch_later"),z=F?.added?(0,c.getLang)("video_card_added_button_label"):(0,c.getLang)("video_card_add_button_label"),Y=G&&H?void 0:z,W=e=>{P(e),e||N()};return(0,r.useEffect)((()=>{T({added:Boolean(L),oid:w,vid:A})}),[]),(0,r.useEffect)((()=>{S&&R(M)}),[S]),(0,r.useEffect)((()=>{(0,y.partConfigEnabled)("video_playlist_redesign_popup")||window.VideoShowcase||(0,b.getVideoShowcaseModule)()}),[]),(0,o.jsx)(h.PlaylistPopover,{trigger:"hover",shown:S,cardRef:i,addedToMy:Boolean(B),onToggleVideoAdded:(o,s)=>(t?.({action:o?m.SearchClickActionMap.REMOVE_FROM_ME:m.SearchClickActionMap.ADD_TO_ME,track_code:e?.track_code,type:m.EventItemType.VIDEO}),(0,_.logAddToMeClick)(o,m.EventItemType.VIDEO,e?.track_code,f),i?.current?.parentElement?.focus(),j({key:M,album_id:s,isAdded:o})),onCreateNewPlaylist:e=>{W(!1),(0,y.partConfigEnabled)("video_playlist_redesign_popup")?(0,C.showPlaylistModal)({ownerId:O,onCreate:e=>U({...e,ownerId:O,videoId:A,videoOwnerId:w}),hasOnCreateSnackbar:!1}):(0,v.createPlaylistPopup)({event:e,ownerId:O,videoId:A,videoOwnerId:w,requestOrigin:v.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL}).catch()},addedToMyCheckboxDisabled:x,playlistsLoading:x,playlists:k,width:u.PLAYLIST_POPOVER_WIDTH,maxWidth:u.PLAYLIST_POPOVER_WIDTH,offsetByMainAxis:u.PLAYLIST_POPOVER_VERTICAL_OFFSET,placement:"bottom-end",fetchMorePlaylistEvent:V?void 0:D,onShownChange:W,...I,children:(0,o.jsx)(a.VideoCard.ExpandingControl,{icon:F?.added?(0,o.jsx)(d.Icon16CheckOutline,{"data-testid":I["data-testid"]}):(0,o.jsx)(l.Icon16Add,{"data-testid":I["data-testid"]}),text:Y,expanded:S})})}},142553:(e,t,i)=>{i.d(t,{AddToPlaylistControl:()=>o.AddToPlaylistControl});var o=i(92600)},348904:(e,t,i)=>{i.d(t,{PlaylistPopover:()=>C});var o=i(474848),s=i(296540),r=i(625528),a=i(303800),n=i(944048),d=i(194528),l=i(582192),c=i(753457),u=i(700272),h=i(744440),p=i(454154),_=i(866467),v=i(635172),g=i(549318),m=i(856289),y=i(245321),b=i(902235);const C=({addedToMy:e,playlists:t,onToggleVideoAdded:i,children:C,trigger:f="hover",videoId:I,videoOwnerId:S,playlistsLoading:P,onCreateNewPlaylist:w,addedToMyCheckboxDisabled:A,fetchMorePlaylistEvent:L,cardRef:E,...M})=>{const[F,k]=(0,s.useState)(null);(0,b.useLazyLoad)(Boolean(L),L,F);return(0,o.jsx)(r.Popover,{trigger:f,restoreFocus:!1,content:(0,o.jsxs)(a.Div,{children:[(0,o.jsx)(n.Checkbox,{checked:e,disabled:A,onChange:()=>{E?.current?.parentElement?.focus(),i(e,m.MY_VIDEO_ALBUM_ID)},children:(0,_.getLang)("video_my_added_videos_playlist")}),(Boolean(t?.length)||P)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d.Spacing,{size:8}),(0,o.jsx)(l.Separator,{}),(0,o.jsx)(d.Spacing,{size:4}),(0,o.jsx)(a.Div,{mode:"vertical",spacing:8,children:(0,o.jsx)(c.Footnote,{className:v.default.playlistSubhead,weight:"3",children:(0,_.getLang)("video_playlists")})})]}),P&&!t?.length&&(0,o.jsx)("div",{className:v.default.scrollHeight,children:(0,o.jsx)(u.Spinner,{})}),Boolean(t?.length)&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(h.CustomScrollView,{className:v.default.scrollHeight,boxRef:k,children:[t?.map((e=>(0,o.jsx)(y.PlaylistPopoverItem,{playlist:e,handleToggleVideoAdded:i},e.id))),P&&(0,o.jsx)(u.Spinner,{})]})}),(0,o.jsx)(p.Button,{onClick:w,mode:"tertiary",appearance:"accent-invariable",stretched:!0,align:"left",before:(0,o.jsx)(g.Icon20Add,{}),size:"m","data-testid":"create_playlist_from_video_card_checkbox_button",children:(0,_.getLang)("video_create_new_playlist_btn")})]}),...M,children:C})}},245321:(e,t,i)=>{i.d(t,{PlaylistPopoverItem:()=>h});var o=i(474848),s=i(296540),r=i(944048),a=i(578392),n=i(412888),d=i(866467),l=i(562791),c=i(8520),u=i(635172);const h=(0,s.memo)((({playlist:e,handleToggleVideoAdded:t})=>(0,o.jsx)(r.Checkbox,{checked:e.containsVideo,onChange:()=>t(e.containsVideo,e.id),titleAfter:e.isPrivate&&(0,o.jsx)(a.TextTooltip,{placement:"top",appearance:"black",offsetByCrossAxis:-56,offsetByMainAxis:4,text:(0,d.getLang)("video_playlist_private_tooltip"),children:(0,o.jsx)(l.Icon16LockOutline,{className:u.default.playlistPrivateIcon})}),children:(0,o.jsx)(n.TextClamp,{lines:1,children:(0,c.decodeHTMLEntities)(e.title)})},e.id)))},574479:(e,t,i)=>{i.d(t,{PlaylistPopover:()=>o.PlaylistPopover});var o=i(348904)},296761:(e,t,i)=>{i.d(t,{useOwner:()=>o.useOwner,usePlaylists:()=>s.usePlaylists,useVideoMenuItems:()=>r.useVideoMenuItems});var o=i(345611),s=i(918847),r=i(601362)},345611:(e,t,i)=>{i.d(t,{useOwner:()=>o.useOwner});var o=i(856289)},918847:(e,t,i)=>{i.d(t,{usePlaylists:()=>s});var o=i(293721);const s=e=>(0,o.useStoreMap)(e,(e=>Object.values(e).filter((e=>Boolean(e)))))},601362:(e,t,i)=>{i.d(t,{useVideoMenuItems:()=>B});var o=i(474848),s=i(296540),r=i(629775),a=i(829713),n=i(426222),d=i(370),l=i(289150),c=i(549318),u=i(490363),h=i(485749),p=i(223173),_=i(490639),v=i(917919),g=i(405816),m=i(8520),y=i(314799),b=i(632731),C=i(538522),f=i(866467),I=i(451549),S=i(432465),P=i(867317),w=i(575312),A=i(423151),L=i(950885),E=i(768797),M=i(29593),F=i(540462),k=i(841315),x=i(636826),V=i(856289),O=i(609152),T=i(317216),j=i(314309),R=i(231450);const D=({onClick:e,...t})=>{const i={...t};return e&&(i.onClick=t=>(0,M.ensureEventPropagationStopping)(t,e)),i},B=({video:e,handlers:t,playlistOwnerId:i=window.vk.id,canUserAddToGroupPlaylists:M=!1,playlistId:B})=>{const{onDeleteFromPlaylist:N,onDeleteVideo:U,onAddToGroup:G,onExportVideo:H,onToggleFave:z,onComplaintSuccess:Y}=t||{},W=(0,y.useHelpHint)(b.AvailableHelpHints.ACCOUNT_HINT_VIDEO_WATCH_LATER_ACTION),{isWatchLaterTooltipViewed:$,handleWatchLaterTooltipClose:K}=(0,O.useWatchLaterTooltipViewed)(),[q,Q]=(0,s.useState)(!1),X=(0,k.getVideoUrl)(e),J=()=>{(0,m.copyTextToClipboard)(`https://${window.location.host}${X}`),(0,R.getFromType)("search")&&j.searchStatsCollector.logEvent({track_code:e.track_code,action:T.SearchClickActionMap.COPY_LINK_OUT,type:T.EventItemType.VIDEO}),(0,S.showSnackbar)({text:(0,f.getLang)("video_copied_to_clipboard"),before:{content:(0,o.jsx)(r.Icon20CheckAlt,{})}})},Z=()=>{(0,R.getFromType)("search")&&j.searchStatsCollector.logEvent({track_code:e.track_code,action:T.SearchClickActionMap.SHARE_OUT,type:T.EventItemType.VIDEO}),P.Likes.share(`video${(0,C.joinRawId)({ownerId:e.owner_id,itemId:e.id})}`)},ee=t=>{(0,L.sendReportWithCallback)(t,e,Y)},te=t=>{(0,L.editVideo)(t,{owner_id:e.owner_id,id:e.id})},ie=()=>{(0,R.getFromType)("search")&&j.searchStatsCollector.logEvent({track_code:e.track_code,action:T.SearchClickActionMap.ADD_TO_ME_OUT,type:T.EventItemType.VIDEO}),(0,F.partConfigEnabled)("video_add_to_playlist_modal_mobx_move")?(0,A.showPlaylistModalWidget)({ownerId:i,videoId:e.id,isGroupOwner:M,videoOwnerId:e.owner_id,playlistId:B}):(0,w.showPlaylistsModal)({ownerId:i,videoPlaylistsModalService:E.videoPlaylistsModalService,video:e,isGroupOwner:M})};return{menuItems:(0,s.useMemo)((()=>{const t=[];if((0,I.isVKUserAnonymous)())return[];e.can_edit&&t.push({before:(0,o.jsx)(a.Icon20WriteOutline,{}),children:(0,f.getLang)("video_edit"),onClick:te,"data-testid":"video_edit_button"});const i=(0,F.partConfigEnabled)("video_bookmarks_renaming_to_watch_later"),s=(e,t)=>i&&W&&!$?{before:(0,o.jsx)(V.MenuHelpHintTooltip,{helpHint:W,placement:"top-start",maxWidth:262,onClose:K,children:e}),children:t,"data-testid":"video_card_watch_later_button"}:{before:e,children:t,onClick:z,"data-testid":"video_card_favorite_button"};z&&e.is_favorite?t.push(i?s((0,o.jsx)(n.Icon20ClockOutline,{}),(0,f.getLang)("video_remove_from_watch_later")):s((0,o.jsx)(d.Icon20FavoriteOutline,{}),(0,f.getLang)("global_remove_from_bookmarks"))):z&&e.can_add_to_faves&&t.push(i?s((0,o.jsx)(n.Icon20ClockOutline,{}),(0,f.getLang)("video_catalog_showcase_section_my_watch_later_title")):s((0,o.jsx)(d.Icon20FavoriteOutline,{}),(0,f.getLang)("global_add_to_bookmarks"))),3===e.can_download&&"interactive"!==e.type&&t.push({before:(0,o.jsx)(l.Icon20DownloadOutline,{}),children:(0,f.getLang)("video_download_video_from_modal"),onClick:t=>{t.stopPropagation(),(0,x.downloadVideo)({oid:String(e.owner_id),vid:String(e.id),title:String(e.title),type:"video"})},"data-testid":"video_download_button"}),G&&t.push({before:(0,o.jsx)(c.Icon20Add,{}),children:(0,f.getLang)("video_add_to_group"),onClick:G,"data-testid":"video_card_add_to_group_button"}),e.can_add&&t.push({before:(0,o.jsx)(u.Icon20ListPlusOutline,{}),children:(0,f.getLang)("video_move_to_playlist"),onClick:ie,"data-testid":"video_move_to_playlist"}),t.push({before:(0,o.jsx)(h.Icon20CopyOutline,{}),children:(0,f.getLang)("video_copy_video_link"),onClick:J,"data-testid":"video_card_copy_video_link_button"}),H&&t.push({before:(0,o.jsx)(l.Icon20DownloadOutline,{}),children:(0,f.getLang)("video_export_action"),onClick:H,"data-testid":"video_card_export_button"}),0!==e?.restriction?.can_play&&t.push({before:(0,o.jsx)(p.Icon20ShareOutline,{}),children:(0,f.getLang)("video_share_with_friends"),onClick:Z,"data-testid":"video_card_share_button"}),N&&t.push({before:(0,o.jsx)(_.Icon20DeleteOutline,{}),children:(0,f.getLang)("video_delete_from_playlist"),onClick:N,"data-testid":"video_card_delete_from_playlist_button"}),U&&t.push({before:(0,o.jsx)(v.Icon20Cancel,{}),children:(0,f.getLang)("video_delete_video"),onClick:U,"data-testid":"video_card_delete_button"});const r=(0,F.partConfigEnabled)("vk_live_integration")&&!!e.vk_live_channel_url&&(0,V.isLiveVideo)(e);return e.owner_id!==window.vk.id&&!r&&t.push({before:(0,o.jsx)(g.Icon20ReportOutline,{}),children:(0,f.getLang)("global_report_spam"),onClick:ee,"data-testid":"video_card_complain_button"}),t.map(D)}),[q]),onMenuPopoverShownChanged:e=>{Q(e)}}}},196241:(e,t,i)=>{i.d(t,{createPlaylistPopoverService:()=>h});var o=i(29593),s=i(986125),r=i(178317),a=i(530040),n=i(224191),d=i(32489),l=i(377850),c=i(856289),u=i(838658);const h=(e,t)=>{const i=(0,s.createVideoGetAlbumsByVideoFx)({domain:e}),h=e.createEvent(),p=(0,s.createVideoAddToAlbumFx)({domain:e}),_=(0,s.createVideoRemoveFromAlbumFx)({domain:e}),v=e.createStore({}),g=e.createEffect((({controller:e,isAdded:t,query:i})=>{const o={controller:e,query:i};return t?_(o):p(o)})),m=e.createStore(t),y=e.createStore([]),b=e.createEvent(),C=(0,d.restore)(b,{}),f=e.createEvent(),I=e.createEvent(),S=e.createEvent(),P=e.createEvent(),w=(0,r.createEntitiesVideoAlbumService)({domain:e}),A=(0,a.createListsVideosAlbumsService)({domain:e,entitiesVideoAlbumService:w}),{videoCardEntities:L,addEntity:E,updateEntity:M}=(0,u.createVideoCardEntitiesService)({domain:e}),{$entitiesVideoAlbums:F}=w,{resetVideosAlbumsEvent:k,$videosAlbumsFullyLoaded:x}=A,V=(0,d.combine)(x,m,((e,t)=>Boolean(e[t])));F.reset(h);const O=e.createEvent(),T=e.createEvent(),j=(0,d.restore)(T,null).reset(h),R=e.createEvent(),D=(0,d.restore)(R,null).reset(h);(0,d.sample)({clock:O,target:E});const B=(0,d.combine)(C,j,((e,t)=>!!t||Object.values(e).some((e=>e&&e.containsVideo)))),N=(0,d.combine)(A.fetchVideosAlbumsFx.pending,i.pending,((e,t)=>e||t)),U=(0,l.combineEvents)({events:{albumsByVideo:i.done,albums:A.fetchVideosAlbumsFx.done},reset:h});return(0,d.sample)({clock:U,source:{videoEntities:F,ownerId:m},fn:({videoEntities:e,ownerId:t},{albumsByVideo:i})=>(0,o.mapAlbumsWithInclusionsToPlaylists)({albumsByVideo:i.result,albums:e,ownerId:t||0}),target:b}),(0,d.sample)({clock:U,fn:({albumsByVideo:{result:e}})=>e.includes(c.MY_VIDEO_ALBUM_ID),target:T}),(0,d.sample)({clock:f,source:m,filter:e=>Boolean(e),fn:e=>({query:{owner_id:e||0,extended:1},controller:new AbortController,entityKey:e||0}),target:A.fetchVideosAlbumsFx}),(0,d.sample)({clock:I,source:m,fn:e=>({entityKey:e,count:50}),target:A.fetchMoreVideosAlbumsEvent}),(0,d.sample)({clock:A.fetchVideosAlbumsFx.done,source:{ownerId:m,videoEntities:F,albumsByVideo:y,playlistEntityStore:C},filter:(e,{params:t})=>Boolean(t.query.offset),fn:({ownerId:e,albumsByVideo:t,playlistEntityStore:i},{result:s})=>{const r=(0,n.mapToEntity)({},s.items,(({id:t})=>(0,o.getFullAlbumId)({albumId:t,ownerId:e})));return{...i,...(0,o.mapAlbumsWithInclusionsToPlaylists)({albumsByVideo:t,albums:r,ownerId:e||0})}},target:b}),(0,d.sample)({clock:f,source:{videoCardEntities:L,$ownerId:m},filter:({videoCardEntities:e},t)=>!!e[t],fn:({videoCardEntities:e,$ownerId:t},i)=>{const{vid:o,oid:s}=e[i];return{query:{video_id:o,owner_id:s,target_id:t},controller:new AbortController}},target:i}),(0,d.sample)({clock:i.doneData,target:y}),(0,d.sample)({clock:f,target:R}),(0,d.sample)({clock:k,fn:()=>({}),target:C}),(0,d.sample)({clock:S,source:{videoCardEntities:L,$ownerId:m},filter:({videoCardEntities:e},{key:t,videoOwnerId:i,videoId:o})=>Boolean(e[t]||i||o),fn:({videoCardEntities:e,$ownerId:t},{key:i,album_id:s,isAdded:r,videoOwnerId:a,videoId:n})=>{const d=(0,o.getFullAlbumId)({albumId:s,ownerId:t}),{vid:l=0,oid:c=0}=e[i]?e[i]:{oid:a,vid:n};return{controller:new AbortController,fullId:d,query:{target_id:t,album_id:s,video_id:l,owner_id:c},isAdded:r}},target:g}),(0,d.sample)({clock:P,fn:({ownerId:e,id:t,videoId:i,videoOwnerId:s})=>{const r=(0,o.getFullAlbumId)({albumId:t,ownerId:e});return{controller:new AbortController,fullId:r,query:{target_id:e,album_id:t,video_id:i||0,owner_id:s||0},isAdded:!1}},target:g}),(0,d.sample)({clock:g,source:C,filter:(e,t)=>!(0,o.isMyVideoAlbum)(t.query.album_id),fn:(e,{query:t,isAdded:i})=>{const s={...e},r=(0,o.getFullAlbumId)({albumId:t.album_id,ownerId:t.target_id}),a=e[r];return a&&(s[r]={...a,containsVideo:!i}),s},target:b}),(0,d.sample)({clock:g,filter:({query:{album_id:e}})=>(0,o.isMyVideoAlbum)(e),fn:({isAdded:e})=>!e,target:T}),(0,d.sample)({clock:B,source:D,filter:e=>!!e,fn:(e,t)=>({key:e,updates:{added:t}}),target:M}),(0,d.sample)({clock:g,source:v,fn:(e,{controller:t,fullId:i})=>(e[i]?.abort(),{...e,[i]:t}),target:v}),(0,d.sample)({clock:h,source:i,fn:({controller:e})=>{e?.abort()}}),(0,d.sample)({clock:h,fn:()=>{},target:k}),(0,d.sample)({clock:[g.done,g.fail],source:C,filter:(e,t)=>("error"in t||!t.result)&&!(0,o.isMyVideoAlbum)(t.params.query.album_id),fn:(e,{params:{query:t,isAdded:i}})=>{const s={...e},r=(0,o.getFullAlbumId)({albumId:t.album_id,ownerId:t.owner_id}),a=e[r];return a&&(s[r]={...a,containsVideo:i}),s},target:b}),(0,d.sample)({clock:[g.done,g.fail],filter:e=>("error"in e||!e.result)&&(0,o.isMyVideoAlbum)(e.params.query.album_id),fn:({params:{isAdded:e}})=>e,target:T}),(0,d.sample)({clock:S,source:{playlists:C,ownerId:m},fn:({playlists:e,ownerId:t},{isAdded:i,album_id:s,albumTitle:r})=>{const a=(0,o.getFullAlbumId)({albumId:s,ownerId:t});(0,o.showPlaylistActionSnackbar)({ownerId:t||0,playlistId:s,playlistTitle:r||e[a]?.title,added:!i})}}),(0,d.sample)({clock:P,filter:({videoId:e,videoOwnerId:t})=>Boolean(e&&t),fn:({videoId:e,videoOwnerId:t})=>({key:(0,o.getVideoCardKey)(t||0,e||0),updates:{added:!0}}),target:M}),(0,d.sample)({clock:P,source:m,fn:(e,{id:t,title:i})=>{(0,o.showPlaylistActionSnackbar)({ownerId:e||0,playlistId:t,playlistTitle:i,added:!0})}}),{addVideoCardEntity:O,videoCardEntities:L,togglePlaylistAddedEvent:S,fetchPlaylistsEvent:f,fetchMorePlaylistsEvent:I,resetVideosAlbumsEvent:k,$ownerId:m,$playlistsLoading:N,$playlistsFullyLoaded:V,$curVideoAddedToMy:j,clearStoreEvent:h,$playlistEntityStore:C,createPlaylistEvent:P}}},838658:(e,t,i)=>{i.d(t,{createVideoCardEntitiesService:()=>a});var o=i(32489),s=i(29593),r=i(679005);const a=({domain:e})=>{const t=e.createEvent(),i=(0,o.restore)(t,{}),a=e.createEvent(),n=e.createEvent();return(0,o.sample)({clock:a,source:i,fn:(e,t)=>{const i=(0,s.getVideoCardKey)(t.oid,t.vid);return{...e,[i]:t}},target:t}),(0,o.sample)({clock:n,source:i,fn:(e,{key:t,updates:i})=>{const o={...e[t],...i};return"object"==typeof(s=o)&&null!==s&&"vid"in s&&"oid"in s&&"added"in s?(0,r.produce)(e,(e=>{e[t]=o})):e;var s},target:t}),{addEntity:a,updateEntity:n,videoCardEntities:i}}},675307:(e,t,i)=>{i.d(t,{ensurePlaylistPopoverService:()=>r});var o=i(196241),s=i(32489);const r=(0,i(558137).makeSharedState)("global/video/playlists/popover",(()=>(0,o.createPlaylistPopoverService)((0,s.createDomain)("global/video/playlists/popover"),window.vk.id)),{version:1})},687320:(e,t,i)=>{i.d(t,{ensurePlaylistPopoverService:()=>o.ensurePlaylistPopoverService});var o=i(675307);i(196241),i(838658)},598865:(e,t,i)=>{i.d(t,{CATALOG_AVATAR_SIZE_L:()=>o.CATALOG_AVATAR_SIZE_L,CATALOG_AVATAR_SIZE_SM:()=>o.CATALOG_AVATAR_SIZE_SM,Catalog:()=>o.Catalog,CatalogBlockDataType:()=>o.CatalogBlockDataType,CatalogBlockLayoutName:()=>o.CatalogBlockLayoutName,CatalogDesktopVideoProvider:()=>o.CatalogDesktopVideoProvider,CatalogGroupsProvider:()=>o.CatalogGroupsProvider,CatalogHandlersProvider:()=>o.CatalogHandlersProvider,CatalogLogProvider:()=>o.CatalogLogProvider,CatalogSearchProvider:()=>o.CatalogSearchProvider,CatalogType:()=>o.CatalogType,FAVORITE_SOURCES:()=>o.FAVORITE_SOURCES,GROUP_REDESIGN_SLIDER_SCROLL:()=>o.GROUP_REDESIGN_SLIDER_SCROLL,MARKET_ITEM_SLIDER_SCROLL:()=>o.MARKET_ITEM_SLIDER_SCROLL,SLIDER_SCROLL:()=>o.SLIDER_SCROLL,appCatalogService:()=>o.appCatalogService,createAppCatalogService:()=>o.createAppCatalogService,extractItemsIds:()=>o.extractItemsIds,getUrlWithTrackCode:()=>o.getUrlWithTrackCode,useCatalogCommonFriends:()=>o.useCatalogCommonFriends,useRefLogView:()=>o.useRefLogView,videoLayoutResolver:()=>o.videoLayoutResolver,videoListShowcaseLayoutResolver:()=>o.videoListShowcaseLayoutResolver,withCatalogStoreOwner:()=>o.withCatalogStoreOwner});var o=i(174269)},64339:(e,t,i)=>{i.d(t,{VideoShowcaseFaveEvents:()=>o.VideoShowcaseFaveEvents});var o=i(506011)},140489:(e,t,i)=>{i.d(t,{getScreenTimespentCollector:()=>o.getScreenTimespentCollector,tmrSendTimespentEvent:()=>o.tmrSendTimespentEvent});var o=i(251703)},142075:(e,t,i)=>{i.d(t,{usePageBlockOffset:()=>o.usePageBlockOffset});var o=i(907678)},276706:(e,t,i)=>{i.d(t,{browser:()=>o.browser});var o=i(575753)},537603:(e,t,i)=>{i.d(t,{ActionStatCollector:()=>o.ActionStatCollector,ClickStatCollector:()=>o.ClickStatCollector,EventScreens:()=>o.EventScreens,ProductionStatCollector:()=>o.ProductionStatCollector,RegistrationFieldItemNames:()=>o.RegistrationFieldItemNames,RegistrationItemEventTypes:()=>o.RegistrationItemEventTypes,RegistrationItemFlowSource:()=>o.RegistrationItemFlowSource,RegistrationItemStatCollector:()=>o.RegistrationItemStatCollector,VideoSubscriptionsSelectCreatorsClickEventTypes:()=>o.VideoSubscriptionsSelectCreatorsClickEventTypes,clipDescriptionStatsCollector:()=>o.clipDescriptionStatsCollector,clipDownloadStatsCollector:()=>o.clipDownloadStatsCollector,clipSubscribeStatsCollector:()=>o.clipSubscribeStatsCollector,getScreen:()=>o.getScreen,marketingTransitionItemStat:()=>o.marketingTransitionItemStat,searchStatsCollector:()=>o.searchStatsCollector,searchViewStatCollector:()=>o.searchViewStatCollector,setScreen:()=>o.setScreen,videoCreateClipStatsCollector:()=>o.videoCreateClipStatsCollector,videoPublishStatsCollector:()=>o.videoPublishStatsCollector,videoSubscriptionsSelectCreatorsClickStatsCollector:()=>o.videoSubscriptionsSelectCreatorsClickStatsCollector,videoSubscriptionsSelectCreatorsNavCollector:()=>o.videoSubscriptionsSelectCreatorsNavCollector});var o=i(314309)},695305:(e,t,i)=>{i.d(t,{getCurrentScreen:()=>o.getCurrentScreen,setCurrentScreen:()=>o.setCurrentScreen});var o=i(471180)},148156:(e,t,i)=>{i.d(t,{VideoPlayerWidget:()=>o.VideoPlayerWidget});var o=i(123164)},853349:(e,t,i)=>{i.d(t,{MY_VIDEO_ALBUM_ID:()=>o.MY_VIDEO_ALBUM_ID,UPLOADED_ALBUM_ID:()=>o.UPLOADED_ALBUM_ID,getFormattedFullVideoViews:()=>o.getFormattedFullVideoViews,getFormattedUpdatedTime:()=>o.getFormattedUpdatedTime,getFormattedVideoDate:()=>o.getFormattedVideoDate,getOwnerVideosPageBasePath:()=>o.getOwnerVideosPageBasePath,getVideoPrefix:()=>o.getVideoPrefix,isPrivacyLocked:()=>o.isPrivacyLocked,isVideoStandalone:()=>o.isVideoStandalone,mapArtistToVideoCardOwner:()=>o.mapArtistToVideoCardOwner,mapUserOrGroupToVideoCardOwner:()=>o.mapUserOrGroupToVideoCardOwner,mapVideoToVideoCardItem:()=>o.mapVideoToVideoCardItem});var o=i(856289)},213818:(e,t,i)=>{i.d(t,{getSubscriptionsPageServices:()=>o.getSubscriptionsPageServices});var o=i(58697)},375568:(e,t,i)=>{i.d(t,{CatalogServiceAdapter:()=>o.CatalogServiceAdapter});var o=i(768797)},912499:(e,t,i)=>{i.d(t,{getPrivacyLabel:()=>o.getPrivacyLabel,getValidVideoFiles:()=>o.getValidVideoFiles,shouldDisableDate:()=>o.shouldDisableDate});var o=i(72966)},666082:(e,t,i)=>{i.d(t,{showBox:()=>o.showBox,showFastBox:()=>o.showFastBox});var o=i(270959)},606028:(e,t,i)=>{i.d(t,{Likes:()=>o.Likes});var o=i(867317)},901634:(e,t,i)=>{i.d(t,{handleOrdMiniappOpen:()=>o.handleOrdMiniappOpen});var o=i(60411)},854140:(e,t,i)=>{i.d(t,{showReportForm:()=>o.showReportForm});var o=i(65759)},749629:(e,t,i)=>{i.d(t,{Q_1080P:()=>s,VIDEO_FETCH_FIELDS:()=>o.SHORT_VIDEO_ALL_FETCH_FIELDS});var o=i(110343);const s="1080p"},521344:(e,t,i)=>{i.d(t,{ClipRestrictionModel:()=>o.ClipRestrictionModel,ClipsFeedModel:()=>o.ClipsFeedModel,ClipsPlayer:()=>r.ClipsPlayer,ClipsPlayerStatusModel:()=>o.ClipsPlayerStatusModel,Q_1080P:()=>s.Q_1080P,UPLOAD_AUDIO_RIGHTS_LINK:()=>a.UPLOAD_AUDIO_RIGHTS_LINK,UploadAudioSearchModel:()=>a.UploadAudioSearchModel,VIDEO_FETCH_FIELDS:()=>s.VIDEO_FETCH_FIELDS,createLink:()=>d.createLink,getClipCover:()=>n.getClipCover,isLockedVideo:()=>n.isLockedVideo});var o=i(270383),s=i(749629),r=i(686106),a=i(41128),n=i(689110),d=i(518235)},106311:(e,t,i)=>{var o,s;i.d(t,{ClipsPlayerStatsRef:()=>s,ClipsStatEventType:()=>o}),function(e){e.VIDEO="videoEvent",e.PLAY="playEvent",e.EFFECTIVE_DAILY_ACTIVE_USER="effectiveDailyActiveUserEvent",e.SHORT_VIDEO_VIEW="shortVideoViewEvent",e.SHORT_VIDEO_PUBLISH="shortVideoPublishEvent"}(o||(o={})),function(e){e.TOP="clips_top",e.SUBSCRIPTIONS="clips_subscription",e.OWNER="clips_owner",e.VIDEO="video"}(s||(s={}))},675411:(e,t,i)=>{i.d(t,{usePlayerStats:()=>o.usePlayerStats});var o=i(213301)},213301:(e,t,i)=>{i.d(t,{usePlayerStats:()=>o.usePlayerStats});var o=i(422416)},422416:(e,t,i)=>{i.d(t,{usePlayerStats:()=>d});var o=i(296540),s=i(106311),r=i(636189),a=i(743893),n=i(683495);function d({isPlaying:e,isMuted:t,video:i,statsRef:d},l,c="carousel"){const u=d===s.ClipsPlayerStatsRef.OWNER&&i?String(i.data.owner_id):"",h=(0,o.useRef)([]),{onVideoCurQualityChanged:p,onVideoDurationChanged:_,onVideoFormatChanged:v,onVideoBitrateChanged:g,videoMetaRef:m}=(0,a.useVideoMetaRef)(i?.rawId),{onStalledChanged:y,videoStalledRef:b}=(0,n.useVideoStalledRef)(i?.rawId),C=(0,o.useRef)([]),f=(0,o.useRef)(!1);(0,o.useEffect)((()=>()=>{C.current=[],f.current=!1}),[i?.rawId]);const I=(0,o.useCallback)((()=>i&&m.current&&!f.current?{autoplay:1,bitrate:m.current.videoBitrate??0,context:u,e:"video_play",eventType:s.ClipsStatEventType.PLAY,media_provider:m.current.videoFormat,ov_id:i.data.ov_id??"",player_type:c,quality:"auto",ref:d,speed:"normal",stall_count:b.current?.stalledCount??0,stall_duration:b.current?.stalledDuration??0,track_code:i.data.track_code??"",ts:Math.trunc(Date.now()/1e3),video_id:i.rawId,volume:t?0:100}:null),[i,t,d]),S=(0,o.useCallback)((()=>i?{context:u,e:"video_event",eventType:s.ClipsStatEventType.VIDEO,ov_id:i.data.ov_id??"",ref:d,track_code:i.data.track_code??"",ts:Math.trunc(Date.now()/1e3),video_id:i.rawId}:null),[i,d]),P=(0,o.useCallback)((t=>{const i=I();if(i&&e&&void 0!==t&&void 0!==m.current?.videoDuration){const e=(0,r.secondsPositionToTrackPositions)(t,m.current.videoDuration);if(!e.length||e.length===C.current.length)return;const o=e.filter((e=>!C.current.includes(e)));o.length&&(l([...h.current,...o.map((e=>({...i,position:e,position_sec:Math.trunc(t)})))]),h.current=[]),o.includes("100")&&l([{eventType:s.ClipsStatEventType.SHORT_VIDEO_VIEW}]),C.current=[...e]}}),[I,e]),w=(0,o.useCallback)((e=>{const t=S();t&&h.current.push({...t,event:"first_bytes",value:e})}),[S]),A=(0,o.useCallback)((e=>{const t=S();t&&h.current.push({...t,event:"first_frame",value:e})}),[S]),L=(0,o.useCallback)((()=>{m.current?.videoDuration&&P(m.current?.videoDuration),f.current=!0}),[P]);return{onVideoCurQualityChanged:p,onStalledChanged:y,onVideoFormatChanged:v,onVideoBitrateChanged:g,onVideoDurationChanged:_,onVideoPositionChanged:P,onEnded:L,onFirstBytes:w,onFirstFrame:A}}},743893:(e,t,i)=>{i.d(t,{useVideoMetaRef:()=>s});var o=i(296540);function s(e){const t=(0,o.useRef)({}),i=(0,o.useCallback)((e=>{t.current.curVideoQuality=e}),[]),s=(0,o.useCallback)((e=>{t.current.videoDuration=e}),[]),r=(0,o.useCallback)((e=>{t.current.videoFormat=e}),[]),a=(0,o.useCallback)((e=>{t.current.videoBitrate=e?1e3*e:void 0}),[]);return(0,o.useEffect)((()=>()=>{t.current={}}),[e]),{onVideoCurQualityChanged:i,onVideoDurationChanged:s,onVideoFormatChanged:r,onVideoBitrateChanged:a,videoMetaRef:t}}},683495:(e,t,i)=>{i.d(t,{useVideoStalledRef:()=>s});var o=i(296540);function s(e){const t=(0,o.useRef)({stalledCount:0,stalledDuration:0}),i=(0,o.useRef)(null),s=(0,o.useCallback)((e=>{e?(t.current.stalledCount+=1,i.current=setInterval((()=>{t.current.stalledDuration+=1}),1e3)):i.current&&clearInterval(i.current)}),[]);return(0,o.useEffect)((()=>()=>{t.current={stalledCount:0,stalledDuration:0},i.current&&clearInterval(i.current)}),[e]),{onStalledChanged:s,videoStalledRef:t}}},927424:(e,t,i)=>{i.d(t,{ClipsPlayerStatsRef:()=>r.ClipsPlayerStatsRef,ClipsPlayingFullScreenStatsModel:()=>s.ClipsPlayingFullScreenStatsModel,ClipsPlayingStatsModel:()=>s.ClipsPlayingStatsModel,ClipsStatsService:()=>s.ClipsStatsService,usePlayerStats:()=>o.usePlayerStats});var o=i(675411),s=i(7151),r=i(106311)},688377:(e,t,i)=>{i.d(t,{ClipsPlayingFullScreenStatsModel:()=>n});var o=i(331635),s=i(327813),r=i(132028),a=i(555734);class n{startTimespent(){this.timespentCollector.start(this.refSymbol,a.StatTimespentType.SHORT_VIDEO_PLAYING_FULL_SCREEN)}endTimespent(){this.timespentCollector.end(this.refSymbol,a.StatTimespentType.SHORT_VIDEO_PLAYING_FULL_SCREEN)}constructor(e){this.timespentCollector=e,this.refSymbol=Symbol(),(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.ClipsTimespentService?Object:a.ClipsTimespentService])],n)},230432:(e,t,i)=>{i.d(t,{ClipsPlayingStatsModel:()=>n});var o=i(331635),s=i(327813),r=i(132028),a=i(555734);class n{startTimespent(){this.timespentCollector.start(this.refSymbol,a.StatTimespentType.SHORT_VIDEO_PLAYING)}endTimespent(){this.timespentCollector.end(this.refSymbol,a.StatTimespentType.SHORT_VIDEO_PLAYING)}constructor(e){this.timespentCollector=e,this.refSymbol=Symbol(),(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.ClipsTimespentService?Object:a.ClipsTimespentService])],n)},765094:(e,t,i)=>{i.d(t,{ClipsStatsService:()=>u});var o,s=i(331635),r=i(327813),a=i(995340),n=i(132028),d=i(140489),l=i(106311);!function(e){e[e.EFFECTIVE_DAILY_ACTIVE_USER=4]="EFFECTIVE_DAILY_ACTIVE_USER",e[e.CLIP_VIEW=18]="CLIP_VIEW",e[e.CLIP_PUBLISH=19]="CLIP_PUBLISH"}(o||(o={}));const c={[l.ClipsStatEventType.EFFECTIVE_DAILY_ACTIVE_USER]:4,[l.ClipsStatEventType.SHORT_VIDEO_PUBLISH]:19,[l.ClipsStatEventType.SHORT_VIDEO_VIEW]:18};class u{trackEvents(e){const t=e.filter((({eventType:e})=>[l.ClipsStatEventType.PLAY,l.ClipsStatEventType.VIDEO].includes(e)));t.length&&this.apiTrackEvents(t);const i=e.filter((({eventType:e})=>[l.ClipsStatEventType.SHORT_VIDEO_VIEW,l.ClipsStatEventType.SHORT_VIDEO_PUBLISH,l.ClipsStatEventType.EFFECTIVE_DAILY_ACTIVE_USER].includes(e)));i.length&&this.myTrackEvents(i)}apiTrackEvents(e){return this.statsApi.trackEvents({events:JSON.stringify(e)})}myTrackEvents(e){for(const t of e)(0,d.tmrSendTimespentEvent)(c[t.eventType])}constructor(e){this.statsApi=e,(0,r.makeAutoObservable)(this)}}u=(0,s.__decorate)([n.scope.container(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[void 0===a.StatsApi?Object:a.StatsApi])],u)},555734:(e,t,i)=>{i.d(t,{ClipsTimespentService:()=>l,StatTimespentType:()=>o});var o,s,r=i(331635),a=i(327813),n=i(132028),d=i(140489);!function(e){e.SHORT_VIDEO_PLAYING="shortVideoPlayingTimespent",e.SHORT_VIDEO_SECTION="shortVideoSectionTimespent",e.SHORT_VIDEO_PLAYING_FULL_SCREEN="shortVideoPlayingFullScreenTimespent"}(o||(o={})),function(e){e[e.CLIP_VIEW=96]="CLIP_VIEW",e[e.CLIP_VIEW_FULL_SCREEN=97]="CLIP_VIEW_FULL_SCREEN",e[e.CLIP_SECTION=98]="CLIP_SECTION"}(s||(s={}));class l{start(e,t){switch(t){case"shortVideoPlayingTimespent":if(this.playingSet.has(e))break;this.playingSet.add(e),1===this.playingSet.size&&this.screenTimespentCollector.start(96);break;case"shortVideoPlayingFullScreenTimespent":if(this.playingSet.has(e))break;this.playingSet.add(e),1===this.playingSet.size&&(this.screenTimespentCollector.start(97),this.screenTimespentCollector.start(96));break;case"shortVideoSectionTimespent":this.screenTimespentCollector.start(98)}}end(e,t){switch(t){case"shortVideoPlayingTimespent":if(!this.playingSet.has(e))break;this.playingSet.delete(e),0===this.playingSet.size&&this.screenTimespentCollector.finish(96);break;case"shortVideoPlayingFullScreenTimespent":if(!this.playingSet.has(e))break;this.playingSet.delete(e),0===this.playingSet.size&&(this.screenTimespentCollector.finish(97),this.screenTimespentCollector.finish(96));break;case"shortVideoSectionTimespent":this.screenTimespentCollector.finish(98)}}constructor(){this.playingSet=new Set,this.screenTimespentCollector=(0,d.getScreenTimespentCollector)(),(0,a.makeAutoObservable)(this)}}l=(0,r.__decorate)([n.scope.container(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[])],l)},7151:(e,t,i)=>{i.d(t,{ClipsPlayingFullScreenStatsModel:()=>s.ClipsPlayingFullScreenStatsModel,ClipsPlayingStatsModel:()=>o.ClipsPlayingStatsModel,ClipsStatsService:()=>r.ClipsStatsService});var o=i(230432),s=i(688377),r=i(765094)},636189:(e,t,i)=>{function o(e,t){const i=e/t*100,o=[];return 0===e&&o.push("start"),e>=3&&o.push("3s"),e>=10&&o.push("10s"),i>=25&&o.push("25"),i>=50&&o.push("50"),i>=75&&o.push("75"),i>=95&&o.push("95"),i>=100&&o.push("100"),o}i.d(t,{secondsPositionToTrackPositions:()=>o})},536805:(e,t,i)=>{i.d(t,{UPLOAD_AUDIO_RIGHTS_LINK:()=>o,UPLOAD_MAX_VIDEO_SIZE:()=>s});const o="/@vkclips-copyrights-description",s=8589934592},41128:(e,t,i)=>{i.d(t,{UPLOAD_AUDIO_RIGHTS_LINK:()=>s.UPLOAD_AUDIO_RIGHTS_LINK,UPLOAD_MAX_VIDEO_SIZE:()=>s.UPLOAD_MAX_VIDEO_SIZE,UploadAudioSearchModel:()=>o.UploadAudioSearchModel});var o=i(81319),s=i(536805)},726401:(e,t,i)=>{i.d(t,{UploadAudioSearchModel:()=>d});var o=i(331635),s=i(327813),r=i(543116),a=i(132028),n=i(8520);class d{[a.init](){return this.audioClipsList.fetch({})}get audios(){return this.isSearch?this.audioClipsSearchList.items:this.audioClipsList.items}get isLoading(){return this.audioClipsSearchList.isLoading||this.audioClipsList.isLoading}resetQuery(){this.isSearch=!1,this.audioClipsSearchList.reset()}constructor(e,t){this.audioClipsListsProvider=e,this.props=t,this.searchQuery="",this.isSearch=!1,this.searchAudio=e=>{this.searchQuery=e,this.searchAudioDebounced(e)},this.searchAudioDebounced=(0,n.debounce)((e=>{e?((0,s.runInAction)((()=>{this.isSearch=!0})),this.audioClipsSearchList.fetch({query:e})):this.resetQuery()}),200),(0,s.makeAutoObservable)(this),this.audioClipsList=this.audioClipsListsProvider.createSearchList(),this.audioClipsSearchList=this.audioClipsListsProvider.createSearchList()}}d=(0,o.__decorate)([a.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.AudioClipsListsProvider?Object:r.AudioClipsListsProvider,void 0===a.Props?Object:a.Props])],d)},81319:(e,t,i)=>{i.d(t,{UploadAudioSearchModel:()=>o.UploadAudioSearchModel});var o=i(726401)},825753:(e,t,i)=>{i.d(t,{compilePath:()=>s});var o=i(626627);function s(e){return function(e){const t=e.map((e=>{if("object"==typeof e)return new RegExp("^(?:".concat(e.pattern,")$"))}));return i=>{let o="";for(let s=0;s<e.length;s++){const r=e[s];if("string"==typeof r){o+=r;continue}const a=i?i[r.name]:void 0,n="?"===r.modifier||"*"===r.modifier,d="*"===r.modifier||"+"===r.modifier;if(Array.isArray(a)){if(!d)throw new TypeError('Expected "'.concat(r.name.toString(),'" to not repeat, but got an array'));if(0===a.length){if(n)continue;throw new TypeError('Expected "'.concat(r.name.toString(),'" to not be empty'))}for(let e=0;e<a.length;e++){const i=a[e];if(!t[s]?.test(i))throw new TypeError('Expected all "'.concat(r.name.toString(),'" to match "').concat(r.pattern,'", but got "').concat(i,'"'));o+=r.prefix+i+r.suffix}continue}if("string"==typeof a||"number"==typeof a){const e=String(a);if(!t[s]?.test(e))throw new TypeError('Expected "'.concat(r.name.toString(),'" to match "').concat(r.pattern,'", but got "').concat(e,'"'));o+=r.prefix+e+r.suffix;continue}if(n)continue;const l=d?"an array":"a string";throw new TypeError('Expected "'.concat(r.name.toString(),'" to be ').concat(l))}return o}}((0,o.parsePath)(e))}},631435:(e,t,i)=>{i.d(t,{createLink:()=>s});var o=i(825753);function s(e,t,i,s){const r=function(e,t){const i=e.split(".");let o,s=t;do{const t=i.shift();if(!(t in s))throw Error(`Unknown path's segment "${t}" for route key "${e}"`);o=s[t],"routes"in o&&(s=o.routes)}while(i.length>0);return o}(t,e).path,a=i?(0,o.compilePath)(r)(i):r,n=s?new URLSearchParams((d=s,Object.fromEntries(Object.entries(d).map((([e,t])=>[e,t.toString()]))))).toString():"";var d;return`${a}${n?"?"+n:""}`}},162482:(e,t,i)=>{i.d(t,{TypedParamNumber:()=>o});i(308011),i(626627);Symbol("query param string type");const o=Symbol("query param number type")},518235:(e,t,i)=>{i.d(t,{createLink:()=>o.createLink});var o=i(631435);i(162482),i(455805)},626627:(e,t,i)=>{function o(e){const t=function(e){const t=[];let i=0;for(;i<e.length;){const o=e[i];if("*"!==o&&"+"!==o&&"?"!==o)if("\\"!==o)if("{"!==o)if("}"!==o)if(":"!==o)if("("!==o)t.push({type:"CHAR",index:i,value:e[i++]});else{let o=1,s="",r=i+1;if("?"===e[r])throw new TypeError('Pattern cannot start with "?" at '.concat(r.toString()));for(;r<e.length;)if("\\"!==e[r]){if(")"===e[r]){if(o--,0===o){r++;break}}else if("("===e[r]&&(o++,"?"!==e[r+1]))throw new TypeError("Capturing groups are not allowed at ".concat(r.toString()));s+=e[r++]}else s+=e[r++]+e[r++];if(o)throw new TypeError("Unbalanced pattern at ".concat(i.toString()));if(!s)throw new TypeError("Missing pattern at ".concat(i.toString()));t.push({type:"PATTERN",index:i,value:s}),i=r}else{let o="",s=i+1;for(;s<e.length;){const t=e.charCodeAt(s);if(!(t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||95===t))break;o+=e[s++]}if(!o)throw new TypeError("Missing parameter name at ".concat(i.toString()));t.push({type:"NAME",index:i,value:o}),i=s}else t.push({type:"CLOSE",index:i,value:e[i++]});else t.push({type:"OPEN",index:i,value:e[i++]});else t.push({type:"ESCAPED_CHAR",index:i++,value:e[i++]});else t.push({type:"MODIFIER",index:i,value:e[i++]})}return t.push({type:"END",index:i,value:""}),t}(e),i="[^".concat(function(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}("/#?"),"]+?");let o=[],s=0,r=0,a="";const n=function(e){if(r<t.length&&t[r].type===e)return t[r++].value},d=function(e){const i=n(e);if(void 0!==i)return i;const{type:o,index:s}=t[r];throw new TypeError("Unexpected ".concat(o," at ").concat(s.toString(),", expected ").concat(e))},l=function(){let e,t="";for(;e=n("CHAR")||n("ESCAPED_CHAR");)t+=e;return t};for(;r<t.length;){const e=n("CHAR"),t=n("NAME"),r=n("PATTERN");if(t||r){let d=e||"";"./".includes(d)&&(a+=d,d=""),a&&(o.push(a),a=""),o.push({name:t||s++,prefix:d,suffix:"",pattern:r||i,modifier:n("MODIFIER")||""});continue}const c=e||n("ESCAPED_CHAR");if(c){a+=c;continue}a&&(o.push(a),a="");if(n("OPEN")){const e=l(),t=n("NAME")||"",r=n("PATTERN")||"",a=l();d("CLOSE"),o.push({name:t||(r?s++:""),pattern:t&&!r?i:r,prefix:e,suffix:a,modifier:n("MODIFIER")||""})}else d("END")}return o}i.d(t,{parsePath:()=>o})},455805:(e,t,i)=>{i(162482)},347753:(e,t,i)=>{i.d(t,{getClipCover:()=>s});var o=i(8520);function s(e,t){return function(e,t,i){const s=e.filter((e=>!e.with_padding));return(0,o.getPhotoSize)(s.length?s:e,t,i)?.url}(e.image&&e.image.length?e.image:e.first_frame??[],t.width,t.height)||""}},689110:(e,t,i)=>{i.d(t,{getClipCover:()=>o.getClipCover,isLockedVideo:()=>s.isLockedVideo});var o=i(347753),s=i(123683)},123683:(e,t,i)=>{function o(e){return Boolean(e.owner?.isAdmin)&&Boolean(e.data.privacy_view&&!function(e){return function(e,t){return!e.category||!t.length||t.includes(e.category)}(e,["all","any"])&&0===(e?.excluded_category?.length||0)&&0===(e?.lists?.allowed?.length||0)&&0===(e?.lists?.excluded?.length||0)&&0===(e?.owners?.allowed?.length||0)&&0===(e?.owners?.excluded?.length||0)}(e.data.privacy_view))}i.d(t,{isLockedVideo:()=>o})},90282:(e,t,i)=>{i.d(t,{PRIVACY_CATEGORY_BY_OPTION:()=>s,PRIVACY_OPTION_BY_CATEGORY:()=>r});var o=i(754106);const s={[o.SETTINGS_PRIVACY_ALL]:"all",[o.SETTINGS_PRIVACY_FRIENDS]:"friends",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"friends_of_friends",[o.SETTINGS_PRIVACY_ONLY_ME]:"only_me"},r={all:o.SETTINGS_PRIVACY_ALL,friends:o.SETTINGS_PRIVACY_FRIENDS,friends_of_friends:o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,only_me:o.SETTINGS_PRIVACY_ONLY_ME}},512143:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>s.PrivacyDropdown,PrivacyFormModal:()=>s.PrivacyFormModal,PrivacyFriendsListsModel:()=>o.PrivacyFriendsListsModel,PrivacyFriendsModal:()=>s.PrivacyFriendsModal,PrivacyFriendsModel:()=>o.PrivacyFriendsModel,SETTINGS_PRIVACY_ALL:()=>r.SETTINGS_PRIVACY_ALL,SETTINGS_PRIVACY_FRIENDS:()=>r.SETTINGS_PRIVACY_FRIENDS});var o=i(474782),s=i(945269),r=i(754106)},934387:(e,t,i)=>{i.d(t,{PrivacyFriendsListsModel:()=>s});var o=i(327813);class s{get friendsLists(){return this._friendsLists}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}dispose(){this._abortController?.abort(),this.friendsListsProvider.reset()}constructor(e,t,i){this.authService=e,this.friendsService=t,this.friendsListsProvider=i,this.fetch=async()=>{if(this.authService.userId){this._abortController?.abort(),this._abortController=new AbortController;try{const e=await this.friendsListsProvider.ensure({userId:this.authService.userId,returnSystem:!0}),t=await Promise.all(e.map((async({id:e,name:t})=>{if(!this.authService.userId)throw new Error("Unexpected friends.get empty user param");const{items:i,count:o}=await this.friendsService.fetchFields({user_id:this.authService.userId,list_id:e,fields:"photo_50",count:3},{signal:this._abortController?.signal});return{id:e,name:t,count:o,friends:i}})));(0,o.runInAction)((()=>{this._friendsLists=t}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}},this._abortController=null,this._friendsLists=null,this._error=null,(0,o.makeAutoObservable)(this)}}},42832:(e,t,i)=>{i.d(t,{PrivacyFriendsModel:()=>s});var o=i(327813);class s{get friends(){return this._friends}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}dispose(){this._abortController?.abort(),this._abortController=null}constructor(e){this.usersProvider=e,this.setFriends=e=>{const t=new Set;this._friends=Array.from([...this._friends||[],...e].filter((e=>!t.has(e.id)&&(t.add(e.id),!0))))},this.fetch=async e=>{if(e.length){this._abortController?.abort(),this._abortController=new AbortController;try{this._friends=await this.usersProvider.fetchUsersByIds({userIds:e},{signal:this._abortController.signal})}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}},this._abortController=null,this._friends=null,this._error=null,(0,o.makeAutoObservable)(this)}}},474782:(e,t,i)=>{i.d(t,{PrivacyFriendsListsModel:()=>o.PrivacyFriendsListsModel,PrivacyFriendsModel:()=>s.PrivacyFriendsModel});var o=i(934387),s=i(42832)},754106:(e,t,i)=>{i.d(t,{SETTINGS_PRIVACY_ALL:()=>o,SETTINGS_PRIVACY_EVERYONE_EXCEPT:()=>l,SETTINGS_PRIVACY_FRIENDS:()=>s,SETTINGS_PRIVACY_FRIENDS_EXCEPT:()=>c,SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS:()=>r,SETTINGS_PRIVACY_ONLY_ME:()=>a,SETTINGS_PRIVACY_SOME_FRIENDS:()=>n,SETTINGS_PRIVACY_SOME_LISTS:()=>d});const o="all",s="friends",r="friends_of_friends",a="only_me",n="some_friends",d="some_lists",l="everyone_except",c="friends_except"},458378:(e,t,i)=>{i.d(t,{getPrivacyValueByBasePrivacy:()=>r});var o=i(754106),s=i(90282);const r=({category:e,lists:t,owners:i})=>{if(e===o.SETTINGS_PRIVACY_ALL&&i?.excluded?.length){const e=new Set(i.excluded.map(String));return{option:o.SETTINGS_PRIVACY_EVERYONE_EXCEPT,excluded:e}}if(e){const t=s.PRIVACY_OPTION_BY_CATEGORY[e];return t?{option:t}:null}if(t?.allowed?.length){const e=new Set(t.allowed.map(String));return{option:o.SETTINGS_PRIVACY_SOME_LISTS,allowed:e}}if(i?.allowed?.length){const e=new Set(i.allowed.map(String));return{option:o.SETTINGS_PRIVACY_SOME_FRIENDS,allowed:e}}return null}},383021:(e,t,i)=>{i.d(t,{getPrivacyValueByBasePrivacy:()=>o.getPrivacyValueByBasePrivacy});var o=i(458378)},184466:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>_});var o=i(474848),s=i(456921),r=i(507852),a=i(260546),n=i(723723),d=i(140083),l=i(132028),c=i(272386),u=i(428234),h=i(868905);const p=(0,s.observer)((function(){const e=(0,c.usePrivacyDropdownModel)();return(0,o.jsx)(r.DropdownActionSheet,{width:260,placement:e.props.current.placement,content:(0,o.jsx)(u.PrivacyDropdownContent,{}),trigger:"click",children:(0,o.jsx)(a.SimpleCell,{after:(0,o.jsx)(d.Icon24ChevronCompactRight,{className:(0,n.getColorClass)("color_icon_tertiary")}),subtitle:(0,o.jsx)(h.PrivacyDropdownSubtitle,{}),multiline:!0,children:e.props.current.title})})})),_=(0,l.createWidget)(c.PrivacyDropdownModelProvider,p)},243274:(e,t,i)=>{i.d(t,{PrivacyDropdownContent:()=>d});var o=i(474848),s=i(456921),r=i(754166),a=i(272386),n=i(46308);const d=(0,s.observer)((function(){const{props:e}=(0,a.usePrivacyDropdownModel)(),t=e.current.isProfileClosed?r.PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:r.PRIVACY_OPTIONS;return(0,o.jsx)(o.Fragment,{children:t.map((e=>(0,o.jsx)(n.PrivacyDropdownOption,{option:e},e)))})}))},428234:(e,t,i)=>{i.d(t,{PrivacyDropdownContent:()=>o.PrivacyDropdownContent});var o=i(243274)},636196:(e,t,i)=>{i.d(t,{PrivacyDropdownOption:()=>u});var o=i(474848),s=i(456921),r=i(507852),a=i(149333),n=i(754106),d=i(841599),l=i(272386),c=i(754166);const u=(0,s.observer)((function({option:e}){const t=(0,a.useLangs)(),{props:i,setPrivacyFromOption:s}=(0,l.usePrivacyDropdownModel)(),{onClickExceptFriends:u,onClickSomeFriends:h}=i.current,p=t.getLang(c.PRIVACY_OPTION_LANG_KEY_BY_OPTION[e]);switch(e){case n.SETTINGS_PRIVACY_SOME_LISTS:return(0,o.jsx)(d.PrivacyDropdownOptionList,{option:e,children:p});case n.SETTINGS_PRIVACY_EVERYONE_EXCEPT:case n.SETTINGS_PRIVACY_FRIENDS_EXCEPT:return(0,o.jsx)(r.DropdownActionSheet.Item,{onClick:u,children:p});case n.SETTINGS_PRIVACY_SOME_FRIENDS:return(0,o.jsx)(r.DropdownActionSheet.Item,{onClick:h,children:p});default:return(0,o.jsx)(r.DropdownActionSheet.Item,{onClick:()=>s(e),children:p})}}))},49586:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionContent:()=>n});var o=i(474848),s=i(456921),r=i(272386),a=i(788072);const n=(0,s.observer)((function(){const{props:e}=(0,r.usePrivacyDropdownModel)(),{friendsLists:t}=e.current;return t?.length?(0,o.jsx)(o.Fragment,{children:t.map((e=>(0,o.jsx)(a.PrivacyDropdownOptionListItem,{friendsList:e},e.id)))}):null}))},407673:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionList:()=>a});var o=i(474848),s=i(161134),r=i(49586);const a=({option:e,children:t})=>(0,o.jsx)(s.DropdownActionSubSheet,{maxHeight:180,sheet:(0,o.jsx)(r.PrivacyDropdownOptionContent,{}),children:t},e)},788072:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionListItem:()=>d});var o=i(474848),s=i(456921),r=i(161134),a=i(846342),n=i(272386);const d=(0,s.observer)((function({friendsList:e}){const{checkedFriendsLists:t,selectFriendsList:i}=(0,n.usePrivacyDropdownModel)(),{id:s,name:d}=e,l=t.has(String(s));return(0,o.jsx)(r.DropdownActionSubSheet.Item,{onClick:()=>i(String(s)),after:l&&(0,o.jsx)(a.Icon20CheckCircleOn,{}),keepOpen:!0,children:d})}))},841599:(e,t,i)=>{i.d(t,{PrivacyDropdownOptionList:()=>o.PrivacyDropdownOptionList});var o=i(407673)},46308:(e,t,i)=>{i.d(t,{PrivacyDropdownOption:()=>o.PrivacyDropdownOption});var o=i(636196)},840844:(e,t,i)=>{i.d(t,{PrivacyDropdownSubtitle:()=>d});var o=i(474848),s=i(724648),r=i(456921),a=i(272386),n=i(662746);const d=(0,r.observer)((function(){const{subtitle:e}=(0,a.usePrivacyDropdownModel)();return(0,o.jsxs)(s.Flex,{align:"center",noWrap:!0,children:[(0,o.jsx)(n.PrivacyDropdownSubtitleLockIcon,{}),e]})}))},662746:(e,t,i)=>{i.d(t,{PrivacyDropdownSubtitleLockIcon:()=>l});var o=i(474848),s=i(456921),r=i(723723),a=i(194528),n=i(725772),d=i(272386);const l=(0,s.observer)((function(){const{hasPrivacy:e}=(0,d.usePrivacyDropdownModel)();return e?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.Icon12Lock,{className:(0,r.getColorClass)("color_icon_tertiary")}),(0,o.jsx)(a.Spacing,{mode:"vertical",size:4})]}):null}))},868905:(e,t,i)=>{i.d(t,{PrivacyDropdownSubtitle:()=>o.PrivacyDropdownSubtitle});var o=i(840844)},754166:(e,t,i)=>{i.d(t,{PRIVACY_OPTIONS:()=>s,PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:()=>r,PRIVACY_OPTION_LANG_KEY_BY_OPTION:()=>n,PRIVACY_SUBTITLE_LANG_KEY_BY_OPTION:()=>a});var o=i(754106);const s=[o.SETTINGS_PRIVACY_ALL,o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_ONLY_ME,o.SETTINGS_PRIVACY_EVERYONE_EXCEPT,o.SETTINGS_PRIVACY_SOME_FRIENDS,o.SETTINGS_PRIVACY_SOME_LISTS],r=[o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_ONLY_ME,o.SETTINGS_PRIVACY_EVERYONE_EXCEPT,o.SETTINGS_PRIVACY_SOME_FRIENDS,o.SETTINGS_PRIVACY_SOME_LISTS],a={[o.SETTINGS_PRIVACY_ALL]:"privacy_options_all_users",[o.SETTINGS_PRIVACY_EVERYONE_EXCEPT]:"global_privacy_settings_everyone_except_subtitle",[o.SETTINGS_PRIVACY_FRIENDS]:"privacy_options_friends_only",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"privacy_options_friends_and_friends",[o.SETTINGS_PRIVACY_ONLY_ME]:"privacy_options_only_me",[o.SETTINGS_PRIVACY_SOME_FRIENDS]:"global_privacy_settings_some_friends_subtitle",[o.SETTINGS_PRIVACY_SOME_LISTS]:"global_privacy_settings_some_friend_lists_subtitle",[o.SETTINGS_PRIVACY_FRIENDS_EXCEPT]:"global_privacy_settings_some_friends_subtitle"},n={[o.SETTINGS_PRIVACY_ALL]:"privacy_options_all_users",[o.SETTINGS_PRIVACY_EVERYONE_EXCEPT]:"privacy_options_advanced_settings",[o.SETTINGS_PRIVACY_FRIENDS]:"privacy_options_friends_only",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"privacy_options_friends_and_friends",[o.SETTINGS_PRIVACY_ONLY_ME]:"privacy_options_only_me",[o.SETTINGS_PRIVACY_SOME_FRIENDS]:"privacy_options_some_friends",[o.SETTINGS_PRIVACY_SOME_LISTS]:"privacy_options_some_friend_lists",[o.SETTINGS_PRIVACY_FRIENDS_EXCEPT]:"settings_privacy_options_advanced_friends_settings"}},922955:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>o.PrivacyDropdown});var o=i(184466)},580122:(e,t,i)=>{i.d(t,{PrivacyDropdownModel:()=>h});var o=i(331635),s=i(327813),r=i(132028),a=i(712600),n=i(641495),d=i(90282),l=i(754106),c=i(754166),u=i(383021);class h{get subtitle(){if(!this.privacyValue)return;const e=this.getPrivacyLists(this.privacy.lists?.allowed),t=this.getPrivacyOwners(this.privacy.owners?.allowed),i=this.getPrivacySubtitle(e,t),o=this.getPrivacyLists(this.privacy.lists?.excluded),s=this.getPrivacyOwners(this.privacy.owners?.excluded),r=this.getPrivacySubtitle(o,s),a=this.langs.getLang(c.PRIVACY_SUBTITLE_LANG_KEY_BY_OPTION[this.privacyValue.option]),n=`${i}${r?`, ${this.langs.getLang("global_privacy_settings_besides_subtitle")} ${r}`:""}`;return a.concat(n)}get checkedFriendsLists(){return this._checkedFriendsLists}get hasPrivacy(){return this.privacyValue?.option!==l.SETTINGS_PRIVACY_ALL}[r.update](){this._checkedFriendsLists=this.getCheckedFriendsLists()}getCheckedFriendsLists(){return this.privacyValue?.allowed&&this.privacyValue.option===l.SETTINGS_PRIVACY_SOME_LISTS?this.privacyValue.allowed:new Set}getPrivacyOwners(e){const t=this.props.current.friends;if(!t||!e)return[];const i=new Set(e);return t.filter((e=>i.has(e.id)))}getPrivacyLists(e){const t=this.props.current.friendsLists;if(!t||!e)return[];const i=new Set(e);return t.filter((e=>i.has(e.id)))}get defaultPrivacy(){return{category:this.props.current.isProfileClosed?l.SETTINGS_PRIVACY_FRIENDS:l.SETTINGS_PRIVACY_ALL}}get privacy(){return this.props.current.privacy||this.defaultPrivacy}get privacyValue(){return(0,u.getPrivacyValueByBasePrivacy)(this.privacy)}constructor(e,t){this.langs=e,this.props=t,this.setPrivacyFromOption=e=>{const t=d.PRIVACY_CATEGORY_BY_OPTION[e];t&&this.props.current.setPrivacy({category:t})},this.selectFriendsList=e=>{this._checkedFriendsLists.has(e)?this._checkedFriendsLists.delete(e):this._checkedFriendsLists.add(e);const t=this._checkedFriendsLists.size?{lists:{allowed:Array.from(this._checkedFriendsLists,(e=>Number(e)))}}:this.defaultPrivacy;this.props.current.setPrivacy(t)},this._checkedFriendsLists=this.getCheckedFriendsLists(),this.getPrivacySubtitle=(e,t)=>{const i=e.length+t.length;if(i>2){const o=e[0]?.name||(0,n.getOwnerName)(t[0]),s=t.length?"global_privacy_settings_N_person_subtitle":"global_privacy_settings_N_list_subtitle",r=this.langs.numeric(i-1,this.langs.getLang(s,!0));return this.langs.langReplace(r,{name:o})}const o=e.map((e=>e.name)),s=t.map((e=>(0,n.getOwnerName)(e)));return o.concat(s).join(", ")},(0,s.makeAutoObservable)(this)}}h=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.Langs?Object:a.Langs,void 0===r.Props?Object:r.Props])],h)},272386:(e,t,i)=>{i.d(t,{PrivacyDropdownModelProvider:()=>r,usePrivacyDropdownModel:()=>a});var o=i(132028),s=i(580122);const{Provider:r,useModel:a}=(0,o.createProvider)(s.PrivacyDropdownModel)},917020:(e,t,i)=>{i.d(t,{PrivacyFormAllowed:()=>l});var o=i(474848),s=i(456921),r=i(296540),a=i(44544),n=i(210924),d=i(750176);const l=(0,s.observer)((function(){const{error:e,setAllowedFriends:t,allowedFriendsModel:{value:i,options:s,setSearchValue:l,isLoading:c}}=(0,n.usePrivacyFormModel)(),u=(0,r.useRef)(null);return(0,r.useEffect)((()=>{e&&u.current?.focus()}),[e]),(0,o.jsx)(a.FormItem,{status:e?"error":"default",children:(0,o.jsx)(d.PrivacyFormSelect,{getRef:u,value:i,options:s,onChange:t,onInputChange:e=>l(e.target.value),isPending:c})})}))},211180:(e,t,i)=>{i.d(t,{PrivacyFormAllowed:()=>o.PrivacyFormAllowed});var o=i(917020)},362886:(e,t,i)=>{i.d(t,{PrivacyFormCategory:()=>n});var o=i(474848),s=i(260546),r=i(149333),a=i(221012);const n=()=>{const e=(0,r.useLangs)();return(0,o.jsx)(s.SimpleCell,{hasActive:!1,hasHover:!1,maxHeight:36,after:(0,o.jsx)(a.PrivacyFormCategoryDropdown,{}),children:e.getLang("global_privacy_settings_allowed")})}},231629:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdown:()=>_});var o=i(474848),s=i(456921),r=i(149333),a=i(507852),n=i(753457),d=i(279734),l=i(723723),c=i(274034),u=i(210924),h=i(826524),p=i(200618);const _=(0,s.observer)((function(){const e=(0,r.useLangs)(),{selectedPrivacyOption:t}=(0,u.usePrivacyFormModel)();return(0,o.jsx)(a.DropdownActionSheet,{trigger:"click",placement:"bottom-end",content:(0,o.jsx)(p.PrivacyFormCategoryDropdownContent,{}),children:(0,o.jsx)(n.Paragraph,{children:(0,o.jsxs)(d.Link,{color:(0,l.getColorClass)("color_text_accent"),children:[e.getLang(h.PRIVACY_LANG_KEY_BY_OPTION[t]).toLowerCase(),(0,o.jsx)(c.Icon16Dropdown,{})]})})})}))},200618:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdownContent:()=>n});var o=i(474848),s=i(456921),r=i(210924),a=i(63526);const n=(0,s.observer)((function(){const{options:e}=(0,r.usePrivacyFormModel)();return(0,o.jsx)(o.Fragment,{children:e.map((e=>(0,o.jsx)(a.PrivacyFormCategoryDropdownOption,{option:e},e)))})}))},63526:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdownOption:()=>c});var o=i(474848),s=i(456921),r=i(507852),a=i(846342),n=i(149333),d=i(210924),l=i(826524);const c=(0,s.observer)((function({option:e}){const t=(0,n.useLangs)(),{selectedPrivacyOption:i,setSelectedPrivacyOption:s}=(0,d.usePrivacyFormModel)();return(0,o.jsx)(r.DropdownActionSheet.Item,{after:e===i?(0,o.jsx)(a.Icon20CheckCircleOn,{}):null,onClick:()=>s(e),children:t.getLang(l.PRIVACY_LANG_KEY_BY_OPTION[e])})}))},221012:(e,t,i)=>{i.d(t,{PrivacyFormCategoryDropdown:()=>o.PrivacyFormCategoryDropdown});var o=i(231629)},198624:(e,t,i)=>{i.d(t,{PrivacyFormCategory:()=>o.PrivacyFormCategory});var o=i(362886)},419134:(e,t,i)=>{i.d(t,{PrivacyFormExcluded:()=>d});var o=i(474848),s=i(456921),r=i(44544),a=i(210924),n=i(750176);const d=(0,s.observer)((function(){const{setExcludedFriends:e,excludedFriendsModel:{value:t,options:i,setSearchValue:s,isLoading:d}}=(0,a.usePrivacyFormModel)();return(0,o.jsx)(r.FormItem,{children:(0,o.jsx)(n.PrivacyFormSelect,{value:t,options:i,onChange:e,onInputChange:e=>s(e.target.value),isPending:d})})}))},579254:(e,t,i)=>{i.d(t,{PrivacyFormExcluded:()=>o.PrivacyFormExcluded});var o=i(419134)},328010:(e,t,i)=>{i.d(t,{PrivacyFormFooter:()=>c});var o=i(474848),s=i(456921),r=i(908242),a=i(175400),n=i(454154),d=i(149333),l=i(210924);const c=(0,s.observer)((function({onClose:e}){const t=(0,d.useLangs)(),{saveForm:i}=(0,l.usePrivacyFormModel)();return(0,o.jsx)(r.ModalFooter,{actions:(0,o.jsxs)(a.ButtonGroup,{gap:"m",align:"right",children:[(0,o.jsx)(n.Button,{mode:"secondary",size:"m",onClick:e,children:t.getLang("global_cancel")}),(0,o.jsx)(n.Button,{mode:"primary",size:"m",onClick:()=>{i(e)},children:t.getLang("global_save")})]})})}))},693671:(e,t,i)=>{i.d(t,{PrivacyFormFooter:()=>o.PrivacyFormFooter});var o=i(328010)},267170:(e,t,i)=>{i.d(t,{PrivacyFormModal:()=>C});var o=i(474848),s=i(456921),r=i(211413),a=i(694244),n=i(782174),d=i(303800),l=i(557992),c=i(194528),u=i(582192),h=i(149333),p=i(132028),_=i(210924),v=i(198624),g=i(937483),m=i(579254),y=i(693671);const b=(0,s.observer)((function(){const e=(0,h.useLangs)(),{props:t}=(0,_.usePrivacyFormModel)();return(0,o.jsx)(r.MessageBoxModal,{width:640,onDestroy:t.current.onDestroy,children:({onClose:t})=>(0,o.jsxs)(a.ModalBox,{children:[(0,o.jsx)(n.ModalHeader,{onClose:t,closeAriaLabel:e.getLang("global_close"),children:e.getLang("global_privacy_modal_title")}),(0,o.jsxs)(d.Div,{mode:"horizontal",spacing:0,children:[(0,o.jsx)(l.Header,{children:e.getLang("friends_privacy_show")}),(0,o.jsx)(v.PrivacyFormCategory,{}),(0,o.jsx)(g.PrivacyFormSomeFriendsAllowed,{}),(0,o.jsx)(c.Spacing,{size:6}),(0,o.jsx)(u.Separator,{}),(0,o.jsx)(l.Header,{children:e.getLang("friends_privacy_hide")}),(0,o.jsx)(m.PrivacyFormExcluded,{}),(0,o.jsx)(c.Spacing,{})]}),(0,o.jsx)(y.PrivacyFormFooter,{onClose:t})]})})})),C=(0,p.createWidget)(_.PrivacyFormModelProvider,b)},279754:(e,t,i)=>{i.d(t,{PrivacyFormSelect:()=>n});var o=i(474848),s=i(753457),r=i(149333),a=i(657745);const n=({isPending:e,value:t,options:i,onChange:n,onInputChange:d,getRef:l})=>{const c=(0,r.useLangs)();return(0,o.jsx)(s.ChipsSelect,{getRef:l,value:t,onChange:n,onInputChange:d,options:i,fetching:e,placeholder:c.getLang("friends_privacy_choose"),filterFn:!1,renderOption:(e,t)=>(0,o.jsx)(a.PrivacyFormSelectOption,{option:t,...e})})}},657745:(e,t,i)=>{i.d(t,{PrivacyFormSelectOption:()=>d});var o=i(474848),s=i(456921),r=i(753457),a=i(612196),n=i(412888);const d=(0,s.observer)((function({option:e,...t}){return(0,o.jsx)(r.CustomSelectOption,{...t,before:e.friend?(0,o.jsx)(a.Avatar,{size:24,src:e.friend.photo_50}):null,description:e.friendsList?e.description:null,children:(0,o.jsx)(n.TextClamp,{lines:1,children:e.label})})}))},750176:(e,t,i)=>{i.d(t,{PrivacyFormSelect:()=>o.PrivacyFormSelect});var o=i(279754)},160634:(e,t,i)=>{i.d(t,{PrivacyFormSomeFriendsAllowed:()=>n});var o=i(474848),s=i(456921),r=i(211180),a=i(210924);const n=(0,s.observer)((function(){const{isSomeFriends:e}=(0,a.usePrivacyFormModel)();return e&&(0,o.jsx)(r.PrivacyFormAllowed,{})}))},937483:(e,t,i)=>{i.d(t,{PrivacyFormSomeFriendsAllowed:()=>o.PrivacyFormSomeFriendsAllowed});var o=i(160634)},826524:(e,t,i)=>{i.d(t,{PRIVACY_LANG_KEY_BY_OPTION:()=>a,PRIVACY_OPTIONS:()=>s,PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:()=>r});var o=i(754106);const s=[o.SETTINGS_PRIVACY_ALL,o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_SOME_FRIENDS],r=[o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_SOME_FRIENDS],a={[o.SETTINGS_PRIVACY_ALL]:"global_privacy_settings_all_dative",[o.SETTINGS_PRIVACY_FRIENDS]:"global_privacy_settings_friends_dative",[o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS]:"global_privacy_settings_friends_of_friends_dative",[o.SETTINGS_PRIVACY_SOME_FRIENDS]:"global_privacy_settings_some_friends_dative",[o.SETTINGS_PRIVACY_EVERYONE_EXCEPT]:"",[o.SETTINGS_PRIVACY_ONLY_ME]:"",[o.SETTINGS_PRIVACY_SOME_LISTS]:"",[o.SETTINGS_PRIVACY_FRIENDS_EXCEPT]:""};o.SETTINGS_PRIVACY_ALL,o.SETTINGS_PRIVACY_FRIENDS,o.SETTINGS_PRIVACY_FRIENDS_OF_FRIENDS,o.SETTINGS_PRIVACY_ONLY_ME},967085:(e,t,i)=>{i.d(t,{PrivacyFormModal:()=>o.PrivacyFormModal});var o=i(267170)},848993:(e,t,i)=>{i.d(t,{PrivacyFormModel:()=>_});var o=i(331635),s=i(327813),r=i(712600),a=i(951652),n=i(889781),d=i(132028),l=i(754106),c=i(90282),u=i(383021),h=i(826524),p=i(444361);class _{get selectedPrivacyOption(){return this._selectedPrivacyOption}get error(){return this._error}get isSomeFriends(){return this.selectedPrivacyOption===l.SETTINGS_PRIVACY_SOME_FRIENDS}get options(){return this.props.current.isProfileClosed?h.PRIVACY_OPTIONS_FOR_CLOSED_PROFILE:h.PRIVACY_OPTIONS}dispose(){this.allowedFriendsModel.dispose(),this.excludedFriendsModel.dispose()}[d.init](){this.allowedFriendsModel.search(),this.excludedFriendsModel.search()}get allowedValue(){return this._selectedPrivacyOption!==l.SETTINGS_PRIVACY_SOME_FRIENDS?[]:this.allowedFriendsModel.value}get excludedValue(){return this.excludedFriendsModel.value}get selectedPrivacyFromProps(){if(!this.props.current.privacy)return l.SETTINGS_PRIVACY_ALL;const e=(0,u.getPrivacyValueByBasePrivacy)(this.props.current.privacy);if(!e)return l.SETTINGS_PRIVACY_ALL;switch(e.option){case l.SETTINGS_PRIVACY_SOME_LISTS:return l.SETTINGS_PRIVACY_SOME_FRIENDS;case l.SETTINGS_PRIVACY_ONLY_ME:return l.SETTINGS_PRIVACY_FRIENDS;case l.SETTINGS_PRIVACY_EVERYONE_EXCEPT:return l.SETTINGS_PRIVACY_ALL;default:return e.option}}get privacy(){return{category:c.PRIVACY_CATEGORY_BY_OPTION[this._selectedPrivacyOption],owners:this.privacyOwners,lists:this.privacyLists}}get privacyOwners(){const e=e=>e.reduce(((e,t)=>(t.friend&&e.push(t.value),e)),[]);return{allowed:e(this.allowedValue),excluded:e(this.excludedValue)}}get privacyLists(){const e=e=>e.reduce(((e,t)=>(t.friendsList&&e.push(t.value),e)),[]);return{allowed:e(this.allowedValue),excluded:e(this.excludedValue)}}get privacyFriends(){return[...this.allowedValue,...this.excludedValue].reduce(((e,t)=>(t.friend&&e.push(t.friend),e)),[])}constructor(e,t,i,o){this.langs=e,this.authService=t,this.friendsSearchProvider=i,this.props=o,this.allowedFriendsModel=new p.PrivacyFormSearchModel(this.langs,this.authService,this.friendsSearchProvider,this.props.current.friendsLists,this.props.current.friends,this.props.current.privacy?.lists?.allowed,this.props.current.privacy?.owners?.allowed),this.excludedFriendsModel=new p.PrivacyFormSearchModel(this.langs,this.authService,this.friendsSearchProvider,this.props.current.friendsLists,this.props.current.friends,this.props.current.privacy?.lists?.excluded,this.props.current.privacy?.owners?.excluded),this.setAllowedFriends=e=>{const t=new Set(e.map((e=>e.value))),i=this.excludedFriendsModel.value.filter((e=>!t.has(e.value)));i.length!==this.excludedFriendsModel.value.length&&this.excludedFriendsModel.setValue(i),this.allowedFriendsModel.setValue(e)},this.setExcludedFriends=e=>{const t=new Set(e.map((e=>e.value))),i=this.allowedFriendsModel.value.filter((e=>!t.has(e.value)));i.length!==this.allowedFriendsModel.value.length&&this.allowedFriendsModel.setValue(i),this.excludedFriendsModel.setValue(e)},this.setSelectedPrivacyOption=e=>{this._selectedPrivacyOption=e},this.saveForm=e=>{this._error=this.isSomeFriends&&!this.allowedFriendsModel.value.length,this._error||(this.props.current.setFriends(this.privacyFriends),this.props.current.setPrivacy(this.privacy),e?.())},this._error=!1,this._selectedPrivacyOption=this.selectedPrivacyFromProps,(0,s.makeAutoObservable)(this)}}_=(0,o.__decorate)([d.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.Langs?Object:r.Langs,void 0===a.AuthService?Object:a.AuthService,void 0===n.FriendsSearchService?Object:n.FriendsSearchService,void 0===d.Props?Object:d.Props])],_)},444361:(e,t,i)=>{i.d(t,{PrivacyFormSearchModel:()=>a});var o=i(327813),s=i(8520),r=i(641495);class a{get value(){return this._value}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}get options(){const e=this.getFriendsOptions(this._friends),t=this.friendsLists?.filter((({name:e,count:t})=>t>0&&e.toLowerCase().includes(this._searchValue.toLowerCase()))),i=this.getFriendsListOptions(t);return e.concat(i)}dispose(){this._abortController?.abort()}get friendsValue(){const e=this.friends?.filter((e=>this.ownerIds?.includes(e.id))),t=this.getFriendsOptions(e),i=this.friendsLists?.filter((e=>this.listsIds?.includes(e.id))),o=this.getFriendsListOptions(i);return t.length||o.length?t.concat(o):[]}constructor(e,t,i,a,n,d,l){this.langs=e,this.authService=t,this.friendsSearchProvider=i,this.friendsLists=a,this.friends=n,this.listsIds=d,this.ownerIds=l,this.setValue=e=>{this._value=e},this.setSearchValue=(0,s.debounce)((e=>{this._searchValue=e.trim(),this.search()}),300),this.search=async()=>{if(!this.authService.userId)return;this._abortController?.abort(),this._abortController=new AbortController;const e={user_id:this.authService.userId,fields:"photo_50",q:this._searchValue};try{const t=await this.friendsSearchProvider.search(e,{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._friends=t.items}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}},this.getFriendsOptions=e=>e?e.map((e=>({value:e.id,label:(0,r.getOwnerName)(e),friend:e}))):[],this.getFriendsListOptions=e=>e?e.map((e=>{const{id:t,name:i,count:o,friends:s}=e,a=s?.map((e=>(0,r.getOwnerName)(e))).join(", ");return{friendsList:e,value:t,label:i,description:a&&o>10?this.langs.langReplace(this.langs.getLang("global_privacy_settings_friends_list_others"),{users:a}):a}})):[],this._abortController=null,this._friends=null,this._error=null,this._value=this.friendsValue,this._searchValue="",(0,o.makeAutoObservable)(this)}}},210924:(e,t,i)=>{i.d(t,{PrivacyFormModelProvider:()=>r,usePrivacyFormModel:()=>a});var o=i(132028),s=i(848993);const{Provider:r,useModel:a}=(0,o.createProvider)(s.PrivacyFormModel)},229111:(e,t,i)=>{i.d(t,{PrivacyFriendsFooter:()=>c});var o=i(474848),s=i(456921),r=i(908242),a=i(175400),n=i(454154),d=i(149333),l=i(551475);const c=(0,s.observer)((function({onClose:e}){const t=(0,d.useLangs)(),{saveForm:i}=(0,l.usePrivacyFriendsFormModel)();return(0,o.jsx)(r.ModalFooter,{actions:(0,o.jsxs)(a.ButtonGroup,{gap:"m",align:"right",children:[(0,o.jsx)(n.Button,{mode:"secondary",size:"m",onClick:e,children:t.getLang("global_cancel")}),(0,o.jsx)(n.Button,{mode:"primary",size:"m",onClick:()=>{i(),e()},children:t.getLang("global_save")})]})})}))},508023:(e,t,i)=>{i.d(t,{PrivacyFriendsFooter:()=>o.PrivacyFriendsFooter});var o=i(229111)},148501:(e,t,i)=>{i.d(t,{PrivacyFriendsForm:()=>c});var o=i(474848),s=i(456921),r=i(303800),a=i(194528),n=i(700517),d=i(884088),l=i(532004);const c=(0,s.observer)((function(){return(0,o.jsxs)(r.Div,{mode:"horizontal",spacing:0,children:[(0,o.jsx)(n.PrivacyFriendsFormHeader,{}),(0,o.jsx)(d.PrivacyFriendsFormSearch,{}),(0,o.jsx)(a.Spacing,{size:4}),(0,o.jsx)(l.PrivacyFriendsFormList,{})]})}))},838873:(e,t,i)=>{i.d(t,{PrivacyFriendsFormHeader:()=>n});var o=i(474848),s=i(557992),r=i(149333),a=i(827505);const n=()=>{const e=(0,r.useLangs)();return(0,o.jsx)(s.Header,{aside:(0,o.jsx)(a.PrivacyFriendsFormSelectedButton,{}),children:e.getLang("global_privacy_settings_friends_in_list")})}},827505:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSelectedButton:()=>d});var o=i(474848),s=i(456921),r=i(279734),a=i(149333),n=i(551475);const d=(0,s.observer)((function(){const e=(0,a.useLangs)(),{selectedFriends:t,friends:i,isSelectedOnly:s,toggleSelectedOnly:d}=(0,n.usePrivacyFriendsFormModel)();return t.size&&i&&i.length?(0,o.jsx)(r.Link,{onClick:d,children:s?e.getLang("friends_privacy_show_all"):e.getLang("friends_privacy_show_selected")}):null}))},700517:(e,t,i)=>{i.d(t,{PrivacyFriendsFormHeader:()=>o.PrivacyFriendsFormHeader});var o=i(838873)},238197:(e,t,i)=>{i.d(t,{PrivacyFriendsFormContainer:()=>c});var o=i(474848),s=i(456921),r=i(159618),a=i(551475),n=i(922917),d=i(327100),l=i(796929);const c=(0,s.observer)((function(){const{friends:e}=(0,a.usePrivacyFriendsFormModel)();return e?.length?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.SpacedList,{spacing:4,children:e.map((e=>(0,o.jsx)(n.PrivacyFriendsFormItem,{friend:e},e.id)))}),(0,o.jsx)(l.PrivacyFriendsFormContainerLoading,{})]}):(0,o.jsx)(d.PrivacyFriendsFormStatus,{})}))},796929:(e,t,i)=>{i.d(t,{PrivacyFriendsFormContainerLoading:()=>d});var o=i(474848),s=i(456921),r=i(303800),a=i(700272),n=i(551475);const d=(0,s.observer)((function(){const{searchFriendsModel:{isLoading:e}}=(0,n.usePrivacyFriendsFormModel)();return e?(0,o.jsx)(r.Div,{children:(0,o.jsx)(a.Spinner,{size:"small"})}):null}))},179901:(e,t,i)=>{i.d(t,{PrivacyFriendsFormContainer:()=>o.PrivacyFriendsFormContainer});var o=i(238197)},174727:(e,t,i)=>{i.d(t,{PrivacyFriendsFormItem:()=>l});var o=i(474848),s=i(456921),r=i(398586),a=i(612196),n=i(641495),d=i(551475);const l=(0,s.observer)((function({friend:e}){const{selectedFriends:t,toggleSelectedFriend:i}=(0,d.usePrivacyFriendsFormModel)();return(0,o.jsx)(r.SelectableCell,{checked:t.has(e.id),onChange:()=>i(e.id),before:(0,o.jsx)(a.Avatar,{size:32,src:e.photo_50}),maxHeight:36,children:(0,n.getOwnerName)(e)})}))},922917:(e,t,i)=>{i.d(t,{PrivacyFriendsFormItem:()=>o.PrivacyFriendsFormItem});var o=i(174727)},141195:(e,t,i)=>{i.d(t,{PrivacyFriendsFormList:()=>u});var o=i(474848),s=i(456921),r=i(296540),a=i(744440),n=i(8520),d=i(551475),l=i(179901),c=i(729501);const u=(0,s.observer)((function(){const{searchFriendsModel:{handleScrollSearch:e}}=(0,d.usePrivacyFriendsFormModel)(),t=(0,r.useRef)(null);return(0,r.useEffect)((()=>{const i=(0,n.throttle)((({target:t})=>{const i=t;i.scrollHeight-i.scrollTop<=2*i.clientHeight&&e()}),200);return t.current?.addEventListener("scroll",i),()=>{t.current?.removeEventListener("scroll",i)}}),[]),(0,o.jsx)(a.CustomScrollView,{boxRef:t,className:c.default.scroll,children:(0,o.jsx)(l.PrivacyFriendsFormContainer,{})})}))},393449:(e,t,i)=>{i.d(t,{PrivacyFriendsFormStatus:()=>u});var o=i(474848),s=i(456921),r=i(724648),a=i(700272),n=i(720836),d=i(149333),l=i(551475),c=i(930735);const u=(0,s.observer)((function(){const e=(0,d.useLangs)(),{searchFriendsModel:{isLoading:t}}=(0,l.usePrivacyFriendsFormModel)();return(0,o.jsx)(r.Flex,{align:"center",justify:"center",className:c.default.status,children:t?(0,o.jsx)(a.Spinner,{size:"medium"}):(0,o.jsx)(n.Placeholder,{children:e.getLang("global_privacy_settings_no_friends_found_for_query")})})}))},327100:(e,t,i)=>{i.d(t,{PrivacyFriendsFormStatus:()=>o.PrivacyFriendsFormStatus});var o=i(393449)},532004:(e,t,i)=>{i.d(t,{PrivacyFriendsFormList:()=>o.PrivacyFriendsFormList});var o=i(141195)},637643:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSearch:()=>n});var o=i(474848),s=i(456921),r=i(264458),a=i(551475);const n=(0,s.observer)((function(){const{searchFriendsModel:{setValue:e}}=(0,a.usePrivacyFriendsFormModel)();return(0,o.jsx)(r.Search,{onChange:t=>e(t.target.value)})}))},884088:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSearch:()=>o.PrivacyFriendsFormSearch});var o=i(637643)},607546:(e,t,i)=>{i.d(t,{PrivacyFriendsForm:()=>o.PrivacyFriendsForm});var o=i(148501)},839282:(e,t,i)=>{i.d(t,{PrivacyFriendsModal:()=>_});var o=i(474848),s=i(456921),r=i(694244),a=i(782174),n=i(149333),d=i(211413),l=i(551475),c=i(607546),u=i(508023),h=i(132028);const p=(0,s.observer)((function(){const e=(0,n.useLangs)(),{props:t}=(0,l.usePrivacyFriendsFormModel)();return(0,o.jsx)(d.MessageBoxModal,{width:640,onDestroy:t.current.onDestroy,children:({onClose:t})=>(0,o.jsxs)(r.ModalBox,{children:[(0,o.jsx)(a.ModalHeader,{onClose:t,closeAriaLabel:e.getLang("global_close"),children:e.getLang("global_privacy_settings_select_friends_modal_title")}),(0,o.jsx)(c.PrivacyFriendsForm,{}),(0,o.jsx)(u.PrivacyFriendsFooter,{onClose:t})]})})})),_=(0,h.createWidget)(l.PrivacyFriendsFormModelProvider,p)},849244:(e,t,i)=>{i.d(t,{PrivacyFriendsModal:()=>o.PrivacyFriendsModal});var o=i(839282)},571799:(e,t,i)=>{i.d(t,{PrivacyFriendsFormModel:()=>l});var o=i(331635),s=i(327813),r=i(951652),a=i(889781),n=i(132028),d=i(857171);class l{get friends(){return this._isSelectedOnly&&this.searchFriendsModel.friends?this.searchFriendsModel.friends.filter((e=>this._selectedFriends.has(e.id))):this.searchFriendsModel.friends}get selectedFriends(){return this._selectedFriends}get isSelectedOnly(){return this._isSelectedOnly}dispose(){this.searchFriendsModel.dispose()}[n.init](){this.setCurrentFriends(),this.searchFriendsModel.search()}[n.update](){this.setCurrentFriends()}[n.destroy](){this.dispose()}constructor(e,t,i){this.authService=e,this.friendsSearchProvider=t,this.props=i,this.toggleSelectedOnly=()=>{this._isSelectedOnly=!this._isSelectedOnly},this.toggleSelectedFriend=e=>{this._selectedFriends.has(e)?this._selectedFriends.delete(e):this._selectedFriends.add(e)},this.setCurrentFriends=()=>{const{privacy:e,friends:t}=this.props.current;if(e?.lists?.excluded?.length||e?.lists?.allowed?.length||e?.owners?.excluded?.length||!e?.owners?.allowed?.length||!t)return void(this._selectedFriends=new Set);const i=t.reduce(((t,i)=>(e?.owners?.allowed?.includes(i.id)&&t.push(i.id),t)),[]);this._selectedFriends=new Set(i)},this.saveForm=()=>{if(!this._selectedFriends.size)return void this.props.current.setPrivacy({category:"only_me"});const e=this.searchFriendsModel.friends?.filter((e=>this._selectedFriends.has(e.id)));e&&(this.props.current.setFriends(e),this.props.current.setPrivacy({owners:{allowed:Array.from(this._selectedFriends)}}))},this.searchFriendsModel=new d.PrivacyFriendsFormSearchModel(this.authService,this.friendsSearchProvider),this._isSelectedOnly=!1,this._selectedFriends=new Set,(0,s.makeAutoObservable)(this)}}l=(0,o.__decorate)([n.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.AuthService?Object:r.AuthService,void 0===a.FriendsSearchService?Object:a.FriendsSearchService,void 0===n.Props?Object:n.Props])],l)},857171:(e,t,i)=>{i.d(t,{PrivacyFriendsFormSearchModel:()=>r});var o=i(327813),s=i(740342);class r{get friends(){return this._friends}get isLoading(){return Boolean(this._abortController)}get error(){return this._error}resetData(){this._friends=null,this._error=null,this._totalCount=null}dispose(){this._abortController?.abort()}constructor(e,t){this.authService=e,this.friendsSearchProvider=t,this.setValue=(0,s.debounce)((e=>{const t=e.trim();this._value!==t&&(this.resetData(),this._value=t,this.search())}),300),this.search=async()=>{if(!this.authService.userId||this._totalCount&&this._friends&&this._friends.length>=this._totalCount)return;this._abortController?.abort(),this._abortController=new AbortController;const e={user_id:this.authService.userId,offset:this._friends?.length,count:50,fields:"photo_50",q:this._value};try{const t=await this.friendsSearchProvider.search(e,{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._friends=this._friends||[],this._friends.push(...t.items),this._totalCount=t.count}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}},this.handleScrollSearch=()=>{this.isLoading||this.search()},this._abortController=null,this._friends=null,this._error=null,this._value="",this._totalCount=null,(0,o.makeAutoObservable)(this)}}},551475:(e,t,i)=>{i.d(t,{PrivacyFriendsFormModelProvider:()=>r,usePrivacyFriendsFormModel:()=>a});var o=i(132028),s=i(571799);const{Provider:r,useModel:a}=(0,o.createProvider)(s.PrivacyFriendsFormModel)},945269:(e,t,i)=>{i.d(t,{PrivacyDropdown:()=>o.PrivacyDropdown,PrivacyFormModal:()=>s.PrivacyFormModal,PrivacyFriendsModal:()=>r.PrivacyFriendsModal});var o=i(922955),s=i(967085),r=i(849244)},285322:(e,t,i)=>{i.d(t,{ClipsFeedComponent:()=>l});var o=i(474848),s=i(719086),r=i(907678),a=i(961113),n=i(672019),d=i(111658);function l({feed:e,listIds:t,isLoading:i,isError:l,fullyLoaded:c,loadMore:u,itemSize:h,activeItemId:p,onActiveItemChanged:_,itemRender:v,after:g,scrollRef:m,itemsOffset:y,overscanOptimized:b}){const C=(0,r.usePageBlockOffset)();return t.length?p?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:d.default.feedWrapper,children:(0,o.jsx)(n.AsyncCarousel,{activeItem:p,calcItemSize:()=>h,getItemKey:e=>e.toString(),items:t,itemRender:v,itemsGap:C,loadMore:u,onActiveItemChange:_,pending:i,swipeComponentRef:m,itemsOffset:y,overscanOptimized:b})},e),g]}):(0,o.jsx)(s.FeedSkeleton,{startOffset:!0}):(0,o.jsxs)(o.Fragment,{children:[i&&(0,o.jsx)(s.FeedSkeleton,{startOffset:!0}),c&&(0,o.jsx)(a.EmptyFeedPlaceholder,{feed:e}),l&&(0,o.jsx)(a.GlobalErrorPlaceholder,{})]})}},716968:(e,t,i)=>{i.d(t,{AsyncCarousel:()=>u});var o=i(474848),s=i(296540),r=i(753457),a=i(265032),n=i(276706),d=i(83537);const l=Symbol(),c={width:100,height:d.ITEM_BOTTOM_OFFSET-16},u=({activeItem:e,calcItemSize:t,getItemKey:i,itemRender:d,items:u,loadMore:h,itemsGap:p,onActiveItemChange:_,pending:v,prefetchOn:g=3,swipeComponentRef:m,itemsOffset:y,overscanOptimized:b})=>{const C=u.length,f=e?u.indexOf(e):-1,I=f>-1?f:0,S=C,[P,w]=(0,s.useState)(!1),[A,L]=(0,s.useState)(""),E=(0,s.useMemo)((()=>v?[...u,l]:u),[u,v]);(0,s.useEffect)((()=>{f>=C-g&&h()}),[f,C,g,h]),(0,s.useEffect)((()=>{(I<S-1||!v)&&w(!1)}),[I,C,v]);const M=(0,s.useCallback)((e=>e!==S?t(e):{...t(e),height:c.height}),[v,t,S]),F=(0,s.useCallback)(((t,i)=>t!==l?d(t,i,A===t,e===t):(0,o.jsx)(r.PanelSpinner,{height:c.height})),[d,A,e]),k=(0,s.useCallback)(((e,t)=>e!==l?i?.(e,t)??t:"PENDING"),[i]),x=(0,s.useCallback)((t=>{t&&e&&L(String(e))}),[e]);return(0,o.jsx)(a.ClipsCarousel,{activeItemIndex:P&&v?S:I,calcItemSize:M,getItemKey:k,items:E,renderItem:F,itemsGap:p,startGap:!0,overscan:b?4:10,lastToStart:!0,onItemIndexChange:t=>{t<u.length&&u[t]!==e&&_(u[t]),w(t>=S)},swipeComponentRef:m,snapScrollBlockRender:!n.browser.safari,onSnapScrollIdle:x,itemsOffset:y})}},697254:(e,t,i)=>{i.d(t,{AsyncCarousel:()=>o.AsyncCarousel});var o=i(716968)},411636:(e,t,i)=>{i.d(t,{ClipsFeedCarouselControls:()=>_});var o=i(474848),s=i(296540),r=i(202350),a=i(271036),n=i(723723),d=i(225583),l=i(578192),c=i(149333),u=i(145941);const h=["ArrowUp","KeyW"],p=["ArrowDown","KeyS"],_=({isFirstActive:e,isLastActive:t,handler:i})=>{const _=(0,c.useLangs)(),v=(0,s.useCallback)((()=>i(-1)),[i]),g=(0,s.useCallback)((()=>i(1)),[i]);return(0,u.useKeyPress)(h,v),(0,u.useKeyPress)(p,g),(0,o.jsxs)(r.RoundedGroup,{direction:"vertical",gap:16,children:[(0,o.jsx)(r.RoundedGroup.Item,{mode:"border",children:(0,o.jsx)(a.IconButton,{className:(0,n.getColorClass)("color_icon_secondary"),size:52,disabled:e,"aria-controls":"clips-carousel","aria-label":_.getLang("video_clips_prev_video"),"data-testid":"clips-controls-prev-button",onClick:()=>i(-1),children:(0,o.jsx)(d.Icon28ArrowUpOutline,{})})}),(0,o.jsx)(r.RoundedGroup.Item,{mode:"border",children:(0,o.jsx)(a.IconButton,{className:(0,n.getColorClass)("color_icon_secondary"),size:52,disabled:t,"aria-controls":"clips-carousel","aria-label":_.getLang("video_clips_next_video"),"data-testid":"clips-controls-next-button",onClick:()=>i(1),children:(0,o.jsx)(l.Icon28ArrowDownOutline,{})})})]})}},145941:(e,t,i)=>{i.d(t,{useKeyPress:()=>s});var o=i(296540);const s=(e,t)=>{(0,o.useEffect)((()=>{const i=i=>{i.target!==document.body&&"clips-carousel"!==i.target?.getAttribute("aria-controls")||!(Array.isArray(e)?e.includes(i.code):e===i.code)||(i.preventDefault(),t?.())};return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}}),[e,t])}},840231:(e,t,i)=>{i.d(t,{ClipsFeedCarouselControls:()=>o.ClipsFeedCarouselControls});var o=i(411636)},554228:(e,t,i)=>{i.d(t,{ClipsFeedControlsLayout:()=>n});var o=i(474848),s=i(724648),r=i(401657),a=i(912248);const n=({itemSize:e,topControls:t,bottomControls:i,itemsOffset:n})=>{const d={"--clips-feed-controlslayout-height":`${e.height}px`,left:window.vk.rtl?"auto":(0,r.getControlsLeftPosition)(e.width,n),right:window.vk.rtl?(0,r.getControlsLeftPosition)(e.width,n):"auto"};return(0,o.jsxs)(s.Flex,{direction:"column",justify:"space-between",align:"baseline",className:a.default.root,style:d,margin:"none",children:[(0,o.jsx)(s.Flex.Item,{alignSelf:"start",children:(0,o.jsx)(s.Flex,{direction:"row",gap:16,margin:"none",children:t})}),(0,o.jsx)(s.Flex.Item,{alignSelf:"start",children:(0,o.jsx)(s.Flex,{direction:e.height<600?"row":"column",gap:16,align:"end",margin:"none",children:i})})]})}},649407:(e,t,i)=>{i.d(t,{ClipsFeedControlsLayout:()=>o.ClipsFeedControlsLayout});var o=i(554228)},401657:(e,t,i)=>{i.d(t,{getControlsLeftPosition:()=>s});var o=i(83537);const s=(e,t=0)=>e+t+o.FEED_CLIP_CONTROLS_OFFSET-(e-o.ITEM_MAX_WIDTH)/(o.ITEM_MAX_WIDTH-o.ITEM_MIN_WIDTH)*o.FEED_CLIP_CONTROLS_OFFSET_RANGE},672019:(e,t,i)=>{i.d(t,{AsyncCarousel:()=>o.AsyncCarousel,ClipsFeedCarouselControls:()=>s.ClipsFeedCarouselControls,ClipsFeedControlsLayout:()=>r.ClipsFeedControlsLayout});var o=i(697254),s=i(840231),r=i(649407)},83537:(e,t,i)=>{i.d(t,{FEED_CLIP_CONTROLS_OFFSET:()=>d,FEED_CLIP_CONTROLS_OFFSET_RANGE:()=>l,FEED_CLIP_CONTROLS_WIDTH:()=>c,ITEM_BOTTOM_OFFSET:()=>s,ITEM_MAX_WIDTH:()=>r,ITEM_MIN_HEIGHT:()=>n,ITEM_MIN_WIDTH:()=>a,ITEM_RATIO:()=>o});const o=9/16,s=30,r=450,a=380,n=450,d=30,l=20,c=100},274781:(e,t,i)=>{i.d(t,{useClipSize:()=>o.useClipSize});var o=i(795805)},795805:(e,t,i)=>{i.d(t,{useClipSize:()=>n});var o=i(296540),s=i(469821),r=i(835077),a=i(83537);const n=()=>{const e=(0,r.useNarrowColumnOffset)(),[t,i]=(0,s.useElementSize)(),[n,d]=(0,o.useMemo)((()=>{let t=i.width?i.width-a.FEED_CLIP_CONTROLS_WIDTH:0,o=window.innerHeight-e-a.ITEM_BOTTOM_OFFSET;o=Math.min(t/a.ITEM_RATIO,o);const s=Math.min(Math.max(o,a.ITEM_MIN_HEIGHT),a.ITEM_MAX_WIDTH/a.ITEM_RATIO),r=Math.max(s*a.ITEM_RATIO,a.ITEM_MIN_WIDTH);return[t,{height:s,width:r,ratio:r/s,mode:r===a.ITEM_MIN_WIDTH?"cover":"contain"}]}),[i]);return{setRoot:t,itemSize:d,maxWidth:n}}},330190:(e,t,i)=>{i.d(t,{ClipsFeedCarouselControls:()=>s.ClipsFeedCarouselControls,ClipsFeedComponent:()=>o.ClipsFeedComponent,ClipsFeedControlsLayout:()=>s.ClipsFeedControlsLayout,useClipSize:()=>r.useClipSize});var o=i(285322),s=i(672019),r=i(274781)},104985:(e,t,i)=>{i.d(t,{EmptyFeedPlaceholder:()=>d});var o=i(474848),s=i(720836),r=i(910551),a=i(149333),n=i(296540);const d=({feed:e})=>{const t=(0,a.useLangs)(),i=(0,n.useMemo)((()=>({subscriptions:t.getLang("video_clip_subscriptions_placeholder"),ownerFeed:t.getLang("video_clip_grid_placeholder"),postponed:t.getLang("video_clip_grid_postponed_placeholder")})),[]);return(0,o.jsx)(s.Placeholder,{icon:(0,o.jsx)(r.Icon56LogoClipsOutline,{}),header:i[e]??""})}},273507:(e,t,i)=>{i.d(t,{GlobalErrorPlaceholder:()=>n});var o=i(474848),s=i(720836),r=i(525652),a=i(149333);const n=({stretched:e})=>{const t=(0,a.useLangs)();return(0,o.jsx)(s.Placeholder,{stretched:e,icon:(0,o.jsx)(r.Icon56ErrorOutline,{}),header:t.getLang("vkconnect_auth_security_error_title"),children:t.getLang("vkconnect_auth_security_error_text")})}},961113:(e,t,i)=>{i.d(t,{EmptyFeedPlaceholder:()=>o.EmptyFeedPlaceholder,GlobalErrorPlaceholder:()=>s.GlobalErrorPlaceholder});var o=i(104985),s=i(273507)},221666:(e,t,i)=>{i.d(t,{ClipsFeedCarouselControls:()=>s.ClipsFeedCarouselControls,ClipsFeedComponent:()=>s.ClipsFeedComponent,ClipsFeedControlsLayout:()=>s.ClipsFeedControlsLayout,EmptyFeedPlaceholder:()=>o.EmptyFeedPlaceholder,GlobalErrorPlaceholder:()=>o.GlobalErrorPlaceholder,useClipSize:()=>s.useClipSize});var o=i(961113),s=i(330190)},440552:(e,t,i)=>{i.d(t,{StackedList:()=>n});var o=i(474848),s=i(456921),r=i(303800),a=i(591378);const n=(0,s.observer)((({items:e,block:t,ItemComponent:i,spacingByDataType:s={},columnsByDataType:n={},verticalPaddingByDataType:d={},horizontalPaddingByDataType:l={}})=>{const c=n[t.data.data_type],u=s[t.data.data_type]??0,h=d[t.data.data_type]??0,p=l[t.data.data_type]??0;return(0,o.jsx)(r.Div,{mode:"vertical",spacing:p,paddingTop:h,paddingBottom:h,children:(0,o.jsx)(a.Grid,{columns:c??"dynamic",spacing:u,children:e.map(((e,s)=>(0,o.jsx)(a.Grid.Item,{children:(0,o.jsx)(i,{...e,index:s,block:t})},e.id)))})})}))},16481:(e,t,i)=>{i.d(t,{StackedList:()=>o.StackedList});var o=i(440552)},320544:(e,t,i)=>{i.d(t,{CarouselItem:()=>b});var o=i(474848),s=i(93016),r=i(700272),a=i(303800),n=i(107996),d=i(296540),l=i(456921),c=i(132028),u=i(148156),h=i(521344),p=i(927424),_=i(446314),v=i(445902),g=i(954142),m=i(416396);const y=(0,l.observer)((function(){const{video:e,props:t,playingFullScreenStats:i,playerStatus:l,stats:c,videoStalled:y,setVideoStalled:b,videoData:C,restriction:f}=(0,m.useCarouselItemModel)(),{duration:I,setDuration:S,currentTime:P,setCurrentTime:w,newCurrentTime:A,seekHandler:L,seekEndHandler:E,previewStyle:M}=(0,g.usePlayerSeekControl)(e?.data),F=(0,d.useCallback)((e=>c.trackEvents(e)),[c]),k=l.isMuted||Boolean(e?.data.need_mute),x=l.isPlaying,V=t.current.isActive,O=V&&x,{onStalledChanged:T,onVideoCurQualityChanged:j,onVideoDurationChanged:R,onVideoPositionChanged:D,onEnded:B,onVideoFormatChanged:N,onVideoBitrateChanged:U,onFirstBytes:G,onFirstFrame:H}=(0,p.usePlayerStats)({isPlaying:x,isMuted:k,video:e,statsRef:t.current.statsRef},F),z=f.restrictionEnabled?h.ClipsPlayer:u.VideoPlayerWidget,Y=(0,d.useCallback)((e=>{V&&l.setPlaying(e)}),[V]);(0,d.useEffect)((()=>{V&&l.setPlaying(!0)}),[V]);const W=(0,d.useCallback)((e=>{R(e),S(e)}),[R,S]),$=(0,d.useCallback)((e=>{D(e),w(e)}),[D,w]),K=(0,d.useCallback)((e=>{b(e),T(e)}),[T]);if((0,d.useEffect)((()=>(x?i.startTimespent():i.endTimespent(),()=>{i.endTimespent()})),[x]),!e||!e.owner)return null;if(e.data.restriction?.title&&e.data.restriction.text&&Boolean(e.data.restriction?.blur)&&!f.getRemovedRestriction(t.current.videoFullId))return(0,o.jsx)(s.ClipContainer,{...t.current.itemSize,"data-testid":"clips-feed-blur-restricted",size:"large",blurred:!0,mode:"cover",contentIsHidden:!0,cover:e.data.image?.[0].url,centerComponent:(0,o.jsx)(_.ClipPlayerRestrictionForBlurPlaceholder,{title:e.data.restriction?.title,text:e.data.restriction?.text,buttonText:e.data.restriction?.button?.title,onClick:()=>f.setRemovedRestriction(t.current.videoFullId)})});if(Boolean(e.data.content_restricted)&&e.data.restriction?.title)return(0,o.jsx)(s.ClipContainer,{...t.current.itemSize,"data-testid":"clips-feed-item",size:"large",centerComponent:(0,o.jsx)(v.ClipRestrictionPlaceholder,{title:e.data.restriction.title,text:e.data.restriction.text})});const q=(0,h.getClipCover)(e.data,t.current.itemSize),Q=(e.data.width&&e.data.height?e.data.width/e.data.height:9/16)>t.current.itemSize.ratio?"contain":t.current.itemSize.mode;return(0,o.jsx)(s.ClipContainer,{...t.current.itemSize,mode:Q,cover:q,size:"large","data-testid":"clips-feed-item",videoComponent:(0,o.jsx)(z,{loop:!0,muted:k,newCurrentTime:A,onStalledChanged:K,onVideoCurQualityChanged:j,onPlayingChanged:Y,onDurationChanged:W,onCurrentTimeChanged:$,onEnded:B,onFirstBytes:G,onFirstFrame:H,onVideoFormatChanged:N,onVideoBitrateChanged:U,playing:O,video:C,mode:Q,platform:"web"}),centerComponent:V&&y&&(0,o.jsx)(r.Spinner,{size:"large"})||(0,o.jsx)(v.PlayButton,{focused:!y&&t.current.focused,onPlayChange:Y,playing:O}),onClick:()=>Y(!O),timeline:(0,o.jsx)(a.Div,{children:(0,o.jsx)(n.ClipTimeline,{size:"l",currentTime:P,duration:I,onSeek:L,onEndTouch:E,previewStyle:M,ariaLabelText:""})}),badges:(0,o.jsx)(v.ClipBadges,{video:e,disableUrl:"clips"!==t.current.appearance})})})),b=(0,c.createWidget)(m.CarouselItemProvider,y)},84103:(e,t,i)=>{i.d(t,{ClipAudio:()=>h});var o=i(474848),s=i(456921),r=i(538522),a=i(27745),n=i(839812),d=i(293116),l=i(724244),c=i(149333),u=i(863726);const h=(0,s.observer)((function({video:e,disableUrl:t=!1}){const i=(0,c.useLangs)(),s=e.data.short_video_info?.audio,h=s?(0,r.joinRawId)({ownerId:s.owner_id,itemId:s.id}):void 0,p=!h||e.data.owner_id===s?.owner_id,_=s?.content_restricted,v=t||_||!h?void 0:(0,u.getClipsGridSoundUrl)(h),g=!h&&i.getLang("video_unmoderated_original_sound_tooltip")||(_||e.data.need_mute)&&i.getLang("video_clip_restriction_claim_short"),m=g?{text:g,hideDelay:0}:void 0,y=s?.artist||e.owner?.name,b=s?.title||i.getLang("video_original_sound"),C=s?.album?.thumb?.photo_34||e.owner?.data.photo_50;return(0,o.jsx)(n.ClipBadge,{before:p||_?(0,o.jsx)(a.Icon12MusicNote,{}):(0,o.jsx)(d.Image,{size:18,src:C}),href:v,disabled:Boolean(_)||!h,tooltip:m,"data-testid":"clips-controls-audio-info",children:p?i.getLang("video_original_sound"):(0,o.jsxs)(o.Fragment,{children:[!_&&(0,o.jsxs)(o.Fragment,{children:[y,(0,o.jsx)(l.InterpunctSeparator,{spacing:4})]}),b]})})}))},786390:(e,t,i)=>{i.d(t,{ClipAudio:()=>o.ClipAudio});var o=i(84103)},869689:(e,t,i)=>{i.d(t,{ClipBadges:()=>C});var o=i(474848),s=i(456921),r=i(228002),a=i(839812),n=i(538522),d=i(791018),l=i(149333),c=i(725772),u=i(28201),h=i(157307),p=i(487376),_=i(760793),v=i(156006),g=i(478091),m=i(317849),y=i(863726),b=i(786390);const C=(0,s.observer)((function({video:e,disableUrl:t=!1}){const i=(0,l.useLangs)(),s=e.data.short_video_info?.playlists,C=e.data.short_video_info?.compilations,f=e.data.short_video_info?.masks,I=e.data.short_video_info?.effects,S=e.data.short_video_info?.duet,P=e.data.short_video_info?.clickable_stickers?.clickable_stickers[0]?.market_item,w=e.data.short_video_info?.clickable_stickers?.clickable_stickers[0]?.place_info,A=S&&S.owner_id&&S.video_id?(0,n.joinRawId)({ownerId:S.owner_id,itemId:S.video_id}):void 0;return(0,o.jsxs)(r.ClipBadgesLayout,{after:(0,o.jsx)(b.ClipAudio,{video:e,disableUrl:t}),children:[e.data.privacy_view?.category===d.PrivacyAliases.onlyMe?(0,o.jsx)(r.ClipBadgesLayout.Item,{type:"privacy",children:(0,o.jsx)(a.ClipBadge,{before:(0,o.jsx)(c.Icon12Lock,{}),"data-testid":"clips-controls-privacy-badge",children:(0,m.partConfigEnabled)("clips_syncing_clips_with_posts_web")?i.getLang("video_clips_badge_privacy_archive"):i.getLang("video_clips_badge_privacy_only_me")})}):void 0,P&&(0,o.jsx)(r.ClipBadgesLayout.Item,{type:"market",children:(0,o.jsx)(a.ClipBadge,{before:(0,o.jsx)(u.Icon12Market,{}),href:t?void 0:(0,y.getMarketUrl)(P.owner_id,P.id),"data-testid":"clips-controls-market-badge",children:i.getLang("video_clips_badge_market")})}),s&&(0,o.jsx)(r.ClipBadgesLayout.Item,{label:i.getLang("video_clips_badge_playlists"),type:"playlists",icon:(0,o.jsx)(h.Icon12ListPlayOutline,{}),children:s.map((({id:e,owner_id:i,title:s})=>(0,o.jsx)(a.ClipBadge,{before:(0,o.jsx)(h.Icon12ListPlayOutline,{}),href:t?void 0:(0,y.getPlaylistUrl)(i,e),"data-testid":"clips-controls-playlist-badge",children:s},e)))}),C&&(0,o.jsx)(r.ClipBadgesLayout.Item,{label:i.getLang("video_clips_badge_compilations"),type:"compilations",children:C.map((({id:e,name:i})=>(0,o.jsx)(a.ClipBadge,{href:e&&!t?(0,y.getCompilationUrl)(e):void 0,"data-testid":"clips-controls-compilation-badge",children:i},e)))}),w&&(0,o.jsx)(r.ClipBadgesLayout.Item,{type:"place",children:(0,o.jsx)(a.ClipBadge,{before:(0,o.jsx)(p.Icon12Place,{}),href:t?void 0:(0,y.getPlaceUrl)(w.id),"data-testid":"clips-controls-place-badge",children:w.title})}),f&&(0,o.jsx)(r.ClipBadgesLayout.Item,{label:i.getLang("video_clips_badge_masks"),type:"masks",icon:(0,o.jsx)(_.Icon12Mask,{}),children:f.map((({owner_id:e,id:i,name:s})=>(0,o.jsx)(a.ClipBadge,{before:(0,o.jsx)(_.Icon12Mask,{}),href:i&&!t?(0,y.getEffectUrl)((0,n.joinRawId)({ownerId:e,itemId:i})):void 0,"data-testid":"clips-controls-mask-badge",children:s},i)))}),I&&(0,o.jsx)(r.ClipBadgesLayout.Item,{label:i.getLang("video_clips_badge_effects"),type:"effects",icon:(0,o.jsx)(v.Icon12Stars,{}),children:I.map((({owner_id:e,id:i,name:s})=>(0,o.jsx)(a.ClipBadge,{before:(0,o.jsx)(v.Icon12Stars,{}),href:i&&!t?(0,y.getEffectUrl)((0,n.joinRawId)({ownerId:e,itemId:i})):void 0,"data-testid":"clips-controls-effect-badge",children:s},i)))}),S&&(0,o.jsx)(r.ClipBadgesLayout.Item,{type:"duet",children:(0,o.jsxs)(a.ClipBadge,{before:(0,o.jsx)(g.Icon12Play,{}),href:A&&!t?(0,y.getPopupClipUrl)(A):void 0,"data-testid":"clips-controls-duet-badge",children:[i.getLang("video_clips_duet")," ",S.owner_name_case_ins]})})]},e.rawId)}))},837941:(e,t,i)=>{i.d(t,{ClipBadges:()=>o.ClipBadges});var o=i(869689)},334127:(e,t,i)=>{i.d(t,{ClipRestrictionPlaceholder:()=>a});var o=i(474848),s=i(720836),r=i(98967);const a=({title:e,text:t})=>(0,o.jsx)(s.Placeholder,{icon:(0,o.jsx)(r.Icon56LockOutline,{}),header:e,children:e!==t&&t})},548138:(e,t,i)=>{i.d(t,{ClipRestrictionPlaceholder:()=>o.ClipRestrictionPlaceholder});var o=i(334127)},802073:(e,t,i)=>{i.d(t,{PlayButton:()=>c});var o=i(474848),s=i(202350),r=i(271036),a=i(357331),n=i(499979),d=i(296540),l=i(149333);const c=({onPlayChange:e,playing:t,focused:i})=>{const c=(0,l.useLangs)(),u=(0,d.useRef)(null);return(0,d.useEffect)((()=>{i&&u.current?.focus()}),[i]),(0,o.jsx)(s.RoundedGroup.Item,{mode:"overlay",children:(0,o.jsx)(r.IconButton,{getRootRef:u,size:48,label:t?c.getLang("me_convo_player_pause"):c.getLang("me_convo_player_play"),onClick:()=>e(!t),children:t?(0,o.jsx)(a.Icon36Pause,{}):(0,o.jsx)(n.Icon36Play,{})})})}},454549:(e,t,i)=>{i.d(t,{PlayButton:()=>o.PlayButton});var o=i(802073)},445902:(e,t,i)=>{i.d(t,{ClipBadges:()=>o.ClipBadges,ClipRestrictionPlaceholder:()=>s.ClipRestrictionPlaceholder,PlayButton:()=>r.PlayButton});i(786390);var o=i(837941),s=i(548138),r=i(454549)},954142:(e,t,i)=>{i.d(t,{usePlayerSeekControl:()=>o.usePlayerSeekControl});var o=i(778443)},778443:(e,t,i)=>{i.d(t,{usePlayerSeekControl:()=>r});var o=i(296540),s=i(387411);const r=e=>{const[t,i]=(0,o.useState)(0),[r,a]=(0,o.useState)(0),[n,d]=(0,o.useState)(0),[l,c]=(0,o.useState)(),u=(0,o.useRef)(null),h=(0,o.useCallback)((i=>{c(e?.timeline_thumbs&&t?(0,s.getTimelinePreview)(e.timeline_thumbs,i,t):void 0)}),[t]),p=(0,o.useCallback)((e=>{u.current=e,h(e)}),[t]),_=(0,o.useCallback)((()=>{null!==u.current&&(d(u.current),u.current=null)}),[]);return{duration:t,setDuration:i,currentTime:r,setCurrentTime:a,newCurrentTime:n,seekHandler:p,seekEndHandler:_,previewStyle:l}}},387411:(e,t,i)=>{i.d(t,{getTimelinePreview:()=>s});const o=90;function s(e,t,i){const{count_total:s,count_per_image:r,count_per_row:a,frame_width:n,frame_height:d,links:l}=e;if(!(s&&r&&a&&n&&d&&l))return;const c=Math.floor(t/i*s),u=a,h=r/a,p=Math.floor(c/r),_=Math.floor(c%r/u),v=o/n,g=c%r%u*v*-n,m=_*v*-d,y=l[p];return{width:`${o}px`,height:o*d/n+"px",backgroundImage:`url(${y})`,backgroundPosition:`${g}px ${m}px`,backgroundSize:`${u*n*v}px ${h*d*v}px`}}},479245:(e,t,i)=>{i.d(t,{CarouselItem:()=>o.CarouselItem});var o=i(320544)},838218:(e,t,i)=>{i.d(t,{CarouselItemModel:()=>c});var o=i(331635),s=i(327813),r=i(132028),a=i(632520),n=i(509739),d=i(521344),l=i(927424);class c{get video(){return this.shortVideoVideosProvider.get(this.props.current.videoFullId)}get videoData(){return{id:this.video?.data.id,ownerId:this.video?.data.owner_id,files:this.video?.data.files,firstFrames:this.video?.data.first_frame,ovId:this.video?.data.ov_id,trackCode:this.video?.data.track_code,timelineThumbs:this.video?.data.timeline_thumbs}}constructor(e,t,i,o,r,a,n){this.props=e,this.stats=t,this.playerStatus=i,this.shortVideoVideosProvider=o,this.shortVideoDeleteService=r,this.playingFullScreenStats=a,this.restriction=n,this.videoStalled=!0,this.setVideoStalled=e=>{this.videoStalled=e},(0,s.makeAutoObservable)(this)}}c=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.Props?Object:r.Props,void 0===l.ClipsStatsService?Object:l.ClipsStatsService,void 0===d.ClipsPlayerStatusModel?Object:d.ClipsPlayerStatusModel,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider,void 0===n.ShortVideoDeleteService?Object:n.ShortVideoDeleteService,void 0===l.ClipsPlayingFullScreenStatsModel?Object:l.ClipsPlayingFullScreenStatsModel,void 0===d.ClipRestrictionModel?Object:d.ClipRestrictionModel])],c)},416396:(e,t,i)=>{i.d(t,{CarouselItemProvider:()=>r,useCarouselItemModel:()=>a});var o=i(132028),s=i(838218);const{Provider:r,useModel:a}=(0,o.createProvider)(s.CarouselItemModel)},323986:(e,t,i)=>{i.d(t,{ClipsFeedButtons:()=>u});var o=i(474848),s=i(456921),r=i(132028),a=i(202350),n=i(513275),d=i(590193),l=i(131659);const c=(0,s.observer)((function(){const e=(0,l.useClipsFeedButtonsModel)(),t=e.video,i=t?.owner;if(!t||!i)return null;const s=i.isAdmin;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(a.RoundedGroup,{direction:"vertical",gap:16,children:[(0,o.jsx)(d.LikeButton,{toggleLike:e.toggleLike,userLikes:e.likeStatus.userLikes,likesCount:e.likeStatus.likesCount,pending:e.likeStatus.pending}),(0,o.jsx)(d.CommentsButton,{comments:t.data.comments,showComments:e.showComments}),(0,o.jsx)(d.ShareButton,{repostsCount:t.data.reposts?.count,shareVideo:e.shareClip},"share"),(0,o.jsxs)(o.Fragment,{children:[!s&&Boolean(t.data.can_dislike)&&(0,o.jsx)(d.NotInterestedButton,{toggleNotInterested:e.toggleNotInterestedClip,isNotInterested:e.dislikeStatus.userDislikes,pending:e.dislikeStatus.pending},"dislike"),(0,o.jsx)(d.MoreActionsDropdown,{adsErId:e.clipAds?.adsErId,adsUrl:e.clipAds?.adsUrl,shareClip:e.shareClip,deleteClip:e.deleteClip,reportClip:e.reportClip,downloadClip:e.downloadClip,editClip:e.editClip,isVideoOwner:s,copyUrl:e.copyUrl,copyErId:e.copyErId})]})]}),e.isDeleteClipModalActive&&(0,o.jsx)(n.DeleteClipModal,{videoFullId:e.props.current.videoFullId,onClose:e.hideDeleteClipModal})]})})),u=(0,r.createWidget)(l.ClipsFeedButtonsProvider,c)},549224:(e,t,i)=>{i.d(t,{CommentsButton:()=>u});var o=i(474848),s=i(383267),r=i(578392),a=i(202350),n=i(723723),d=i(271036),l=i(149333),c=i(908671);const u=({comments:e,showComments:t})=>{const i=(0,l.useLangs)();return(0,o.jsx)(r.TextTooltip,{text:i.getLang("video_clips_comment"),placement:"right-start",offsetByCrossAxis:8,arrowPadding:12,children:(0,o.jsx)(a.RoundedGroup.Item,{mode:"border",appearance:"default",bottom:(0,o.jsx)("div",{className:(0,n.getColorClass)("color_icon_secondary"),children:e&&(0,c.formatCount)(e)||"0"}),children:(0,o.jsx)(d.IconButton,{size:52,className:(0,n.getColorClass)("color_icon_secondary"),label:i.getLang("video_clips_comment"),onClick:t,"data-testid":"clips-controls-comments-button",children:(0,o.jsx)(s.Icon28CommentOutline,{})})})})}},254552:(e,t,i)=>{i.d(t,{CommentsButton:()=>o.CommentsButton});var o=i(549224)},311126:(e,t,i)=>{i.d(t,{LikeButton:()=>h});var o=i(474848),s=i(509548),r=i(840303),a=i(149333),n=i(578392),d=i(202350),l=i(723723),c=i(271036),u=i(908671);const h=({userLikes:e,pending:t,toggleLike:i,likesCount:h})=>{const p=(0,a.useLangs)();return(0,o.jsx)(n.TextTooltip,{text:p.getLang("video_clips_like"),placement:"right-start",offsetByCrossAxis:8,arrowPadding:12,children:(0,o.jsx)(d.RoundedGroup.Item,{mode:"border",appearance:e?"negative":"default",bottom:(0,o.jsx)("div",{className:e?void 0:(0,l.getColorClass)("color_icon_secondary"),children:h&&(0,u.formatCount)(h)||"0"}),children:(0,o.jsx)(c.IconButton,{size:52,className:(0,l.getColorClass)("color_icon_secondary"),disabled:t,label:p.getLang("video_clips_like"),onClick:i,"data-testid":"clips-controls-like-button",children:e?(0,o.jsx)(s.Icon28LikeFillRed,{}):(0,o.jsx)(r.Icon28LikeOutline,{})})})})}},766421:(e,t,i)=>{i.d(t,{LikeButton:()=>o.LikeButton});var o=i(311126)},558982:(e,t,i)=>{i.d(t,{MoreActionsButton:()=>c});var o=i(474848),s=i(296540),r=i(225853),a=i(202350),n=i(271036),d=i(723723),l=i(149333);const c=(0,s.forwardRef)(((e,t)=>{const i=(0,l.useLangs)();return(0,o.jsx)(a.RoundedGroup.Item,{mode:"border",appearance:"default",getRootRef:t,children:(0,o.jsx)(n.IconButton,{size:52,className:(0,d.getColorClass)("color_icon_secondary"),label:i.getLang("global_more"),"data-testid":"clips-controls-more-actions-button",children:(0,o.jsx)(r.Icon28MoreHorizontal,{})})})}));c.displayName="MoreActionsButton"},882386:(e,t,i)=>{i.d(t,{MoreActionsButton:()=>o.MoreActionsButton});var o=i(558982)},941917:(e,t,i)=>{i.d(t,{MoreActionsDropdown:()=>v});var o=i(474848),s=i(507852),r=i(829713),a=i(485749),n=i(223173),d=i(490639),l=i(405816),c=i(289150),u=i(739483),h=i(296540),p=i(149333),_=i(882386);const v=({isVideoOwner:e,editClip:t,copyUrl:i,shareClip:v,deleteClip:g,reportClip:m,downloadClip:y,adsErId:b,adsUrl:C,copyErId:f})=>{const I=(0,p.useLangs)(),S=(0,h.useRef)(null),P=(0,o.jsxs)(o.Fragment,{children:[e&&(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:t,before:(0,o.jsx)(r.Icon20WriteOutline,{}),"data-testid":"clips-controls-more-actions-edit-link-item",children:I.getLang("global_edit")}),(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:i,before:(0,o.jsx)(a.Icon20CopyOutline,{}),"data-testid":"clips-controls-more-actions-copy-link-item",children:I.getLang("video_copy_video_link")}),(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:v,before:(0,o.jsx)(n.Icon20ShareOutline,{}),"data-testid":"clips-controls-more-actions-share-item",children:I.getLang("global_share")}),e&&(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:g,before:(0,o.jsx)(d.Icon20DeleteOutline,{}),"data-testid":"clips-controls-more-actions-delete-link-item",children:I.getLang("global_delete")}),!e&&(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:m,before:(0,o.jsx)(l.Icon20ReportOutline,{}),"data-testid":"clips-controls-more-actions-report-item",children:I.getLang("global_report_spam")}),(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:y,before:(0,o.jsx)(c.Icon20DownloadOutline,{}),"data-testid":"clips-controls-more-actions-download-item",children:I.getLang("video_download_video_from_modal")}),Boolean(b)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.DropdownActionSheet.Item,{href:C,target:"_blank",before:(0,o.jsx)(u.Icon20LinkCircleOutline,{}),"data-testid":"clips-controls-more-actions-ord-item",children:I.getLang("video_clip_ord_advertiser_info")}),(0,o.jsx)(s.DropdownActionSheet.Item,{onClick:f,before:(0,o.jsx)(a.Icon20CopyOutline,{}),"data-testid":"clips-controls-more-actions-erid-item",children:`ERID: ${b}`})]})]});return(0,o.jsx)(s.DropdownActionSheet,{trigger:"hover",padding:"s",content:P,children:(0,o.jsx)("div",{children:(0,o.jsx)(_.MoreActionsButton,{ref:S})})})}},347743:(e,t,i)=>{i.d(t,{MoreActionsDropdown:()=>o.MoreActionsDropdown});var o=i(941917)},412854:(e,t,i)=>{i.d(t,{NotInterestedButton:()=>u});var o=i(474848),s=i(544129),r=i(222870),a=i(578392),n=i(202350),d=i(271036),l=i(723723),c=i(149333);const u=({toggleNotInterested:e,isNotInterested:t,pending:i})=>{const u=(0,c.useLangs)();return(0,o.jsx)(a.TextTooltip,{text:u.getLang("video_clips_dislike"),placement:"right",children:(0,o.jsx)(n.RoundedGroup.Item,{mode:"border",appearance:"default",children:(0,o.jsx)(d.IconButton,{size:52,className:(0,l.getColorClass)("color_icon_secondary"),label:u.getLang("video_clips_not_interested"),onClick:e,"data-testid":"clips-controls-dislike-button",disabled:i,children:t?(0,o.jsx)(s.Icon28ThumbsDown,{}):(0,o.jsx)(r.Icon28ThumbsDownOutline,{})})})})}},913644:(e,t,i)=>{i.d(t,{NotInterestedButton:()=>o.NotInterestedButton});var o=i(412854)},681766:(e,t,i)=>{i.d(t,{ShareButton:()=>u});var o=i(474848),s=i(709781),r=i(578392),a=i(202350),n=i(723723),d=i(271036),l=i(149333),c=i(908671);const u=({repostsCount:e,shareVideo:t})=>{const i=(0,l.useLangs)();return(0,o.jsx)(r.TextTooltip,{text:i.getLang("global_share"),placement:"right-start",offsetByCrossAxis:8,arrowPadding:12,children:(0,o.jsx)(a.RoundedGroup.Item,{mode:"border",appearance:"default",bottom:(0,o.jsx)("div",{className:(0,n.getColorClass)("color_icon_secondary"),children:e&&(0,c.formatCount)(e)||"0"}),children:(0,o.jsx)(d.IconButton,{size:52,className:(0,n.getColorClass)("color_icon_secondary"),label:i.getLang("global_share"),onClick:t,"data-testid":"clips-controls-share-button",children:(0,o.jsx)(s.Icon28ShareOutline,{})})})})}},537789:(e,t,i)=>{i.d(t,{ShareButton:()=>o.ShareButton});var o=i(681766)},590193:(e,t,i)=>{i.d(t,{CommentsButton:()=>s.CommentsButton,LikeButton:()=>o.LikeButton,MoreActionsDropdown:()=>n.MoreActionsDropdown,NotInterestedButton:()=>a.NotInterestedButton,ShareButton:()=>r.ShareButton});var o=i(766421),s=i(254552),r=i(537789),a=(i(882386),i(913644)),n=i(347743)},290340:(e,t,i)=>{i.d(t,{ClipsFeedButtons:()=>o.ClipsFeedButtons});var o=i(323986)},141014:(e,t,i)=>{i.d(t,{ClipsFeedButtonsModel:()=>I});var o=i(331635),s=i(327813),r=i(132028),a=i(768035),n=i(632520),d=i(905683),l=i(670252),c=i(712600),u=i(24516),h=i(955060),p=i(413206),_=i(8520),v=i(537603),g=i(571117),m=i(606028),y=i(666082),b=i(854140),C=i(521344),f=i(513275);class I{get video(){return this.shortVideoVideosProvider.get(this.props.current.videoFullId)}get clipAds(){if(this.video){const e=this.video.data.ord_info?.advertisers[0],t=this.video.data.ads_info;return{adsUrl:e?.url||t?.advertiser_info_url,adsErId:e?.er_id||t?.ad_marker}}}get likeStatus(){const e=this.shortVideoLikeService.getLikes(this.props.current.videoFullId);return{likesCount:e?.count,userLikes:e?.userLikes??!1,pending:this.shortVideoLikeService.isPending(this.props.current.videoFullId)}}get dislikeStatus(){return{userDislikes:this.shortVideoLikeService.isNotInterested(this.props.current.videoFullId),pending:this.shortVideoLikeService.isPending(this.props.current.videoFullId)}}async reloadClip(){const e=this.shortVideoVideosProvider.get(this.props.current.videoFullId);await this.shortVideoVideosProvider.fetch({videos:`${this.props.current.videoFullId}`,fields:C.VIDEO_FETCH_FIELDS.join(","),extended:1});const t=this.shortVideoVideosProvider.get(this.props.current.videoFullId);t&&e&&this.props.current.onEdit&&this.props.current.onEdit(t,e)}getSharedClipFullUrl(e){return`${window.location.origin}/clip${e}`}constructor(e,t,i,o,r,n,d,l){this.props=e,this.snackbar=t,this.lang=i,this.userEnv=o,this.errorLogger=r,this.shortVideoApi=n,this.shortVideoVideosProvider=d,this.shortVideoLikeService=l,this.isDeleteClipModalActive=!1,this.hideDeleteClipModal=()=>{this.isDeleteClipModalActive=!1},this.toggleLike=async()=>{const e=this.likeStatus.userLikes;await this.shortVideoLikeService.toggleLike(this.props.current.videoFullId),e||this.props.current.onLikeAdded?.()},this.toggleNotInterestedClip=async()=>{try{await this.shortVideoLikeService.toggleNotInterested(this.props.current.videoFullId)&&this.shortVideoLikeService.isNotInterested(this.props.current.videoFullId)&&(this.props.current.onDislikeAdded?.(),this.snackbar.show({type:"ok",text:this.lang.getLang("video_clips_after_dislike_snackbar"),duration:3e3}))}catch(e){this.errorLogger.log(e)}},this.showComments=()=>{this.props.current.onShowComments?.()},this.downloadClip=async()=>{const{ownerId:e,id:t}=(0,a.parseRawId)(this.props.current.videoFullId);v.clipDownloadStatsCollector.logEvent({type_clips_download_click_item:{download_quality:C.Q_1080P,download_state:g.ClipDownloadStateTypes.STARTED,owner_id:e,video_id:t},event_type:g.ClipDownloadEventTypes.DOWNLOAD_STATE_CHANGE,video_owner_id:e,video_id:t}),this.props.current.onDownload?.();try{const{download_url:i}=await this.shortVideoApi.getDownloadUrl({owner_id:e,video_id:t,quality:C.Q_1080P});window.open(i)}catch(e){this.errorLogger.log(e),this.snackbar.show({type:"error",text:this.lang.getLang("video_clip_download_failed"),duration:3e3})}},this.shareClip=()=>{m.Likes.share(`clip${this.props.current.videoFullId}`,{}),this.props.current.onShare?.()},this.reportClip=()=>{const{ownerId:e,id:t}=(0,a.parseRawId)(this.props.current.videoFullId);(0,b.showReportForm)("video",e,t)},this.editClip=()=>{const{ownerId:e,id:t}=(0,a.parseRawId)(this.props.current.videoFullId);this.userEnv.partConfigEnabled("clips_syncing_clips_with_posts_web")?(0,f.initEditClipModal)(this.props.current.videoFullId,(()=>{this.reloadClip()})):(0,y.showBox)("al_video.php?act=edit_box",{vid:t,oid:e,is_short_video:1},{params:{onHide:()=>{this.reloadClip()}},containerClass:"video_edit",stat:[window.jsc("web/privacy.js"),"privacy.css",window.jsc("web/video.js"),"video.css",window.jsc("web/video_upload.js"),"video_edit.css",window.jsc("web/upload.js"),"video_showcase.css"]})},this.deleteClip=()=>{this.isDeleteClipModalActive=!0},this.copyUrl=async()=>{await(0,_.copyTextToClipboard)(this.getSharedClipFullUrl(this.props.current.videoFullId)),this.snackbar.show({type:"ok",text:this.lang.getLang("video_clip_copied_to_clipboard")})},this.copyErId=async()=>{const e=this.clipAds?.adsErId;e&&(await(0,_.copyTextToClipboard)(e),this.snackbar.show({type:"ok",text:this.lang.getLang("video_clip_ord_copied_to_clipboard")}))},(0,s.makeAutoObservable)(this)}}I=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.Props?Object:r.Props,void 0===l.Snackbar?Object:l.Snackbar,void 0===c.Langs?Object:c.Langs,void 0===u.UserEnv?Object:u.UserEnv,void 0===h.ErrorLogger?Object:h.ErrorLogger,void 0===p.ShortVideoApi?Object:p.ShortVideoApi,void 0===n.ShortVideoVideosProvider?Object:n.ShortVideoVideosProvider,void 0===d.ShortVideoLikeService?Object:d.ShortVideoLikeService])],I)},131659:(e,t,i)=>{i.d(t,{ClipsFeedButtonsProvider:()=>r,useClipsFeedButtonsModel:()=>a});var o=i(132028),s=i(141014);const{Provider:r,useModel:a}=(0,o.createProvider)(s.ClipsFeedButtonsModel)},422996:(e,t,i)=>{i.d(t,{ClipsPlayerButtons:()=>v});var o=i(474848),s=i(456921),r=i(578392),a=i(202350),n=i(271036),d=i(723723),l=i(217157),c=i(54472),u=i(149333),h=i(132028),p=i(29942);const _=(0,s.observer)((function(){const{isMuted:e,isForceMuted:t,toggleMute:i}=(0,p.useClipsPlayerButtonsModel)(),s=(0,u.useLangs)(),h=e?s.getLang("video_volume_on"):s.getLang("video_volume_off");return(0,o.jsx)(r.TextTooltip,{text:t?s.getLang("video_clip_sound_restriction_default2"):h,placement:"right",children:(0,o.jsx)(a.RoundedGroup.Item,{mode:"border",appearance:"default",children:(0,o.jsx)(n.IconButton,{size:52,className:(0,d.getColorClass)("color_icon_secondary"),label:t?s.getLang("video_clip_sound_restriction_default2"):h,onClick:i,"data-testid":"clips-controls-mute-button",disabled:t,children:e||t?(0,o.jsx)(l.Icon28MuteOutline,{}):(0,o.jsx)(c.Icon28VolumeOutline,{})})})})})),v=(0,h.createWidget)(p.ClipsPlayerButtonsProvider,_)},216855:(e,t,i)=>{i.d(t,{ClipsPlayerButtons:()=>o.ClipsPlayerButtons});var o=i(422996)},445462:(e,t,i)=>{i.d(t,{ClipsPlayerButtonsModel:()=>d});var o=i(331635),s=i(327813),r=i(632520),a=i(132028),n=i(521344);class d{get isForceMuted(){const e=this.props.current.videoFullId;return Boolean(!!e&&this.shortVideoVideosProvider.get(e)?.data.need_mute)}get isMuted(){return this.playerStatus.isMuted}constructor(e,t,i){this.props=e,this.shortVideoVideosProvider=t,this.playerStatus=i,this.toggleMute=()=>{this.playerStatus.toggleMute()},(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([a.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.Props?Object:a.Props,void 0===r.ShortVideoVideosProvider?Object:r.ShortVideoVideosProvider,void 0===n.ClipsPlayerStatusModel?Object:n.ClipsPlayerStatusModel])],d)},29942:(e,t,i)=>{i.d(t,{ClipsPlayerButtonsProvider:()=>r,useClipsPlayerButtonsModel:()=>a});var o=i(132028),s=i(445462);const{Provider:r,useModel:a}=(0,o.createProvider)(s.ClipsPlayerButtonsModel)},687020:(e,t,i)=>{i.d(t,{DeleteClipModal:()=>g});var o=i(474848),s=i(456921),r=i(694244),a=i(782174),n=i(753457),d=i(63614),l=i(908242),c=i(454154),u=i(149333),h=i(132028),p=i(835077),_=i(968324);const v=(0,s.observer)((function(){const e=(0,_.useDeleteClipModalModel)(),t=(0,u.useLangs)();return(0,o.jsx)(p.MessageBoxModal,{onDestroy:e.props.current.onClose,width:550,children:({onClose:i})=>(0,o.jsxs)(r.ModalBox,{children:[(0,o.jsx)(a.ModalHeader,{onClose:i,closeAriaLabel:t.getLang("global_close"),children:(0,o.jsx)(n.Paragraph,{weight:"2",children:t.getLang("video_clips_remove_own_video_alert_title")})}),(0,o.jsx)(d.ModalBody,{insetLevel:2,children:t.getLang("video_clips_remove_own_video_alert_desc")}),(0,o.jsx)(l.ModalFooter,{before:(0,o.jsx)(c.Button,{size:"m",mode:"tertiary",onClick:()=>{e.deleteClip(),i()},children:t.getLang("global_delete")}),actions:(0,o.jsx)(c.Button,{size:"m",mode:"secondary",onClick:i,children:t.getLang("global_close")})})]})})})),g=(0,h.createWidget)(_.DeleteClipModalProvider,v)},275066:(e,t,i)=>{i.d(t,{DeleteClipModal:()=>o.DeleteClipModal});var o=i(687020)},405897:(e,t,i)=>{i.d(t,{DeleteClipModalModel:()=>n});var o=i(331635),s=i(327813),r=i(132028),a=i(509739);class n{deleteClip(){return this.shortVideoDeleteService.delete(this.props.current.videoFullId)}constructor(e,t){this.shortVideoDeleteService=e,this.props=t,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.ShortVideoDeleteService?Object:a.ShortVideoDeleteService,void 0===r.Props?Object:r.Props])],n)},968324:(e,t,i)=>{i.d(t,{DeleteClipModalProvider:()=>r,useDeleteClipModalModel:()=>a});var o=i(132028),s=i(405897);const{Provider:r,useModel:a}=(0,o.createProvider)(s.DeleteClipModalModel)},39324:(e,t,i)=>{i.d(t,{EditClipModal:()=>y});var o=i(474848),s=i(456921),r=i(132028),a=i(149333),n=i(28928),d=i(694244),l=i(782174),c=i(63614),u=i(524378),h=i(44544),p=i(908242),_=i(454154),v=i(529801),g=i(849020);const m=(0,s.observer)((function(){const e=(0,a.useLangs)(),t=(0,v.useEditClipModalModel)(),{isInitialized:i,pending:s,description:r,isOrdEditable:m,ordInfo:y,isPostponed:b,publishDate:C,disabledSave:f,save:I,setDescription:S,setOrdInfo:P,setPublishDate:w}=t,{onClose:A}=t.props.current;return i?(0,o.jsxs)(d.ModalBox,{children:[(0,o.jsx)(l.ModalHeader,{onClose:A,closeAriaLabel:e.getLang("global_close"),children:e.getLang("video_clip_edit_title")}),(0,o.jsx)(c.ModalBody,{insetLevel:1,children:(0,o.jsxs)(u.FormLayout,{disabled:s,children:[(0,o.jsx)(g.DescriptionBlock,{onChange:S,text:r,disabled:s,placeholder:e.getLang("video_clip_upload_description_placeholder")}),b&&(0,o.jsx)(g.PublishDateInput,{publishDate:C,setPublishDate:w}),m&&(0,o.jsx)(h.FormItem,{children:(0,o.jsx)(g.OrdInfoSection,{ordData:y,isSaving:s,onChange:P})})]})}),(0,o.jsx)(p.ModalFooter,{actions:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(_.Button,{mode:"tertiary",size:"m",onClick:A,children:e.getLang("global_cancel")}),(0,o.jsx)(_.Button,{size:"m",loading:s,onClick:I,disabled:f,children:e.getLang("global_save")})]})})]}):(0,o.jsx)(n.ScreenSpinner,{size:"medium"})})),y=(0,r.createWidget)(v.EditClipModalProvider,m)},610257:(e,t,i)=>{i.d(t,{DescriptionBlock:()=>c});var o=i(474848),s=i(296540),r=i(149333),a=i(317849),n=i(44544),d=i(945206);const l=(0,a.getConfigValue)("clips_description_max_length")??4e3,c=({text:e,onChange:t,disabled:i,placeholder:a})=>{const c=(0,r.useLangs)(),u=(0,s.useRef)(null);return(0,s.useEffect)((()=>{u.current&&(u.current.focus(),u.current.setSelectionRange(u.current.value.length,u.current.value.length))}),[u]),(0,o.jsx)(n.FormItem,{top:c.getLang("video_descr"),htmlFor:"clipDescription",bottom:l&&e.length>l-100?c.numeric(l-e.length,c.getLang("text_N_symbols_remain",!0)):"",children:(0,o.jsx)(d.Textarea,{id:"clipDescription",placeholder:a,value:e,onChange:e=>t(e.target.value),maxLength:l,"data-testid":"clips-upload-description",disabled:i,getRef:u})})}},288086:(e,t,i)=>{i.d(t,{DescriptionBlock:()=>o.DescriptionBlock});var o=i(610257)},819459:(e,t,i)=>{i.d(t,{OrdInfoSection:()=>u});var o=i(474848),s=i(149333),r=i(140083),a=i(260546),n=i(723723),d=i(901634),l=i(280246);const c=(e=!0)=>{const t=e?"visible":"hidden",i=e?"1":"0",o=e?"500":"1000",s=window.videoview?.isLayerShown();window.boxLayerWrap&&(window.boxLayerWrap.style.visibility=t,window.boxLayerWrap.style.opacity=i),window.boxLayerBG&&(s?window.wkLayerWrap&&(window.wkLayerWrap.style.zIndex=o):window.boxLayerBG.style.visibility=t),e&&s&&window.layerBG&&(window.layerBG.style.display="block")},u=({ordData:e,onChange:t,isSaving:i})=>{const u=(0,s.useLangs)();return(0,o.jsx)(a.SimpleCell,{Component:"label",multiline:!0,subtitle:e?.is_ads?u.getLang("mobile_video_clips_upload_ord_subtitle_added"):u.getLang("mobile_video_clips_upload_ord_subtitle_empty"),after:(0,o.jsx)(r.Icon24ChevronCompactRight,{className:(0,n.getColorClass)("color_icon_tertiary")}),onClick:()=>{let i=null;window.videoview?.isLayerShown()&&window.layers&&(i=window.layers.fullhide,window.layers.fullhide=!1),(0,d.handleOrdMiniappOpen)((0,l.videoOrdInfoParamsToOrdData)(e),(e=>t((0,l.ordDataToVideoOrdInfoParams)(e))),{isSnackbar:!1,edit:!1,options:{noLocChange:1,skipBoxesHide:1,noClickHide:1,onLoaded:()=>c(!1),onHide:()=>{c(),i&&(window.layers.fullhide=i)},onFail:()=>c()}})},"data-testid":"clips-edit-ord",disabled:i,children:u.getLang("video_upload_ord_label")})}},152527:(e,t,i)=>{i.d(t,{OrdInfoSection:()=>o.OrdInfoSection});var o=i(819459)},280246:(e,t,i)=>{function o(e){return e?.is_ad?{is_ads:e.is_ad,advertisers:[{ord_pred_id:e.ord_pred_id,er_id:e.erid}]}:null}function s(e){return e?.is_ads?{is_ad:!0,ord_pred_id:e.advertisers[0].ord_pred_id,erid:e.advertisers[0].er_id}:null}i.d(t,{ordDataToVideoOrdInfoParams:()=>o,videoOrdInfoParamsToOrdData:()=>s})},794969:(e,t,i)=>{i.d(t,{PublishDateInput:()=>p});var o=i(474848),s=i(27813),r=i(149333),a=i(912499),n=i(296540),d=i(44544),l=i(753457),c=i(271036),u=i(723723),h=i(679804);const p=({publishDate:e,setPublishDate:t,disabled:i})=>{const{getLang:p}=(0,r.useLangs)(),_=(0,n.useRef)(null),[v,g]=(0,n.useState)(!1),m=e&&(0,s.default)(e,new Date)?p("video_postpone_date_error"):"",y=(0,n.useCallback)((()=>{const e=new Date;e.setHours(e.getHours()+1),t(e),g(!0)}),[]);return(0,n.useEffect)((()=>{e&&_.current&&v&&(_.current.click(),g(!1))}),[v]),(0,o.jsx)(d.FormItem,{htmlFor:"postponeDate",top:p("video_publication_time_label"),status:m?"error":"default",bottom:m,"data-testid":"clips-edit-publish-date",children:e?(0,o.jsx)(l.DateInput,{id:"postponeDate",value:e,onChange:t,closeOnChange:!1,enableTime:!0,disablePast:!0,showNeighboringMonth:!0,shouldDisableDate:a.shouldDisableDate,disabled:i,getRootRef:_}):(0,o.jsx)(l.Input,{readOnly:!0,value:p("video_upload_now"),onClick:y,after:(0,o.jsx)(c.IconButton,{hasHover:!1,onClick:y,label:p("mobile_video_clips_upload_publish_time_reset"),children:(0,o.jsx)(h.Icon20CalendarOutline,{className:(0,u.getColorClass)("color_icon_secondary")})}),disabled:i})})}},528760:(e,t,i)=>{i.d(t,{PublishDateInput:()=>o.PublishDateInput});var o=i(794969)},849020:(e,t,i)=>{i.d(t,{DescriptionBlock:()=>o.DescriptionBlock,OrdInfoSection:()=>s.OrdInfoSection,PublishDateInput:()=>r.PublishDateInput});var o=i(288086),s=i(152527),r=i(528760)},908987:(e,t,i)=>{i.r(t),i.d(t,{EditClipModal:()=>s.EditClipModal,initEditClipModal:()=>o.initEditClipModal});var o=i(985186),s=i(39324)},985186:(e,t,i)=>{i.d(t,{initEditClipModal:()=>n});var o=i(474848),s=i(220428),r=i(835077),a=i(39324);const n=(e,t)=>{(0,r.showMessageBoxModal)((i=>(0,o.jsx)(s.DIRootWebProvider,{children:(0,o.jsx)(a.EditClipModal,{...i,videoFullId:e,callback:t})})),{width:495})}},728013:(e,t,i)=>{i.d(t,{EditClipModalModel:()=>d});var o=i(331635),s=i(132028),r=i(327813),a=i(632520),n=i(27813);class d{async[s.init](){await this.fetchVideo(),this.newDescription=this.video?.data.description??"",this.video?.data.published_at&&(this.newPublishDate=new Date(1e3*this.video?.data.published_at)),this.isInitialized=!0}async fetchVideo(){await this.shortVideoVideosProvider.fetch({videos:this.props.current.videoFullId},{})}get pending(){return this.shortVideoVideosProvider.isPending(this.props.current.videoFullId)||this.callbackPending}get video(){return this.shortVideoVideosProvider.get(this.props.current.videoFullId)}get description(){return this.newDescription}get isOrdEditable(){return!this.video?.data.ord_info}get ordInfo(){return this.newOrdInfo}get isPostponed(){return Boolean(this.video?.data.published_at)}get publishDate(){return this.newPublishDate}get disabledSave(){return!!this.publishDate&&(0,n.default)(this.publishDate,new Date)}constructor(e,t){this.props=e,this.shortVideoVideosProvider=t,this.isInitialized=!1,this.newDescription="",this.newOrdInfo=null,this.newPublishDate=void 0,this.callbackPending=!1,this.setDescription=e=>{this.newDescription=e},this.setOrdInfo=e=>{this.newOrdInfo=e},this.setPublishDate=e=>{this.newPublishDate=e},this.save=async()=>{if(!this.video||!this.video.data.id||!this.video.data.owner_id)return;this.callbackPending=Boolean(this.props.current.callback);const e={video_id:this.video.data.id,owner_id:this.video.data.owner_id,description:this.description,publish_date:this.publishDate?Math.trunc(this.publishDate.getTime()/1e3):0};null!==this.ordInfo&&(e.ord_info=JSON.stringify(this.ordInfo)),await this.shortVideoVideosProvider.update(e,{}),await(this.props.current.callback?.({wallPostId:this.video.data.wall_post_id,ownerId:this.video.data.owner_id,description:this.description})),this.props.current.onClose()},(0,r.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===a.ShortVideoVideosProvider?Object:a.ShortVideoVideosProvider])],d)},529801:(e,t,i)=>{i.d(t,{EditClipModalProvider:()=>r,useEditClipModalModel:()=>a});var o=i(132028),s=i(728013);const{Provider:r,useModel:a}=(0,o.createProvider)(s.EditClipModalModel)},513275:(e,t,i)=>{i.d(t,{CarouselItem:()=>a.CarouselItem,ClipsFeedButtons:()=>s.ClipsFeedButtons,ClipsPlayerButtons:()=>n.ClipsPlayerButtons,DeleteClipModal:()=>r.DeleteClipModal,initEditClipModal:()=>o.initEditClipModal});var o=i(908987),s=i(290340),r=i(275066),a=i(479245),n=i(216855)},450224:(e,t,i)=>{i.d(t,{PlaylistDeleteModal:()=>h});var o=i(474848),s=i(456921),r=i(454154),a=i(694244),n=i(782174),d=i(63614),l=i(908242),c=i(149333),u=i(603817);const h=(0,s.observer)((function(){const e=(0,c.useLangs)(),t=(0,u.usePlaylistDeleteModel)(),{body:i,buttons:s,title:h}=t.error?{body:e.getLang("video_playlist_deleting_error_text"),buttons:(0,o.jsx)(r.Button,{mode:"primary",size:"m",onClick:t.onClose,children:e.getLang("global_close")}),title:e.getLang("global_error")}:{body:e.getLang("video_delete_playlist_are_you_sure"),buttons:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.Button,{mode:"tertiary",size:"m",onClick:t.onClose,children:e.getLang("global_cancel")}),(0,o.jsx)(r.Button,{loading:t.isLoading,mode:"primary",size:"m",onClick:t.delete,children:e.getLang("global_delete")})]}),title:e.getLang("video_delete_playlist_title")};return(0,o.jsxs)(a.ModalBox,{children:[(0,o.jsx)(n.ModalHeader,{onClose:t.onClose,closeAriaLabel:e.getLang("global_close"),children:h}),(0,o.jsx)(d.ModalBody,{insetLevel:2,children:i}),(0,o.jsx)(l.ModalFooter,{actions:s})]})}))},857e3:(e,t,i)=>{i.d(t,{PlaylistDeleteModalWidget:()=>a});var o=i(132028),s=i(450224),r=i(603817);const a=(0,o.createWidget)(r.PlaylistDeleteModelProvider,s.PlaylistDeleteModal)},22738:(e,t,i)=>{i.r(t),i.d(t,{showPlaylistDeleteModal:()=>o.showPlaylistDeleteModal});var o=i(379061)},8779:(e,t,i)=>{i.d(t,{PlaylistDeleteModel:()=>n});var o=i(331635),s=i(327813),r=i(132028),a=i(627016);class n{get isLoading(){return this._isLoading}get error(){return this._error}get onClose(){return this.props.current.onClose}[r.destroy](){this._abortController?.abort()}constructor(e,t){this.props=e,this.playlistsProvider=t,this.delete=async()=>{this._isLoading=!0,this._abortController?.abort(),this._abortController=new AbortController;try{await this.playlistsProvider.delete({id:this.props.current.id,ownerId:this.props.current.ownerId},{signal:this._abortController.signal}),this.props.current.onClose(),this.props.current.onDelete?.()}catch(e){(0,s.runInAction)((()=>{this._error=e}))}finally{(0,s.runInAction)((()=>{this._isLoading=!1}))}},this._abortController=null,this._isLoading=!1,this._error=null,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.Props?Object:r.Props,void 0===a.VideoPlaylistsProvider?Object:a.VideoPlaylistsProvider])],n)},603817:(e,t,i)=>{i.d(t,{PlaylistDeleteModelProvider:()=>r,usePlaylistDeleteModel:()=>a});var o=i(132028),s=i(8779);const{Provider:r,useModel:a}=(0,o.createProvider)(s.PlaylistDeleteModel)},379061:(e,t,i)=>{i.d(t,{showPlaylistDeleteModal:()=>n});var o=i(474848),s=i(835077),r=i(220428),a=i(857e3);const n=e=>{(0,s.showMessageBoxModal)((t=>(0,o.jsx)(r.DIRootWebProvider,{children:(0,o.jsx)(a.PlaylistDeleteModalWidget,{...e,...t})})),{width:420})}},553836:(e,t,i)=>{i.d(t,{PlaylistErrorModal:()=>n});var o=i(474848),s=i(915424),r=i(454154),a=i(149333);const n=({onClose:e,error:t})=>{const i=(0,a.useLangs)(),n="type"in t&&"network_error"===t.type,d=n?i.getLang("video_playlist_popup_connection_error_header"):i.getLang("video_playlist_popup_loading_error_header"),l=n?i.getLang("video_playlist_popup_connection_error_subheader"):i.getLang("video_playlist_popup_loading_error_subheader");return(0,o.jsx)(s.ModalCardBase,{onClose:e,header:d,subheader:l,actions:(0,o.jsx)(r.Button,{size:"l",mode:"secondary",stretched:!0,onClick:()=>window.location.reload(),children:i.getLang("video_playlist_popup_error_reload_button")})})}},363369:(e,t,i)=>{i.d(t,{PlaylistErrorModal:()=>o.PlaylistErrorModal});var o=i(553836)},78080:(e,t,i)=>{i.d(t,{PlaylistModal:()=>b});var o=i(474848),s=i(296540),r=i(456921),a=i(835077),n=i(468073),d=i(694244),l=i(63614),c=i(132028),u=i(363369),h=i(876670),p=i(411555),_=i(896577),v=i(448360),g=i(53157),m=i(703838);const y=(0,r.observer)((function(){const{error:e,resetError:t,isInfoLoading:i,props:r,updateInfoModel:{canUploadThumb:c},privacyModel:{error:y,formModalVisibility:{isShown:b},friendsModalVisibility:{isShown:C}}}=(0,m.usePlaylistModel)(),f=n.Ranges.isGroupId(r.current.ownerId);return(0,s.useEffect)((()=>{r.current.refreshCoordinates()}),[e,i,b,C]),e?(0,o.jsx)(u.PlaylistErrorModal,{error:e,onClose:y?r.current.onClose:t}):i?(0,o.jsx)(a.MessageBoxModalLoader,{refreshCoordinates:r.current.refreshCoordinates}):b?(0,o.jsx)(_.PlaylistModalPrivacyFormModal,{}):C?(0,o.jsx)(_.PlaylistModalPrivacyFriendsModal,{}):(0,o.jsxs)(d.ModalBox,{children:[(0,o.jsx)(h.PlaylistModalHeader,{}),(0,o.jsxs)(l.ModalBody,{insetLevel:1,children:[(0,o.jsx)(p.PlaylistModalTitle,{}),c&&(0,o.jsx)(g.PlaylistModalThumb,{}),!f&&(0,o.jsx)(_.PlaylistModalPrivacy,{})]}),(0,o.jsx)(v.PlaylistModalFooter,{})]})})),b=(0,c.createWidget)(m.PlaylistModelProvider,y)},411632:(e,t,i)=>{i.d(t,{PlaylistModalFooter:()=>l});var o=i(474848),s=i(456921),r=i(908242),a=i(454154),n=i(149333),d=i(703838);const l=(0,s.observer)((function(){const e=(0,n.useLangs)(),{handleSubmit:t,isLoading:i,props:s}=(0,d.usePlaylistModel)();return(0,o.jsx)(r.ModalFooter,{actions:[(0,o.jsx)(a.Button,{mode:"secondary",size:"m",onClick:s.current.onClose,children:e.getLang("box_cancel")},1),(0,o.jsx)(a.Button,{mode:"primary",size:"m",onClick:t,loading:i,children:e.getLang("Save")},2)]})}))},448360:(e,t,i)=>{i.d(t,{PlaylistModalFooter:()=>o.PlaylistModalFooter});var o=i(411632)},473188:(e,t,i)=>{i.d(t,{PlaylistModalHeader:()=>d});var o=i(474848),s=i(456921),r=i(782174),a=i(149333),n=i(703838);const d=(0,s.observer)((function(){const e=(0,a.useLangs)(),{props:t}=(0,n.usePlaylistModel)();return(0,o.jsx)(r.ModalHeader,{closeAriaLabel:e.getLang("box_cancel"),onClose:t.current.onClose,children:t.current.playlist?e.getLang("video_edit_playlist_title"):e.getLang("video_create_playlist_title")})}))},876670:(e,t,i)=>{i.d(t,{PlaylistModalHeader:()=>o.PlaylistModalHeader});var o=i(473188)},115300:(e,t,i)=>{i.d(t,{PlaylistModalPrivacy:()=>d});var o=i(474848),s=i(456921),r=i(512143),a=i(149333),n=i(703838);const d=(0,s.observer)((function(){const e=(0,a.useLangs)(),{privacyModel:{privacy:t,setPrivacy:i,friendsModel:s,friendsListsModel:d,isProfileClosed:l,formModalVisibility:{toggleShown:c},friendsModalVisibility:{toggleShown:u}}}=(0,n.usePlaylistModel)();return(0,o.jsx)(r.PrivacyDropdown,{placement:"right",title:e.getLang("video_playlist_settings_privacy_view"),privacy:t,setPrivacy:i,isProfileClosed:l,friends:s.friends,friendsLists:d.friendsLists,onClickExceptFriends:c,onClickSomeFriends:u})}))},249011:(e,t,i)=>{i.d(t,{PlaylistModalPrivacyFormModal:()=>n});var o=i(474848),s=i(456921),r=i(512143),a=i(703838);const n=(0,s.observer)((function(){const{privacyModel:{privacy:e,setPrivacy:t,friendsListsModel:i,friendsModel:s,isProfileClosed:n,formModalVisibility:{toggleShown:d}}}=(0,a.usePlaylistModel)();return(0,o.jsx)(r.PrivacyFormModal,{privacy:e,setPrivacy:t,friends:s.friends,friendsLists:i.friendsLists,setFriends:s.setFriends,isProfileClosed:n,onDestroy:d})}))},945790:(e,t,i)=>{i.d(t,{PlaylistModalPrivacyFriendsModal:()=>n});var o=i(474848),s=i(456921),r=i(512143),a=i(703838);const n=(0,s.observer)((function(){const{privacyModel:{privacy:e,friendsModel:t,setPrivacy:i,friendsModalVisibility:{toggleShown:s}}}=(0,a.usePlaylistModel)();return(0,o.jsx)(r.PrivacyFriendsModal,{privacy:e,setPrivacy:i,friends:t.friends,setFriends:t.setFriends,onDestroy:s})}))},896577:(e,t,i)=>{i.d(t,{PlaylistModalPrivacy:()=>o.PlaylistModalPrivacy,PlaylistModalPrivacyFormModal:()=>s.PlaylistModalPrivacyFormModal,PlaylistModalPrivacyFriendsModal:()=>r.PlaylistModalPrivacyFriendsModal});var o=i(115300),s=i(249011),r=i(945790)},967340:(e,t,i)=>{i.d(t,{PlaylistModalTitle:()=>l});var o=i(474848),s=i(456921),r=i(44544),a=i(753457),n=i(149333),d=i(703838);const l=(0,s.observer)((function(){const e=(0,n.useLangs)(),{title:t,titleError:i,setTitle:s}=(0,d.usePlaylistModel)();return(0,o.jsx)(r.FormItem,{top:e.getLang("video_playlist_name_placeholder"),children:(0,o.jsx)(a.Input,{value:t,status:i?"error":"default",placeholder:e.getLang("video_create_playlist_placeholder"),onChange:e=>s(e.target.value)})})}))},411555:(e,t,i)=>{i.d(t,{PlaylistModalTitle:()=>o.PlaylistModalTitle});var o=i(967340)},977867:(e,t,i)=>{i.d(t,{PlaylistModal:()=>o.PlaylistModal,showPlaylistModal:()=>s.showPlaylistModal});var o=i(78080),s=i(790733)},8097:(e,t,i)=>{i.d(t,{PlaylistModalVisibility:()=>s});var o=i(327813);class s{get isShown(){return this.value}constructor(e=!1){this.value=e,this.toggleShown=()=>{this.value=!this.value},(0,o.makeAutoObservable)(this)}}},31411:(e,t,i)=>{i.d(t,{PlaylistModel:()=>S});var o=i(331635),s=i(474848),r=i(327813),a=i(873900),n=i(818515),d=i(639370),l=i(301250),c=i(3969),u=i(891999),h=i(627016),p=i(233981),_=i(132028),v=i(712600),g=i(670252),m=i(882044),y=i(951652),b=i(213810),C=i(708003),f=i(425974),I=i(782475);class S{get title(){return this._title}get titleError(){return this._titleError}get error(){return this._error||this.privacyModel.error}get isLoading(){return Boolean(this._abortController)}get isInfoLoading(){return this.updateInfoModel.isLoading||this.privacyModel.isLoading}[_.init](){this.updateInfoModel.fetchInfo(),this.privacyModel.fetchPrivacy()}[_.destroy](){this._abortController?.abort(),this.privacyModel.dispose(),this.updateInfoModel.dispose()}validateTitle(){""===this._title.trim()&&(this._titleError=!0)}constructor(e,t,i,o,l,c,u,h,p,_){this.langs=e,this.snackbar=t,this.videoApi=i,this.authService=o,this.friendsService=l,this.friendsListsProvider=c,this.usersProvider=u,this.playlistsProvider=h,this.thumbProvider=p,this.props=_,this.updateInfoModel=new f.PlaylistUpdateInfoModel(this.videoApi,this.thumbProvider,this.props.current),this.privacyModel=new C.PlaylistPrivacyModel(this.authService,this.friendsService,this.friendsListsProvider,this.usersProvider,this.props.current),this.setTitle=e=>{this._titleError=!1,this._title=e},this.resetError=()=>{this._error=null},this.createPlaylist=async()=>{if(this.validateTitle(),this._titleError)return;this._abortController?.abort(),this._abortController=new AbortController;const e=(0,r.toJS)(this.updateInfoModel.thumbModel.uploadedThumb),t={ownerId:this._ownerId,title:this._title,privacy:(0,r.toJS)(this.privacyModel.privacy)??void 0};e&&(t.photoId=e.photo_id,t.photoHash=e.photo_hash);try{const{album_id:e}=await this.playlistsProvider.create(t,{signal:this._abortController.signal});return!1!==this.props.current.hasOnCreateSnackbar&&this.snackbar.show({before:{content:(0,s.jsx)(n.Icon28ListCheckOutline,{})},text:this.langs.getLang("video_playlist_created_notification"),action:{label:this.langs.getLang("video_open_new_playlist"),href:(0,b.getPlaylistUrl)((0,a.getIdentityRawId)({ownerId:this._ownerId,id:e}))}}),window.dispatchEvent(new CustomEvent(I.PlaylistFormEvents.CREATE,{detail:{id:e,ownerId:t.ownerId,title:t.title,privacy:t.privacy}})),e}catch(e){(0,r.runInAction)((()=>{this._error=e}))}finally{(0,r.runInAction)((()=>{this._abortController=null}))}},this.handleSubmitCreate=async()=>{const e=await this.createPlaylist();e&&(this.props.current.onClose(),this.props.current.onCreate?.({id:e,title:this.title}))},this.editPlaylist=async()=>{if(this.validateTitle(),!this._playlist||this._titleError)return;this._abortController?.abort(),this._abortController=new AbortController;const e=(0,r.toJS)(this.updateInfoModel.thumbModel.uploadedThumb),t={ownerId:this._ownerId,itemId:this._playlist.data.id,title:this._title,privacy:(0,r.toJS)(this.privacyModel.privacy)??void 0};e?(t.photoId=e.photo_id,t.photoHash=e.photo_hash):null===e&&(t.photoId=0);try{await this._playlist.edit(t,{signal:this._abortController.signal}),window.dispatchEvent(new CustomEvent(I.PlaylistFormEvents.UPDATE,{detail:{id:t.itemId,ownerId:t.ownerId,title:t.title,privacy:t.privacy}}))}catch(e){return void(0,r.runInAction)((()=>{this._error=e}))}finally{(0,r.runInAction)((()=>{this._abortController=null}))}return!0},this.handleSubmitEdit=async()=>{if(await this.editPlaylist()){this.props.current.onClose();const e=this.updateInfoModel.thumbModel.uploadedThumb?.image;this.props.current.onEdit?.({title:this.title,image:e?(0,r.toJS)(e):void 0,privacy:this.privacyModel.privacy?(0,r.toJS)(this.privacyModel.privacy):void 0})}},this.handleSubmit=async()=>{await(this.props.current.playlist?this.handleSubmitEdit():this.handleSubmitCreate())},this._abortController=null,this._title="",this._titleError=!1,this._error=null,this._ownerId=_.current.ownerId,_.current.playlist&&(this._playlist=new d.VideoPlaylist(_.current.playlist,i),this._title=_.current.playlist.title),(0,r.makeAutoObservable)(this)}}S=(0,o.__decorate)([_.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===v.Langs?Object:v.Langs,void 0===g.Snackbar?Object:g.Snackbar,void 0===m.VideoApi?Object:m.VideoApi,void 0===y.AuthService?Object:y.AuthService,void 0===l.FriendsService?Object:l.FriendsService,void 0===c.FriendsListsListsProvider?Object:c.FriendsListsListsProvider,void 0===u.UsersProvider?Object:u.UsersProvider,void 0===h.VideoPlaylistsProvider?Object:h.VideoPlaylistsProvider,void 0===p.VideoPlaylistThumbProvider?Object:p.VideoPlaylistThumbProvider,void 0===_.Props?Object:_.Props])],S)},708003:(e,t,i)=>{i.d(t,{PlaylistPrivacyModel:()=>n});var o=i(327813),s=i(468073),r=i(512143),a=i(8097);class n{get privacy(){return this._privacy}get isProfileClosed(){return this._isProfileClosed}get isLoading(){return Boolean(this._abortController)||this.friendsModel.isLoading||this.friendsListsModel.isLoading}get error(){return this._error}dispose(){this._abortController?.abort(),this.friendsModel.dispose(),this.friendsListsModel.dispose()}fetchPrivacy(){const{ownerId:e}=this.props;this.authService.userId&&!s.Ranges.isGroupId(e)&&(this.fetchUser(),this.fetchPrivacyFriends(),this.friendsListsModel.fetch())}setDefaultPrivacy(){this._privacy||(this._privacy={category:this._isProfileClosed?r.SETTINGS_PRIVACY_FRIENDS:r.SETTINGS_PRIVACY_ALL})}async fetchUser(){const e=this.authService.userId;if(e){this._abortController?.abort(),this._abortController=new AbortController;try{const t=await this.usersProvider.fetchUsersByIds({userIds:[e]},{signal:this._abortController.signal});(0,o.runInAction)((()=>{t.length?(this._isProfileClosed=Boolean(t[0].is_closed),this.setDefaultPrivacy()):this._error=Error("Couldn't fetch current user")}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}}async fetchPrivacyFriends(){if(!this._privacy?.owners)return;const e=[...this._privacy.owners.excluded||[],...this._privacy.owners.allowed||[]];await this.friendsModel.fetch(e)}constructor(e,t,i,s,n){this.authService=e,this.friendsService=t,this.friendsListsProvider=i,this.usersProvider=s,this.props=n,this.friendsModel=new r.PrivacyFriendsModel(this.usersProvider),this.friendsListsModel=new r.PrivacyFriendsListsModel(this.authService,this.friendsService,this.friendsListsProvider),this.formModalVisibility=new a.PlaylistModalVisibility,this.friendsModalVisibility=new a.PlaylistModalVisibility,this.setPrivacy=e=>{this._privacy=e},this._abortController=null,this._isProfileClosed=!1,this._privacy=null,this._error=null,this.props.playlist?.privacy&&(this._privacy=this.props.playlist.privacy),(0,o.makeAutoObservable)(this)}}},818367:(e,t,i)=>{i.d(t,{PlaylistThumbModel:()=>s});var o=i(327813);class s{get uploadedThumb(){return this._uploadedThumb}get thumbFile(){return this._thumbFile}get thumb(){return this._uploadedThumb?this._uploadedThumb.image:this._thumbFile?URL.createObjectURL(this._thumbFile):this._playlistThumbs}get error(){return this._error}get isLoading(){return Boolean(this._abortController)}dispose(){this._abortController?.abort()}constructor(e,t){this.thumbProvider=e,this.props=t,this.resetData=()=>{this.dispose(),this._abortController=null,this._error=null,this._playlistThumbs=null,this._thumbFile=null,this._uploadedThumb=null},this.upload=async e=>{if(e&&e.type.match(/^image\//)){this._thumbFile=e,this._abortController?.abort(),this._abortController=new AbortController,this._error=null;try{const t=await this.thumbProvider.upload(e,{ownerId:this.props.ownerId},{signal:this._abortController.signal});(0,o.runInAction)((()=>{t&&(this._uploadedThumb=t,this._thumbFile=null)}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}else this._thumbFile=null},this._abortController=null,this._error=null,this._playlistThumbs=null,this._thumbFile=null,this._uploadedThumb=void 0,this._playlistThumbs=t.playlistThumbs||null,(0,o.makeAutoObservable)(this)}}},425974:(e,t,i)=>{i.d(t,{PlaylistUpdateInfoModel:()=>r});var o=i(327813),s=i(818367);class r{get error(){return this._error}get isLoading(){return Boolean(this._abortController)}get canUploadThumb(){return this._canUploadThumb}dispose(){this._abortController?.abort(),this.thumbModel.dispose()}async fetchInfo(){this._abortController?.abort(),this._abortController=new AbortController;const e={owner_id:this.props.ownerId};this.props.playlist&&(e.playlist_id=this.props.playlist.id);try{const t=await this.videoApi.getPlaylistUpdateInfo(e,{signal:this._abortController.signal});(0,o.runInAction)((()=>{this._canUploadThumb=t.can_upload_thumb,this.thumbModel=new s.PlaylistThumbModel(this.thumbProvider,{ownerId:this.props.ownerId,playlistThumbs:t.has_custom_thumb?this.props.playlist?.image:void 0})}))}catch(e){(0,o.runInAction)((()=>{this._error=e}))}finally{(0,o.runInAction)((()=>{this._abortController=null}))}}constructor(e,t,i){this.videoApi=e,this.thumbProvider=t,this.props=i,this._abortController=null,this._error=null,this._canUploadThumb=!1,(0,o.makeAutoObservable)(this)}}},782475:(e,t,i)=>{i.d(t,{PlaylistFormEvents:()=>o});const o={CREATE:"PlaylistFormEvents/CREATE",UPDATE:"PlaylistFormEvents/UPDATE",DELETE:"PlaylistFormEvents/DELETE"}},703838:(e,t,i)=>{i.d(t,{PlaylistModelProvider:()=>r,usePlaylistModel:()=>a});var o=i(132028),s=i(31411);const{Provider:r,useModel:a}=(0,o.createProvider)(s.PlaylistModel)},790733:(e,t,i)=>{i.d(t,{showPlaylistModal:()=>n});var o=i(474848),s=i(835077),r=i(220428),a=i(78080);const n=e=>{(0,s.showMessageBoxModal)((t=>(0,o.jsx)(r.DIRootWebProvider,{children:(0,o.jsx)(a.PlaylistModal,{...e,...t})})),{width:420,onDestroy:e.onClose})}},670724:(e,t,i)=>{i.d(t,{PlaylistModalThumb:()=>d});var o=i(474848),s=i(456921),r=i(149333),a=i(703838),n=i(670683);const d=(0,s.observer)((function(){const e=(0,r.useLangs)(),{updateInfoModel:{thumbModel:{thumb:t,thumbFile:i,upload:s,resetData:d,isLoading:l,error:c}}}=(0,a.usePlaylistModel)();return(0,o.jsx)(n.PlaylistModalThumbBase,{top:e.getLang("video_playlist_thumb"),bottom:e.getLang("video_playlist_thumb_recomendation"),width:128,height:80,thumb:t,thumbFile:i,upload:s,resetData:d,isLoading:l,error:c})}))},670683:(e,t,i)=>{i.d(t,{PlaylistModalThumbBase:()=>u});var o=i(474848),s=i(296540),r=i(44544),a=i(181944),n=i(390147),d=i(149333),l=i(8520);const c=["image/jpeg","image/png","image/gif","image/heic","image/heif","image/webp"].join(","),u=({top:e,bottom:t,width:i,height:u,thumb:h,thumbFile:p,upload:_,resetData:v,isLoading:g,error:m})=>{const y=(0,d.useLangs)(),b=(0,s.useMemo)((()=>Array.isArray(h)?(0,l.getPhotoSize)(h,2*i)?.url:h),[h,i]);return(0,o.jsx)(r.FormItem,{top:e,bottom:t,children:b?(0,o.jsxs)(a.MediaAttach,{src:b,"aria-label":y.getLang("video_upload_select_thumb"),width:i,height:u,children:[(0,o.jsx)(a.MediaAttach.RemoveButton,{"aria-label":y.getLang("global_delete"),onClick:v}),m&&(0,o.jsx)(a.MediaAttach.ErrorOverlay,{"aria-label":y.getLang("global_retry_upload"),onClick:()=>{_(p)}}),g&&(0,o.jsx)(a.MediaAttach.LoadingOverlay,{})]}):(0,o.jsx)(a.MediaAttach,{"aria-label":y.getLang("video_upload_select_thumb"),fallbackIcon:(0,o.jsx)(n.Icon28CameraOutline,{}),accept:c,width:i,height:u,onChange:e=>{_(e[0])}})})}},53157:(e,t,i)=>{i.d(t,{PlaylistModalThumb:()=>o.PlaylistModalThumb});var o=i(670724)},678998:(e,t,i)=>{i.d(t,{SubscriptionsActualizationModal:()=>g});var o=i(474848),s=i(296540),r=i(456921),a=i(132028),n=i(694244),d=i(299494),l=i(63614),c=i(835077),u=i(337159),h=i(383920),p=i(615318);const _=.7*window.innerHeight,v=(0,r.observer)((()=>{const{props:e,isInitialLoading:t,shouldHideFooter:i}=(0,p.useSubscriptionsActualizationAuthorsModel)();return(0,s.useEffect)((()=>{e.current?.refreshCoordinates()}),[t]),(0,u.useModalStats)(),t?(0,o.jsx)(c.MessageBoxModalLoader,{refreshCoordinates:e.current?.refreshCoordinates}):(0,o.jsxs)(n.ModalBox,{width:640,children:[(0,o.jsx)(h.Header,{}),(0,o.jsx)(h.Errors,{}),(0,o.jsx)(d.ModalScrollView,{autoHideScrollbar:!0,maxHeight:_,children:(0,o.jsx)(l.ModalBody,{insetLevel:1,children:(0,o.jsx)(h.ActualizationCatalog,{})})}),!i&&(0,o.jsx)(h.Footer,{})]})})),g=(0,a.createWidget)(p.SubscriptionsActualizationAuthorsModelProvider,v)},981361:(e,t,i)=>{i.d(t,{ActualizationCatalog:()=>d});var o=i(474848),s=i(456921),r=i(839614),a=i(924501),n=i(615318);const d=(0,s.observer)((()=>{const{section:e}=(0,n.useSubscriptionsActualizationAuthorsModel)();return(0,o.jsx)(r.CatalogSearchWidget,{section:e,blockLayoutResolver:a.blockLayoutResolver})}))},296262:(e,t,i)=>{i.d(t,{AuthorItem:()=>C});var o=i(474848),s=i(456921),r=i(839614),a=i(363046),n=i(468073),d=i(303800),l=i(276898),c=i(724648),u=i(387960),h=i(751268),p=i(412888),_=i(753457),v=i(285056),g=i(764505),m=i(615318),y=i(834100);const b=(0,s.observer)((({item:e})=>{const{id:t,name:i,is_video_subscription_hidden:s,members_count:r}=e,{formState:n,isInitialActualization:b}=(0,m.useSubscriptionsActualizationAuthorsModel)(),C=((0,g.isRetina)()?e.photo_200:e.photo_100)||"",f=(0,y.useMembersCount)(r),I=b||s,S=e=>{(0,a.cancelEvent)(e),n.toggleId(t,I)};return(0,o.jsx)(d.Div,{mode:"horizontal",paddingTop:8,paddingBottom:8,spacing:12,children:(0,o.jsx)(l.RichCell,{before:(0,o.jsxs)(c.Flex,{align:"center",gap:"2xl",noWrap:!0,children:[(0,o.jsx)(u.Radio,{checked:n.checkToggled(t,I),onChange:S}),(0,o.jsx)(h.RichAvatar,{src:C,size:48})]}),caption:f?(0,o.jsx)(p.TextClamp,{TypographyComponent:_.Footnote,lines:1,title:f,children:f}):void 0,hasHover:!1,onClick:S,children:(0,o.jsx)(p.TextClamp,{TypographyComponent:v.Headline,level:"1",weight:"1",lines:1,title:i,children:i})},t)})})),C=(0,r.withCatalogStore)(b,((e,t)=>e.groups.get(n.Ranges.convertOwnerIdToGroupId(t.id))))},634835:(e,t,i)=>{i.d(t,{Errors:()=>l});var o=i(474848),s=i(456921),r=i(303800),a=i(753457),n=i(149333),d=i(615318);const l=(0,s.observer)((()=>{const e=(0,n.useLangs)(),{submitError:t}=(0,d.useSubscriptionsActualizationAuthorsModel)();return t?(0,o.jsx)(r.Div,{mode:"horizontal",spacing:12,children:(0,o.jsx)(a.FormStatus,{header:e.getLang("video_subscriptions_actualization_modal_save_error"),mode:"error"})}):null}))},858563:(e,t,i)=>{i.d(t,{Footer:()=>c});var o=i(474848),s=i(456921),r=i(908242),a=i(454154),n=i(149333),d=i(537603),l=i(615318);const c=(0,s.observer)((()=>{const e=(0,n.useLangs)(),{close:t,save:i,formState:s,isLoading:c,selectedAuthorsCount:u}=(0,l.useSubscriptionsActualizationAuthorsModel)();return(0,o.jsx)(r.ModalFooter,{actions:[(0,o.jsx)(a.Button,{onClick:t,mode:"secondary",children:e.getLang("video_subscriptions_actualization_modal_close")},"close"),(0,o.jsx)(a.Button,{onClick:()=>{d.videoSubscriptionsSelectCreatorsClickStatsCollector.logEvent({event_type:d.VideoSubscriptionsSelectCreatorsClickEventTypes.EVENT_TYPE_CLICK_TO_SELECT_CREATORS_CONFIRM,selected_count:u}),i()},disabled:!s.isDirty||c,loading:c,children:e.numeric(u,e.getLang("video_subscriptions_actualization_modal_save",!0))},"save")]})}))},468617:(e,t,i)=>{i.d(t,{Header:()=>d});var o=i(474848),s=i(456921),r=i(149333),a=i(784434),n=i(615318);const d=(0,s.observer)((()=>{const e=(0,r.useLangs)(),{title:t,close:i}=(0,n.useSubscriptionsActualizationAuthorsModel)();return(0,o.jsx)(a.ModalHeaderHero,{onClose:i,closeAriaLabel:e.getLang("video_subscriptions_actualization_modal_close"),children:t})}))},818683:(e,t,i)=>{i.d(t,{Placeholder:()=>h});var o=i(474848),s=i(296540),r=i(839614),a=i(8520),n=i(720836),d=i(293116),l=i(279734),c=i(454154),u=i(412888);const h=(0,r.withCatalogStore)((({item:e})=>{const{id:t,title:i,text:r,icons:h,buttons:p}=e,_=(0,s.useMemo)((()=>h&&(0,a.getPhotoSize)(h,100*window.devicePixelRatio)),[h]),v=p?.[0];return(0,o.jsx)(n.Placeholder,{header:i,icon:_&&(0,o.jsx)(d.Image,{alt:i,src:_.url,size:100,withTransparentBackground:!0,noBorder:!0}),action:v&&(0,o.jsx)(l.Link,{href:v.action?.url,children:(0,o.jsx)(c.Button,{size:"m",children:v.title})}),children:r&&(0,o.jsx)(u.TextClamp,{lines:0,preserveWhitespaces:!0,children:r})},t)}),((e,t)=>e.placeholders.get(t.id)))},383920:(e,t,i)=>{i.d(t,{ActualizationCatalog:()=>o.ActualizationCatalog,AuthorItem:()=>a.AuthorItem,Errors:()=>n.Errors,Footer:()=>r.Footer,Header:()=>s.Header,Placeholder:()=>d.Placeholder});var o=i(981361),s=i(468617),r=i(858563),a=i(296262),n=i(634835),d=i(818683)},924501:(e,t,i)=>{i.d(t,{blockLayoutResolver:()=>o.blockLayoutResolver});var o=i(260969)},260969:(e,t,i)=>{i.d(t,{blockLayoutResolver:()=>u});var o=i(474848),s=i(456921),r=i(839614),a=i(16481),n=i(383920);const d=(0,r.withCatalogBlock)(a.StackedList,{horizontalPaddingByDataType:{search_authors:0},verticalPaddingByDataType:{search_authors:0},spacingByDataType:{search_authors:0},columnsByDataType:{search_authors:2}},(e=>"search_authors"===e.data.data_type?n.AuthorItem:null)),l=(0,s.observer)((function({block:e,items:t,ItemComponent:i}){return t?.map(((t,s)=>(0,o.jsx)(i,{...t,index:s,block:e},t.id)))})),c=(0,r.withCatalogBlock)(l,{},(e=>"placeholder"===e.data.data_type?n.Placeholder:null)),u=e=>{switch(e.data.layout.name){case"large_list":return d;case"placeholder":return c;default:return()=>null}}},834100:(e,t,i)=>{i.d(t,{useMembersCount:()=>s});var o=i(149333);function s(e){const t=(0,o.useLangs)();if(!e)return"";if(e<1e3)return t.numeric(e,t.getLang("video_author_subscribers_counter",!0));return`${new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}).formatToParts(e).map((e=>e.value)).join("")} ${t.getLang("video_author_subscribers")}`}},337159:(e,t,i)=>{i.d(t,{useModalStats:()=>o.useModalStats});var o=i(12443)},12443:(e,t,i)=>{i.d(t,{useModalStats:()=>n});var o=i(296540),s=i(537603),r=i(695305),a=i(615318);function n(){const{props:e,formState:t}=(0,a.useSubscriptionsActualizationAuthorsModel)();(0,o.useEffect)((()=>{const i=e.current?.sectionId,o=e.current?.screen||(0,r.getCurrentScreen)()||"video_catalog";return s.videoSubscriptionsSelectCreatorsNavCollector.logOpenEvent(i,o),()=>{s.videoSubscriptionsSelectCreatorsNavCollector.logCloseEvent(i,o,t.isConfirmed)}}),[])}},177143:(e,t,i)=>{i.d(t,{showSubscriptionsActualizationModal:()=>o.showSubscriptionsActualizationModal});var o=i(489403)},884071:(e,t,i)=>{i.d(t,{SubscriptionsActualizationAuthorsModelProvider:()=>g,useSubscriptionsActualizationAuthorsModel:()=>m});var o,s=i(331635),r=i(327813),a=i(132028),n=i(712600),d=i(670252),l=i(67552),c=i(298593),u=i(468073),h=i(375568),p=i(213818),_=i(501384);!function(e){e.SUBMIT="submit"}(o||(o={}));class v{get isInitialActualization(){return this._isInitialActualization}get isInitialLoading(){return this._isInitialLoading}get isLoading(){return this._isLoading}get section(){return this._section}get title(){return this._section?.title||""}get formState(){return this._formState}get submitError(){return this._errorsSet.has("submit")}get selectedAuthorsCount(){return this.alreadySelectedAuthors+this._formState.countToAdd}get shouldHideFooter(){return Boolean(this._section?.blocks.filter((e=>"placeholder"===e.data.data_type)).length)}async[a.init](){this._isInitialLoading=!0;try{const e=this._sectionId??await this.subscriptionsCatalogProvider.fetchSectionId({url:`${window.location.origin}/video/subscriptions_chooser`}),[t,{has_configured_list:i}]=await Promise.all([this.subscriptionsCatalogProvider.fetchSection({section_id:e}),this.subscriptionService.subscribeGetRelevantAuthors({count:0,start_from:"0"})]);(0,r.runInAction)((()=>{this._section=t?.activeSection||null,this._isInitialActualization=!i}))}catch(e){this.snackbar.show({type:"error",text:this.langs.getLang("video_subscriptions_actualization_modal_init_error")}),this.close()}finally{(0,r.runInAction)((()=>{this._isInitialLoading=!1}))}}get alreadySelectedAuthors(){const e=this._section?.blocks[0]?.data?.badge?.text,t=Number(e);return Number.isNaN(t)?0:t}constructor(e,t,i,o,s){this.langs=e,this.snackbar=t,this.subscriptionsCatalogProvider=i,this.subscriptionService=o,this.props=s,this.catalogService=new h.CatalogServiceAdapter((0,p.getSubscriptionsPageServices)().catalogService),this.close=()=>{this.props.current.onClose?.()},this.save=async()=>{this._formState.toggleIsConfirmed(!0),this._errorsSet.delete("submit"),this._isLoading=!0;try{if(!await this.subscriptionService.subscribeChooseRelevantAuthors({keep_author_ids:this._formState.state.show.map((e=>u.Ranges.convertGroupIdToOwnerId(e))).join(),hide_author_ids:this._formState.state.hide.map((e=>u.Ranges.convertGroupIdToOwnerId(e))).join()}))return void this._errorsSet.add("submit");this.close(),this.catalogService.refetchCurrentSection(),this.props.current.onActualizationSuccess?.(),this.snackbar.show({type:"ok",text:this.langs.numeric(this.selectedAuthorsCount,this.langs.getLang("video_subscriptions_actualization_modal_save_success",!0))})}catch(e){this._errorsSet.add("submit")}finally{this._formState.toggleIsConfirmed(!1),(0,r.runInAction)((()=>{this._isLoading=!1}))}},this._errorsSet=new Set,this._sectionId=void 0,this._section=null,this._isInitialActualization=!1,this._isInitialLoading=!1,this._isLoading=!1,this._sectionId=s.current.sectionId,this._formState=new _.FormStateModel,(0,r.makeAutoObservable)(this)}}v=(0,s.__decorate)([a.scope.transient(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[void 0===n.Langs?Object:n.Langs,void 0===d.Snackbar?Object:d.Snackbar,void 0===l.VideoSubscriptionsCatalogProvider?Object:l.VideoSubscriptionsCatalogProvider,void 0===c.VideoSubscriptionsService?Object:c.VideoSubscriptionsService,void 0===a.Props?Object:a.Props])],v);const{Provider:g,useModel:m}=(0,a.createProvider)(v)},501384:(e,t,i)=>{i.d(t,{FormStateModel:()=>s});var o=i(327813);class s{get isDirty(){return Boolean(this.authorsIdsHideSet.size||this.authorsIdsShowSet.size)}get isConfirmed(){return this._isConfirmed}get countToAdd(){return this.authorsIdsShowSet.size-this.authorsIdsHideSet.size}get state(){return{hide:Array.from(this.authorsIdsHideSet),show:Array.from(this.authorsIdsShowSet)}}checkInSet(e,t){return(t?this.authorsIdsShowSet:this.authorsIdsHideSet).has(e)}constructor(){this.toggleId=(e,t)=>{const i=t?this.authorsIdsShowSet:this.authorsIdsHideSet;this.checkInSet(e,t)?i.delete(e):i.add(e)},this.checkToggled=(e,t)=>{const i=this.checkInSet(e,t);return t?i:!i},this.toggleIsConfirmed=e=>{this._isConfirmed=e??!this._isConfirmed},this.authorsIdsHideSet=new Set,this.authorsIdsShowSet=new Set,this._isConfirmed=!1,(0,o.makeAutoObservable)(this)}}},615318:(e,t,i)=>{i.d(t,{SubscriptionsActualizationAuthorsModelProvider:()=>o.SubscriptionsActualizationAuthorsModelProvider,useSubscriptionsActualizationAuthorsModel:()=>o.useSubscriptionsActualizationAuthorsModel});var o=i(884071)},489403:(e,t,i)=>{i.d(t,{showSubscriptionsActualizationModal:()=>d});var o=i(474848),s=i(865708),r=i(220428),a=i(835077),n=i(678998);const d=e=>(t,i)=>{(0,a.showMessageBoxModal)((a=>(0,o.jsx)(r.DIRootWebProvider,{children:(0,o.jsx)(s.AppRootProvider,{children:(0,o.jsx)(n.SubscriptionsActualizationModal,{...a,onActualizationSuccess:e,sectionId:t,screen:i})})})),{fullscreen:!0})}},933176:(e,t,i)=>{i.d(t,{VideoCardWidget:()=>b});var o=i(474848),s=i(296540),r=i(456921),a=i(618068),n=i(132028),d=i(565168),l=i(426222),c=i(370),u=i(223173),h=i(598865),p=i(571117),_=i(149333),v=i(109889),g=i(950885),m=i(63296);const y=(0,r.observer)((function(){const e=(0,m.useVideoCardModel)(),{isRenamingToWatchLater:t,videoData:i,videoForCard:r}=e,{collectClick:n,direction:y,videoContainerWidth:b,noOwner:C,infoContainerWidth:f}=e.props.current,I=[],S=(0,_.useLangs)();if(i.can_add_to_faves){const s=()=>e.faveHandler(h.FAVORITE_SOURCES.VIDEO_CARD_MODAL),r=t?{onClick:s,children:i.is_favorite?S.getLang("video_remove_from_watch_later"):S.getLang("video_catalog_showcase_section_my_watch_later_title"),before:i.is_favorite?(0,o.jsx)(d.Icon20DeleteClockOutline,{}):(0,o.jsx)(l.Icon20ClockOutline,{})}:{onClick:s,children:i.is_favorite?S.getLang("global_remove_from_bookmarks"):S.getLang("global_add_to_bookmarks"),before:(0,o.jsx)(c.Icon20FavoriteOutline,{})};I.push(r)}i.can_repost&&void 0!==i.owner_id&&void 0!==i.id&&I.push({before:(0,o.jsx)(u.Icon20ShareOutline,{}),children:S.getLang("video_share_with_friends"),onClick:()=>{n?.({action:p.SearchClickActionMap.SHARE,track_code:i.track_code,type:p.EventItemType.VIDEO}),(0,g.shareVideoExtended)(i.owner_id,i.id)}});const P=(0,v.useMenuActions)(i,I),w=(0,v.useControls)({video:i,controls:[],onToggleFav:e.faveHandler}),A=(0,s.useRef)(null),L=(0,h.useRefLogView)({type:p.EventItemType.VIDEO,trackCode:i.track_code});return(0,o.jsx)(a.VideoCard,{getRef:e.isControlsFixEnabled?e=>{L?.(e),A.current=e}:L,controlItems:(0,o.jsx)(v.VideoCardControls,{video:i,cardRef:e.isControlsFixEnabled?A:void 0,collectClick:n||(()=>{}),controls:w??[]}),menuItems:P,video:r,onVideoOpen:e.onVideoOpen,onAuthorClick:()=>{n?.({action:p.SearchClickActionMap.OPEN_OWNER,track_code:i.track_code,type:p.EventItemType.VIDEO})},direction:y,videoContainerWidth:b,noOwner:C,infoContainerWidth:f})})),b=(0,n.createWidget)(m.VideoCardProvider,y)},153961:(e,t,i)=>{i.d(t,{VideoCardWidget:()=>o.VideoCardWidget});var o=i(933176)},907232:(e,t,i)=>{i.d(t,{VideoCardProvider:()=>g,useVideoCardModel:()=>m});var o=i(331635),s=i(327813),r=i(132028),a=i(24516),n=i(64339),d=i(598865),l=i(571117),c=i(969617),u=i(916637),h=i(853349),p=i(29593),_=i(374856);class v{get videoData(){const e=this.props.current.video.data,t=this.props.current.trackCode||e.track_code;return{...e,track_code:t,is_favorite:this.props.current.video.isFavorite}}get isControlsFixEnabled(){return this.userEnv.partConfigEnabled("video_card_controls_focus_fix")}get isRenamingToWatchLater(){return this.userEnv.partConfigEnabled("video_bookmarks_renaming_to_watch_later")}get isSearchHideVideoDescription(){return this.userEnv.partConfigEnabled("search_hide_video_description")}get isActiveVkLive(){const{video:e}=this.props.current;return this.userEnv.partConfigEnabled("vk_live_integration")&&!!e.data.vk_live_channel_url&&(0,_.isLiveVideo)(e.data)}get videoForCard(){const{owner:e,video:t}=this.props.current,i=(0,h.mapVideoToVideoCardItem)(this.videoData);return{...i,description:this.isSearchHideVideoDescription?"":this.videoData.description,owner:{...(0,h.mapArtistToVideoCardOwner)(this.videoData)??(0,h.mapUserOrGroupToVideoCardOwner)(e,"/video/@"),badge:(0,p.getVerifiedBadge)(e)},href:this.isActiveVkLive?t.data.vk_live_channel_url:i.href}}constructor(e,t,i){this.userEnv=e,this.props=t,this.videoFaveService=i,this.faveHandler=async e=>{const{collectClick:t,video:i}=this.props.current,o=this.videoData.owner_id,s=this.videoData.id;if(!o)return;const r=this.videoData.is_favorite;this.videoFaveService.toggle({ownerId:o,id:s,ref:this.videoData.track_code,source:e}),this.isRenamingToWatchLater&&window.dispatchEvent(new CustomEvent(n.VideoShowcaseFaveEvents.TOGGLE,{detail:{id:i.rawId,isFave:r,rollbackCallback:()=>{this.videoFaveService.add({ownerId:o,id:s,ref:this.videoData.track_code,source:d.FAVORITE_SOURCES.SNACKBAR}),window.dispatchEvent(new CustomEvent(n.VideoShowcaseFaveEvents.TOGGLE,{detail:{id:i.rawId,isFave:!1}}))}}})),t?.({action:r?l.SearchClickActionMap.UNFAVE:l.SearchClickActionMap.FAVE,track_code:this.videoData.track_code,type:l.EventItemType.VIDEO})},this.onVideoOpen=e=>{if(window.cur.cancelClick)return e.preventDefault(),void(window.cur.cancelClick=!1);const{collectClick:t,video:i}=this.props.current;if(window.cur.chooseVideoMedia)return e.preventDefault(),window.cur.chooseVideoMedia(e.target,String(this.videoData.id));t?.({action:l.SearchClickActionMap.TAP,track_code:this.videoData.track_code,type:l.EventItemType.VIDEO}),this.isActiveVkLive&&i.data.vk_live_channel_url?window.location.href=i.data.vk_live_channel_url:u.showVideo&&(0,u.showVideo)({event:e,id:i.rawId,video:this.videoData})},this.handleClickAuthor=()=>{const{collectClick:e}=this.props.current;e?.({action:l.SearchClickActionMap.OPEN_OWNER,track_code:this.videoData.track_code,type:l.EventItemType.VIDEO})},(0,s.makeAutoObservable)(this)}}v=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.UserEnv?Object:a.UserEnv,void 0===r.Props?Object:r.Props,void 0===c.VideoFaveService?Object:c.VideoFaveService])],v);const{Provider:g,useModel:m}=(0,r.createProvider)(v)},63296:(e,t,i)=>{i.d(t,{VideoCardProvider:()=>o.VideoCardProvider,useVideoCardModel:()=>o.useVideoCardModel});var o=i(907232)},733590:(e,t,i)=>{i.d(t,{VideoClipsWidget:()=>g});var o=i(474848),s=i(456921),r=i(296540),a=i(132028),n=i(724648),d=i(927424),l=i(221666),c=i(513275),u=i(142075),h=i(383441),p=i(291886);const _={feed:"top"},v=(0,s.observer)((function(){const{feed:e,props:t}=(0,h.useVideoClipsModel)(),i=t.current.activeItemId,s=(0,u.usePageBlockOffset)(),{setRoot:a,itemSize:v,maxWidth:g}=(0,l.useClipSize)(),m=e.getFeedData(_),y=m?.ids??[],b=m?.isLoading??!1,C=Boolean(m?.error),f=m?.fullyLoaded??!1,I=(0,r.useCallback)((()=>{e.fetchNext(_)}),[]),S=(0,r.useRef)(null),P=(0,r.useCallback)((e=>{S.current?.controlsHandler(e)}),[]);(0,r.useEffect)((()=>{e.initFeed(_,i)}),[]),(0,r.useEffect)((()=>{i&&y.includes(i)||y.length&&t.current.setActiveItemId(y[0])}),[i,y]);const w=(0,r.useMemo)((()=>Math.max((g-v.width)/2,s)),[v,g,s]);return(0,o.jsx)(n.Flex,{getRootRef:a,className:p.default.container,justify:"center",children:(0,o.jsx)(l.ClipsFeedComponent,{activeItemId:i,feed:_.feed,listIds:y,isLoading:b,isError:Boolean(C),fullyLoaded:f,loadMore:I,itemSize:v,onActiveItemChanged:t.current.setActiveItemId,itemRender:(e,t,i,s)=>(0,o.jsx)(c.CarouselItem,{appearance:"video",videoFullId:e,itemSize:v,isActive:s,statsRef:d.ClipsPlayerStatsRef.VIDEO}),scrollRef:S,itemsOffset:w,after:(0,o.jsx)(l.ClipsFeedControlsLayout,{itemSize:v,itemsOffset:w,topControls:(0,o.jsx)(c.ClipsPlayerButtons,{videoFullId:i}),bottomControls:[i?(0,o.jsx)(c.ClipsFeedButtons,{videoFullId:i}):null,y.length>1?(0,o.jsx)(l.ClipsFeedCarouselControls,{isFirstActive:0===y.indexOf(i),isLastActive:y.indexOf(i)===y.length-1,handler:P}):null]})})})})),g=(0,a.createWidget)(h.VideoClipsProvider,v)},88454:(e,t,i)=>{i.d(t,{VideoClipsWidget:()=>o.VideoClipsWidget});var o=i(733590)},489842:(e,t,i)=>{i.d(t,{VideoClipsModel:()=>n});var o=i(331635),s=i(327813),r=i(132028),a=i(521344);class n{constructor(e,t){this.props=e,this.feed=t,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.Props?Object:r.Props,void 0===a.ClipsFeedModel?Object:a.ClipsFeedModel])],n)},383441:(e,t,i)=>{i.d(t,{VideoClipsProvider:()=>r,useVideoClipsModel:()=>a});var o=i(132028),s=i(489842);const{Provider:r,useModel:a}=(0,o.createPageProvider)(s.VideoClipsModel)},304776:(e,t,i)=>{i.d(t,{showPlaylistModalWidget:()=>S});var o=i(474848),s=i(211413),r=i(296540),a=i(149333),n=i(694244),d=i(782174),l=i(723723),c=i(285056),u=i(63614),h=i(908242),p=i(454154),_=i(132028),v=i(456921),g=i(319756),m=i(363369),y=i(535354),b=i(501412),C=i(477100);const f=(0,v.observer)((function(){const{messageBoxProps:e,isUpdated:t,onSubmitClick:i,userModel:s}=(0,y.useVideoPlaylistModel)(),_=(0,a.useLangs)();return(0,r.useEffect)((()=>{e.refreshCoordinates()}),[]),s.error?(0,o.jsx)(m.PlaylistErrorModal,{error:s.error,onClose:e.onClose}):(0,o.jsxs)(n.ModalBox,{height:365,children:[(0,o.jsx)(d.ModalHeader,{closeAriaLabel:_.getLang("box_cancel"),className:(0,l.getColorClass)("color_text_secondary"),onClose:e.onClose,before:(0,o.jsx)(c.Headline,{level:"1",className:C.default.modalHeader,children:`${_.getLang("video_add_to_playlist_placeholder_text")}: `}),children:(0,o.jsx)(b.DropdownComponent,{})}),(0,o.jsx)(u.ModalBody,{insetLevel:1,children:(0,o.jsx)(b.ModalBodyComponent,{})}),(0,o.jsx)(h.ModalFooter,{actions:[(0,o.jsx)(p.Button,{mode:"secondary",size:"m",onClick:e.onClose,children:_.getLang("box_cancel")},1),(0,o.jsx)(p.Button,{mode:"primary",size:"m",onClick:i,disabled:!t,children:_.getLang("Save")},2)]})]})})),I=(0,_.createWidget)(y.VideoPlaylistModelProvider,f),S=e=>{(0,s.showMessageBoxModal)((t=>(0,o.jsx)(g.DIRootWebProvider,{children:(0,o.jsx)(I,{...e,...t})})),{width:420})}},424300:(e,t,i)=>{i.d(t,{DropdownComponent:()=>h});var o=i(474848),s=i(456921),r=i(155050),a=i(507852),n=i(260546),d=i(612196),l=i(723723),c=i(972289),u=i(535354);const h=(0,s.observer)((function(){const{name:e,userModel:t}=(0,u.useVideoPlaylistModel)();return(0,o.jsx)(a.DropdownActionSheet,{width:217,maxHeight:168,placement:"bottom-end",trigger:"click",padding:"none",content:(0,o.jsx)(r.GroupsList,{}),size:"s",children:t.currentUser&&(0,o.jsx)(n.SimpleCell,{maxHeight:32,before:(0,o.jsx)(d.Avatar,{size:20,src:t.currentUser.photo_50}),after:(0,o.jsx)(c.Icon16DropdownOutline,{className:(0,l.getColorClass)("color_text_secondary")}),children:e})})}))},587380:(e,t,i)=>{i.d(t,{GroupItem:()=>c});var o=i(474848),s=i(456921),r=i(507852),a=i(723723),n=i(612196),d=i(344634),l=i(535354);const c=(0,s.observer)((function({item:e}){const{getName:t,onSelectUser:i,checkByItem:s}=(0,l.useVideoPlaylistModel)();return(0,o.jsx)(r.DropdownActionSheet.Item,{onClick:()=>i(e),after:s(e)&&(0,o.jsx)(d.Icon16CheckOutline,{className:(0,a.getColorClass)("color_icon_accent")}),before:(0,o.jsx)(n.Avatar,{size:20,src:e.photo_50}),children:t(e)})}))},155050:(e,t,i)=>{i.d(t,{GroupsList:()=>n});var o=i(474848),s=i(456921),r=i(535354),a=i(587380);const n=(0,s.observer)((function(){const{userModel:e}=(0,r.useVideoPlaylistModel)();return(0,o.jsx)(o.Fragment,{children:e.list.map((e=>(0,o.jsx)(a.GroupItem,{item:e},e.id)))})}))},431342:(e,t,i)=>{i.d(t,{ModalBodyComponent:()=>y});var o=i(474848),s=i(303800),r=i(194528),a=i(700272),n=i(944048),d=i(582192),l=i(753457),c=i(723723),u=i(299494),h=i(12215),p=i(564508),_=i(884945),v=i(456921),g=i(535354),m=i(149333);const y=(0,v.observer)((function(){const{isLoading:e,playlists:t,isLoadedFully:i,isListEmpty:v,fetchMorePlaylists:y,isMyAlbum:b,createNewPlaylistModel:C,handleAddToMyVideo:f,isGroup:I}=(0,g.useVideoPlaylistModel)(),S=(0,m.useLangs)();return v&&e?(0,o.jsxs)(s.Div,{mode:"horizontal",children:[(0,o.jsx)(r.Spacing,{size:104}),(0,o.jsx)(a.Spinner,{}),(0,o.jsx)(r.Spacing,{size:104})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.Checkbox,{checked:b,disabled:e,onChange:f,children:I?S.getLang("video_all_groups_videos"):S.getLang("video_my_added_videos_playlist")}),(0,o.jsx)(r.Spacing,{size:8}),(0,o.jsx)(d.Separator,{}),(0,o.jsx)(r.Spacing,{size:8}),(0,o.jsx)(s.Div,{mode:"horizontal",spacing:6,children:(0,o.jsx)(l.Footnote,{className:(0,c.getColorClass)("color_text_subhead"),weight:"3",children:S.getLang("video_playlists")})}),t&&t.length>0&&(0,o.jsxs)(u.ModalScrollView,{height:108,maxHeight:108,children:[t.map((e=>(0,o.jsx)(h.PlaylistCheckbox,{playlist:e},e.id))),e&&(0,o.jsx)(s.Div,{mode:"horizontal",spacing:4,children:(0,o.jsx)(a.Spinner,{})}),!i&&(0,o.jsx)(p.DynamicPagination,{isLoading:Boolean(e),fetchData:y,nextFrom:t.length,withSpinner:!1})]}),(0,o.jsx)(l.CellButton,{onClick:C.handleCreateNewPlaylist,before:(0,o.jsx)(_.Icon28AddOutline,{}),children:S.getLang("video_add_video_to_new_playlist")}),!t?.length&&(0,o.jsx)(r.Spacing,{size:106})]})}))},12215:(e,t,i)=>{i.d(t,{PlaylistCheckbox:()=>l});var o=i(474848),s=i(944048),r=i(412888),a=i(852074),n=i(456921),d=i(535354);const l=(0,n.observer)((function({playlist:e}){const{toggle:t,getChecked:i}=(0,d.useVideoPlaylistModel)(),{id:n,title:l}=e;return(0,o.jsx)(s.Checkbox,{checked:i(n),onChange:()=>t(n),titleAfter:(0,o.jsx)(a.PlaylistCheckboxTooltip,{privacy:e.privacy?.category}),children:(0,o.jsx)(r.TextClamp,{lines:1,children:l})})}))},852074:(e,t,i)=>{i.d(t,{PlaylistCheckboxTooltip:()=>c});var o=i(474848),s=i(866467),r=i(456921),a=i(373206),n=i(562791),d=i(578392),l=i(723723);const c=(0,r.observer)((function({privacy:e}){const t=(()=>{switch(e){case"all":return{Icon:a.Icon16UnlockOutline,text:(0,s.getLang)("video_playlist_available_to_all_tooltip")};case"only_me":return{Icon:n.Icon16LockOutline,text:(0,s.getLang)("video_playlist_private_tooltip")};default:return}})();if(!t)return null;const{Icon:i,text:r}=t;return(0,o.jsx)(d.TextTooltip,{placement:"top",appearance:"black",offsetByCrossAxis:-56,offsetByMainAxis:4,text:r,children:(0,o.jsx)(i,{className:(0,l.getColorClass)("color_icon_secondary")})})}))},501412:(e,t,i)=>{i.d(t,{DropdownComponent:()=>s.DropdownComponent,ModalBodyComponent:()=>o.ModalBodyComponent});var o=i(431342),s=i(424300)},840243:(e,t,i)=>{i.d(t,{showPlaylistModalWidget:()=>o.showPlaylistModalWidget});var o=i(304776)},502668:(e,t,i)=>{i.d(t,{VideoCreateNewPlaylistModel:()=>l});var o=i(327813),s=i(468073),r=i(540462),a=i(423151),n=i(826619),d=i(435393);class l{get messageBoxProps(){return{onClose:this.props.current.onClose,refreshCoordinates:this.props.current.refreshCoordinates}}constructor(e,t,i,l,c,u,h){this.props=e,this.langs=t,this.videoPlaylistListProvider=i,this.playlistsListService=l,this._playlistsList=c,this.userModel=u,this.snackbar=h,this.handleCreateNewPlaylist=e=>{this.messageBoxProps.onClose();const t=this.props.current.isGroupOwner||this.userModel.currentUser?.id!==this.userModel.user?.id?s.Ranges.convertGroupIdToOwnerId(Math.abs(this.userModel.currentUser?.id||0)):this.userModel.currentUser?.id;(0,r.partConfigEnabled)("video_playlist_redesign_popup")?(0,a.showPlaylistModal)({ownerId:t||0,onCreate:this.createPlaylist,hasOnCreateSnackbar:!1}):(0,n.createPlaylistPopup)({event:e,ownerId:t||0,videoId:this.props.current.videoId,videoOwnerId:this.props.current.videoOwnerId,requestOrigin:n.CreatePlaylistRequestOrigin.VIDEO_PLAYLISTS_MODAL})},this.createPlaylist=async e=>{const t=this.userModel.currentUser?.id||0;this.targetId=this.props.current.isGroupOwner&&this.props.current.ownerId||t!==this.userModel.user?.id?s.Ranges.convertGroupIdToOwnerId(t):t;const i=t===this.userModel.user?.id?t:this.targetId;try{await this.playlistsListService.fetchAlbumsByVideo({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,extended:!0,targetId:i}),await this.playlistsListService.addToAlbum({videoId:this.props.current.videoId,targetId:i,ownerId:this.props.current.videoOwnerId,albumId:e.id}),await this._playlistsList.fetch({ownerId:this.props.current.ownerId,count:this._chunkSize}),(0,o.runInAction)((()=>{(0,d.showSuccessSnackbar)(this.snackbar,this.langs.getLang("video_changes_saved"))}))}catch(e){(0,o.runInAction)((()=>{(0,d.showFailSnackbar)(this.snackbar,this.langs.getLang("video_editor_popout_save_failed_header")),this._error=e}))}},this._error=void 0,this._chunkSize=50,this.targetId=0,this._playlistsList=i.createList(),(0,o.makeAutoObservable)(this)}}},673592:(e,t,i)=>{i.d(t,{VideoGroupsFetchModel:()=>r});var o=i(712023),s=i(327813);class r{get error(){return this._error}get groupsItems(){if(this._groups?.items&&!o.VideoGroupsFetchProvider.isNumberArray(this._groups.items))return this._groups.items}async fetchGroups(){try{this._groups=await this.groupsProvider.fetch({userId:this.authService?.userId||void 0,extended:!0,filter:["editor","has_video"]})}catch(e){console.error(e),this._error=e}}constructor(e,t){this.authService=e,this.groupsProvider=t,this._error=void 0,this._groups=void 0,(0,s.makeAutoObservable)(this)}}},943961:(e,t,i)=>{i.d(t,{VideoPlaylistModelProvider:()=>A,useVideoPlaylistModel:()=>L});var o=i(331635),s=i(132028),r=i(627016),a=i(968192),n=i(491318),d=i(712023),l=i(639147),c=i(349773),u=i(476205),h=i(712600),p=i(951652),_=i(670252),v=i(327813),g=i(468073),m=i(768035),y=i(856289),b=i(462639),C=i(673592),f=i(502668),I=i(435393);let S=s.init,P=s.destroy;class w{abort(){this._abortController?.abort()}get name(){return this.userModel.currentUser&&this.getName(this.userModel.currentUser)}get isMyAlbum(){return!this.toRemove.has(y.MY_VIDEO_ALBUM_ID)&&(!!this.toAdd.has(y.MY_VIDEO_ALBUM_ID)||this.checkedIds?.has(y.MY_VIDEO_ALBUM_ID))}get messageBoxProps(){return{onClose:this.props.current.onClose,refreshCoordinates:this.props.current.refreshCoordinates}}get propsList(){return this.props.current}get checkedIds(){return this.userModel.currentUser?.id&&this.checkedIdsMap.has(this.userModel.currentUser.id)?this.checkedIdsMap.get(this.userModel.currentUser.id||0):this.playlistsListService.getContainingVideoPlaylistIds(this.props.current.videoId)}get playlists(){return this._playlistsList?.playlists.map((e=>e.data))}get isLoading(){return this._playlistsList?.isLoading}get isLoadedFully(){return this._playlistsList?.isLoadedFully}get isListEmpty(){return!this._playlistsList?.playlists.length}get isUpdated(){return Boolean(this.toAdd.size||this.toRemove.size)}get isGroup(){return this.userModel.currentUser?.id!==this.userModel.user?.id}async[S](){this._abortController=new AbortController,this.targetId=this.props.current.isGroupOwner&&this.props.current.ownerId?g.Ranges.convertGroupIdToOwnerId(this.props.current.ownerId):this.props.current.ownerId;const e=this.props.current.isGroupOwner?{groupId:this.props.current.ownerId}:{ownerId:this.props.current.ownerId};e.count=this._chunkSize;try{await Promise.all([this.groupsModel.fetchGroups(),this.userModel.fetchUser(),this.playlistsListService.fetchAlbumsByVideo({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,extended:!0,targetId:this.targetId},{signal:this._abortController.signal}),this._playlistsList?.fetch({...e},this._abortController)]),(0,v.runInAction)((()=>{this.userModel.initUser(),this.setOwnersPlaylistsMap(),this.setCheckedIdsByOwner()}))}catch(e){(0,v.runInAction)((()=>{this._abortController=void 0,this._error=e}))}}[P](){this.abort()}async fetchPlaylists(){this.abort(),this._abortController=new AbortController,this._playlistsList=this.videoPlaylistListProvider.createList();const e=this.userModel.currentUser?.id||0;this.targetId=this.props.current.isGroupOwner&&this.props.current.ownerId||this.isGroup?g.Ranges.convertGroupIdToOwnerId(e):e;const t=this.isGroup?{groupId:this.userModel.currentUser?.id}:{ownerId:this.userModel.currentUser?.id};t.count=this._chunkSize;try{await Promise.all([this.playlistsListService.fetchAlbumsByVideo({videoId:this.props.current.videoId,ownerId:this.props.current.videoOwnerId,extended:!0,targetId:this.isGroup?this.targetId:this.userModel.user?.id},{signal:this._abortController.signal}),this._playlistsList.fetch({...t},this._abortController)]),(0,v.runInAction)((()=>{this.setCheckedIdsByOwner(),this.setOwnersPlaylistsMap()}))}catch(e){(0,v.runInAction)((()=>{this._abortController=void 0,this._error=e}))}}setCheckedIdsByOwner(){return this.checkedIdsMap.set(this.userModel.currentUser?.id||0,this.checkedIds)}setOwnersPlaylistsMap(){return this.ownersPlaylistsMap.set(this.userModel.currentUser?.id||0,this._playlistsList)}constructor(e,t,i,o,s,r,a,n,d,l,c){this.props=e,this.langs=t,this.authService=i,this.videoPlaylistProvider=o,this.videoPlaylistListProvider=s,this.playlistsListService=r,this.groupsProvider=a,this.userService=n,this.usersStoreFactory=d,this.groupsStoreFactory=l,this.snackbar=c,this.getName=e=>(e=>Boolean(e&&"name"in e))(e)?this.videoGroupsStore.getById(e.id)?.name:this.userModel.name,this.checkByItem=e=>this.userModel.currentUser?.id===e.id,this.handleAddToMyVideo=()=>{this.toggle(y.MY_VIDEO_ALBUM_ID)},this.fetchMorePlaylists=async()=>{try{await(this._playlistsList?.fetchMore())}catch(e){(0,v.runInAction)((()=>{this._error=e}))}},this.onSelectUser=e=>{this.userModel.setCurrentUser(e),this.toRemove.clear(),this.toAdd.clear(),this.ownersPlaylistsMap.has(e.id||0)?this._playlistsList=this.ownersPlaylistsMap.get(e.id):this.fetchPlaylists()},this.onSubmitClick=()=>{this.onSubmit({ownerId:this.props.current.videoOwnerId,videoId:this.props.current.videoId}),this.messageBoxProps.onClose()},this.toggle=e=>{this.checkedIds?.has(e)?w.toggleSetById(this.toRemove,e):w.toggleSetById(this.toAdd,e)},this.getChecked=e=>this.toRemove.has(e)?!this.toRemove?.has(e):this.toAdd.has(e)?this.toAdd?.has(e):this.checkedIds?.has(e),this.targetId=0,this._playlistsList=void 0,this._abortController=void 0,this._error=void 0,this._chunkSize=50,this.toAdd=new Set,this.toRemove=new Set,this._id=void 0,this.checkedIdsMap=new Map,this.ownersPlaylistsMap=new Map,this.onSubmit=async({videoId:e,ownerId:t,playlistId:i,ref:o,context:s,accessKey:r})=>{const a=this.userModel.currentUser?.id===this.userModel.user?.id?this.userModel.currentUser?.id:this.targetId;try{if(this.toAdd.size&&await this.playlistsListService.addToAlbum({videoId:e,ref:o,albumIds:[...this.toAdd,...this.checkedIds??[]],albumId:i,accessKey:r,context:s,targetId:a,ownerId:t}),this.toRemove.size){if(this.props.current.playlistId){const{id:e}=(0,m.parseRawId)(this.props.current.playlistId);this._id=e}await this.playlistsListService.removeFromAlbum({videoId:e,albumIds:Array.from(this.toRemove),albumId:i,targetId:a,ownerId:t}),this._id&&Array.from(this.toRemove).includes(this._id)&&window.nav.reload()}(0,I.showSuccessSnackbar)(this.snackbar,this.langs.getLang("video_changes_saved"))}catch(e){(0,v.runInAction)((()=>{this._error=e})),(0,I.showFailSnackbar)(this.snackbar,this.langs.getLang("video_editor_popout_save_failed_header"))}this.toRemove.clear(),this.toAdd.clear()},this._playlistsList=s.createList(),this.groupsModel=new C.VideoGroupsFetchModel(this.authService,this.groupsProvider),this.videoGroupsStore=l.ensureByFields([]),this.userModel=new b.VideoUserFetchModel(this.props,this.userService,this.authService,this.usersStoreFactory,this.groupsModel),this.createNewPlaylistModel=new f.VideoCreateNewPlaylistModel(this.props,this.langs,this.videoPlaylistListProvider,this.playlistsListService,this._playlistsList,this.userModel,this.snackbar),(0,v.makeAutoObservable)(this)}}w.toggleSetById=(e,t)=>{e.has(t)?e.delete(t):e.add(t)},w=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===s.Props?Object:s.Props,void 0===h.Langs?Object:h.Langs,void 0===p.AuthService?Object:p.AuthService,void 0===r.VideoPlaylistsProvider?Object:r.VideoPlaylistsProvider,void 0===a.VideoPlaylistsListProvider?Object:a.VideoPlaylistsListProvider,void 0===n.VideoPlaylistsListService?Object:n.VideoPlaylistsListService,void 0===d.VideoGroupsFetchProvider?Object:d.VideoGroupsFetchProvider,void 0===l.VideoUsersFetchService?Object:l.VideoUsersFetchService,void 0===c.VideoUsersStoreFactory?Object:c.VideoUsersStoreFactory,void 0===u.VideoGroupsStoreFactory?Object:u.VideoGroupsStoreFactory,void 0===_.Snackbar?Object:_.Snackbar])],w);const{Provider:A,useModel:L}=(0,s.createProvider)(w)},462639:(e,t,i)=>{i.d(t,{VideoUserFetchModel:()=>s});var o=i(327813);class s{get error(){return this._error||this.groupsModel.error}get user(){return this.userData?.data}get name(){return this.userData?.name}setCurrentUser(e){this._currentUser=e}initUser(){this._currentUser=this.list.find((e=>e.id===this.props.current.ownerId))}get list(){const e=this.groupsModel.groupsItems?Array.from(this.groupsModel.groupsItems||[]):[];return this.user&&e.unshift(this.user),e}get currentUser(){return this._currentUser}async fetchUser(){try{await this.userService.fetch({fields:["photo_50"],userIds:this.authService.userId?[this.authService.userId]:void 0})}catch(e){console.error(e),this._error=e}}get userData(){if(this.authService.userId)return this.usersStoreFactory.ensureByFields(["photo_50"]).getById(this.authService.userId)}constructor(e,t,i,s,r){this.props=e,this.userService=t,this.authService=i,this.usersStoreFactory=s,this.groupsModel=r,this._error=void 0,this._currentUser=void 0,(0,o.makeAutoObservable)(this)}}},535354:(e,t,i)=>{i.d(t,{VideoPlaylistModelProvider:()=>o.VideoPlaylistModelProvider,useVideoPlaylistModel:()=>o.useVideoPlaylistModel});var o=i(943961)},435393:(e,t,i)=>{i.d(t,{showFailSnackbar:()=>o.showFailSnackbar,showSuccessSnackbar:()=>o.showSuccessSnackbar});var o=i(703025)},703025:(e,t,i)=>{i.d(t,{showFailSnackbar:()=>n,showSuccessSnackbar:()=>a});var o=i(474848),s=i(818515),r=i(326666);const a=(e,t)=>{e.show({text:t,type:"ok",duration:r.SNACKBAR_TIMEOUT,before:{content:(0,o.jsx)(s.Icon28ListCheckOutline,{})}})},n=(e,t)=>{e.show({text:t,type:"error",duration:r.SNACKBAR_TIMEOUT,before:{content:(0,o.jsx)(s.Icon28ListCheckOutline,{})}})}},789224:(e,t,i)=>{i.d(t,{VideoRestoreButton:()=>n});var o=i(474848),s=i(456921),r=i(279734),a=i(665271);const n=(0,s.observer)((function({restore:e}){return(0,o.jsx)(r.Link,{onClick:e,id:"video-restore-button-widget",children:(0,a.getLang)("video_restore")})}))},741496:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveButtonWidget:()=>l});var o=i(474848),s=i(456921),r=i(132028),a=i(390238),n=i(789224);const d=(0,s.observer)((function(){const{restore:e}=(0,a.useVideoRestoreFromFaveModel)();return(0,o.jsx)(n.VideoRestoreButton,{restore:e})})),l=(0,r.createWidget)(a.VideoRestoreFromFaveProvider,d)},96271:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveButtonWidget:()=>o.VideoRestoreFromFaveButtonWidget});var o=i(741496)},850594:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveProvider:()=>d,useVideoRestoreFromFaveModel:()=>l});var o=i(331635),s=i(327813),r=i(132028),a=i(485484);class n{constructor(e,t){this.videoBookmarksService=e,this.props=t,this.restore=async()=>{const{videoId:e,ownerId:t,onClick:i,onRestore:o}=this.props.current;if(!e||!t)return;i?.();await this.videoBookmarksService.add({ownerId:t,videoId:e})&&o?.()},(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.VideoBookmarksService?Object:a.VideoBookmarksService,void 0===r.Props?Object:r.Props])],n);const{Provider:d,useModel:l}=(0,r.createProvider)(n)},390238:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveProvider:()=>o.VideoRestoreFromFaveProvider,useVideoRestoreFromFaveModel:()=>o.useVideoRestoreFromFaveModel});var o=i(850594)},429584:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesButtonWidget:()=>l});var o=i(474848),s=i(456921),r=i(132028),a=i(930124),n=i(789224);const d=(0,s.observer)((function(){const{restore:e}=(0,a.useVideoRestoreFromLikesModel)();return(0,o.jsx)(n.VideoRestoreButton,{restore:e})})),l=(0,r.createWidget)(a.VideoRestoreFromLikesProvider,d)},856333:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesButtonWidget:()=>o.VideoRestoreFromLikesButtonWidget});var o=i(429584)},118204:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesProvider:()=>d,useVideoRestoreFromLikesModel:()=>l});var o=i(331635),s=i(327813),r=i(132028),a=i(129021);class n{constructor(e,t){this.videoLikesService=e,this.props=t,this.restore=async()=>{const{videoId:e,ownerId:t,onClick:i,onRestore:o}=this.props.current;if(!e||!t)return;i?.();await this.videoLikesService.add({type:"video",ownerId:t,itemId:e})&&o?.()},(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.VideoLikesService?Object:a.VideoLikesService,void 0===r.Props?Object:r.Props])],n);const{Provider:d,useModel:l}=(0,r.createProvider)(n)},930124:(e,t,i)=>{i.d(t,{VideoRestoreFromLikesProvider:()=>o.VideoRestoreFromLikesProvider,useVideoRestoreFromLikesModel:()=>o.useVideoRestoreFromLikesModel});var o=i(118204)},623424:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoButtonWidget:()=>l});var o=i(474848),s=i(456921),r=i(132028),a=i(337541),n=i(789224);const d=(0,s.observer)((function(){const{restore:e}=(0,a.useVideoRestoreFromVideoModel)();return(0,o.jsx)(n.VideoRestoreButton,{restore:e})})),l=(0,r.createWidget)(a.VideoRestoreFromVideoProvider,d)},215206:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoButtonWidget:()=>o.VideoRestoreFromVideoButtonWidget});var o=i(623424)},792718:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoProvider:()=>c,useVideoRestoreFromVideoModel:()=>u});var o=i(331635),s=i(327813),r=i(132028),a=i(751932),n=i(627016),d=i(853349);class l{constructor(e,t,i){this.videoVideosDeletingProvider=e,this.videoPlaylistsProvider=t,this.props=i,this.restore=async()=>{const{videoId:e,ownerId:t,targetId:i,playlistId:o,onClick:s,onRestore:r,isVideoModal:a}=this.props.current;if(!e||!t)return;s?.();(a||t===i&&o&&[d.MY_VIDEO_ALBUM_ID,d.UPLOADED_ALBUM_ID].includes(o)?await this.videoVideosDeletingProvider.restore({videoId:e,ownerId:t}):await this.videoPlaylistsProvider.addVideoToPlaylist({video_id:e,target_id:i,owner_id:t,album_id:o}))&&r?.()},(0,s.makeAutoObservable)(this)}}l=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.VideoVideosDeletingProvider?Object:a.VideoVideosDeletingProvider,void 0===n.VideoPlaylistsProvider?Object:n.VideoPlaylistsProvider,void 0===r.Props?Object:r.Props])],l);const{Provider:c,useModel:u}=(0,r.createProvider)(l)},337541:(e,t,i)=>{i.d(t,{VideoRestoreFromVideoProvider:()=>o.VideoRestoreFromVideoProvider,useVideoRestoreFromVideoModel:()=>o.useVideoRestoreFromVideoModel});var o=i(792718)},312159:(e,t,i)=>{i.d(t,{VideoRestoreFromFaveButtonWidget:()=>s.VideoRestoreFromFaveButtonWidget,VideoRestoreFromLikesButtonWidget:()=>r.VideoRestoreFromLikesButtonWidget,VideoRestoreFromVideoButtonWidget:()=>o.VideoRestoreFromVideoButtonWidget});var o=i(215206),s=i(96271),r=i(856333)},326666:(e,t,i)=>{i.d(t,{FINISHED_LIVE_STATUSES:()=>s,SNACKBAR_TIMEOUT:()=>o});const o=4e3,s=["postlive","finished"]},423151:(e,t,i)=>{i.d(t,{VideoClipsWidget:()=>a.VideoClipsWidget,showEditPlaylistCategoriesModal:()=>n.showEditPlaylistCategoriesModal,showPlaylistModal:()=>o.showPlaylistModal,showPlaylistModalWidget:()=>s.showPlaylistModalWidget,showSubscriptionsActualizationModal:()=>r.showSubscriptionsActualizationModal});i(22738);var o=i(977867),s=(i(153961),i(312159),i(840243)),r=i(177143),a=i(88454),n=i(381244)},307619:(e,t,i)=>{i.d(t,{VideoEditPlaylistCategoriesModal:()=>a});var o=i(132028),s=i(381551),r=i(34323);const a=(0,o.createWidget)(r.EditPlaylistCategoriesModalProvider,s.EditPlaylistCategoriesModal)},978508:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModal:()=>d});var o=i(474848),s=i(456921),r=i(211413),a=i(34323),n=i(783866);const d=(0,s.observer)((function(){const{isShow:e,isInitialLoading:t,refreshCoordinates:i}=(0,a.useEditPlaylistCategoriesModalModel)();return e?t?(0,o.jsx)(r.MessageBoxModalLoader,{refreshCoordinates:i}):(0,o.jsx)(n.ModalBox,{}):null}))},38673:(e,t,i)=>{i.d(t,{Errors:()=>l});var o=i(474848),s=i(149333),r=i(303800),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{submitError:t}=(0,d.useEditPlaylistCategoriesModalModel)();return t?(0,o.jsx)(r.Div,{mode:"horizontal",spacing:12,children:(0,o.jsx)(r.Div,{mode:"horizontal",spacing:0,children:(0,o.jsx)(a.FormStatus,{header:e.getLang("video_edit_playlist_categories_modal_error_submit"),mode:"error"})})}):null}))},672132:(e,t,i)=>{i.d(t,{ActorsField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t,getOptions:i,dynamicTags:n}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"actors",top:e.getLang("video_edit_playlist_categories_modal_actors_field_label"),children:(0,o.jsx)(a.ChipsSelect,{id:"actors",onInputChange:e=>n.loadTags("actors",e?.target.value),options:i("actors"),fetching:n.checkLoading("actors"),onChange:t?.actors.change,value:t?.actors.value,emptyText:n.checkSearchLengthError("actors")?e.getLang("video_edit_playlist_categories_modal_search_minimum_symbols_error"):void 0,forceDropdownPortal:!1})})}))},629442:(e,t,i)=>{i.d(t,{CategoriesField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"categories",top:e.getLang("video_edit_playlist_categories_modal_categories_field_label"),children:(0,o.jsx)(a.ChipsSelect,{id:"categories",options:i("categories"),onChange:t?.categories.change,value:t?.categories.value,forceDropdownPortal:!1})})}))},133346:(e,t,i)=>{i.d(t,{CountriesField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"countries",top:e.getLang("video_edit_playlist_categories_modal_countries_field_label"),children:(0,o.jsx)(a.ChipsSelect,{id:"countries",options:i("countries"),onChange:t?.countries.change,value:t?.countries.value,forceDropdownPortal:!1})})}))},295488:(e,t,i)=>{i.d(t,{CustomTagsField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"customTags",top:e.getLang("video_edit_playlist_categories_modal_tags_field_label"),children:(0,o.jsx)(a.ChipsSelect,{id:"customTags",options:i("customTags"),onChange:t?.customTags.change,value:t?.customTags.value,forceDropdownPortal:!1})})}))},928145:(e,t,i)=>{i.d(t,{DirectorsField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t,getOptions:i,dynamicTags:n}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"director",top:e.getLang("video_edit_playlist_categories_modal_directors_field_label"),children:(0,o.jsx)(a.ChipsSelect,{id:"director",onInputChange:e=>n.loadTags("directors",e?.target.value),options:i("directors"),fetching:n.checkLoading("directors"),onChange:t?.directors.change,value:t?.directors.value,emptyText:n.checkSearchLengthError("directors")?e.getLang("video_edit_playlist_categories_modal_search_minimum_symbols_error"):void 0,forceDropdownPortal:!1})})}))},192046:(e,t,i)=>{i.d(t,{GenresField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"genres",top:e.getLang("video_edit_playlist_categories_modal_genres_field_label"),children:(0,o.jsx)(a.ChipsSelect,{id:"genres",options:i("genres"),onChange:t?.genres.change,value:t?.genres.value,forceDropdownPortal:!1})})}))},877434:(e,t,i)=>{i.d(t,{KinopoiskIdField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"kinopoiskId",top:e.getLang("video_edit_playlist_categories_modal_kinopoisk_id_field_label"),mode:"horizontal",children:(0,o.jsx)(a.Input,{id:"kinopoiskId",defaultValue:t?.kinopoiskId.value,onChange:e=>t?.kinopoiskId.change(e.target.value)})})}))},946148:(e,t,i)=>{i.d(t,{RatingAgeField:()=>l});var o=i(474848),s=i(44544),r=i(753457),a=i(149333),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,a.useLangs)(),{fields:t,getOptions:i}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(s.FormItem,{htmlFor:"ratingAge",top:e.getLang("video_edit_playlist_categories_modal_rating_age_field_label"),mode:"horizontal",children:(0,o.jsx)(r.ChipsSelect,{id:"ratingAge",options:i("ratingAge"),onChange:t?.ratingAge.change,value:t?.ratingAge.value,forceDropdownPortal:!1})})}))},511076:(e,t,i)=>{i.d(t,{RatingKinopoiskField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"kinopoiskRate",top:e.getLang("video_edit_playlist_categories_modal_kinopoisk_rating_field_label"),mode:"horizontal",children:(0,o.jsx)(a.Input,{id:"kinopoiskRate",defaultValue:t?.ratingKinopoisk.value,onChange:e=>t?.ratingKinopoisk.change(e.target.value)})})}))},782531:(e,t,i)=>{i.d(t,{YearField:()=>l});var o=i(474848),s=i(149333),r=i(44544),a=i(753457),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{fields:t}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.FormItem,{htmlFor:"year",top:e.getLang("video_edit_playlist_categories_modal_year_field_label"),mode:"horizontal",children:(0,o.jsx)(a.Input,{id:"year",defaultValue:t?.year.value,onChange:e=>t?.year.change(e.target.value)})})}))},396810:(e,t,i)=>{i.d(t,{ActorsField:()=>o.ActorsField,CategoriesField:()=>r.CategoriesField,CountriesField:()=>a.CountriesField,CustomTagsField:()=>u.CustomTagsField,DirectorsField:()=>n.DirectorsField,GenresField:()=>d.GenresField,KinopoiskIdField:()=>l.KinopoiskIdField,RatingAgeField:()=>s.RatingAgeField,RatingKinopoiskField:()=>c.RatingKinopoiskField,YearField:()=>h.YearField});var o=i(672132),s=i(946148),r=i(629442),a=i(133346),n=i(928145),d=i(192046),l=i(877434),c=i(511076),u=i(295488),h=i(782531)},466925:(e,t,i)=>{i.d(t,{Footer:()=>l});var o=i(474848),s=i(149333),r=i(908242),a=i(454154),n=i(456921),d=i(34323);const l=(0,n.observer)((function(){const e=(0,s.useLangs)(),{submit:t,isLoading:i,isSubmitDisabled:n,close:l}=(0,d.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.ModalFooter,{actions:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Button,{mode:"secondary",size:"m",onClick:l,children:e.getLang("video_edit_playlist_categories_modal_close")}),(0,o.jsx)(a.Button,{mode:"primary",size:"m",onClick:t,loading:i,disabled:n,children:e.getLang("video_edit_playlist_categories_modal_submit")})]})})}))},757359:(e,t,i)=>{i.d(t,{Header:()=>d});var o=i(474848),s=i(149333),r=i(782174),a=i(456921),n=i(34323);const d=(0,a.observer)((function(){const e=(0,s.useLangs)(),{close:t}=(0,n.useEditPlaylistCategoriesModalModel)();return(0,o.jsx)(r.ModalHeader,{closeAriaLabel:e.getLang("video_edit_playlist_categories_modal_close"),onClose:t,children:e.getLang("video_edit_playlist_categories_modal_header")})}))},679026:(e,t,i)=>{i.d(t,{ModalBox:()=>u});var o=i(474848),s=i(694244),r=i(63614),a=i(303800),n=i(396810),d=i(38673),l=i(757359),c=i(466925);const u=()=>(0,o.jsxs)(s.ModalBox,{width:420,children:[(0,o.jsx)(l.Header,{}),(0,o.jsxs)(r.ModalBody,{insetLevel:0,children:[(0,o.jsx)(d.Errors,{}),(0,o.jsxs)(a.Div,{paddingTop:0,children:[(0,o.jsx)(n.CategoriesField,{}),(0,o.jsx)(n.ActorsField,{}),(0,o.jsx)(n.DirectorsField,{}),(0,o.jsx)(n.CountriesField,{}),(0,o.jsx)(n.GenresField,{}),(0,o.jsx)(n.CustomTagsField,{}),(0,o.jsx)(n.KinopoiskIdField,{}),(0,o.jsx)(n.YearField,{}),(0,o.jsx)(n.RatingKinopoiskField,{}),(0,o.jsx)(n.RatingAgeField,{})]})]}),(0,o.jsx)(c.Footer,{})]})},783866:(e,t,i)=>{i.d(t,{ModalBox:()=>o.ModalBox});var o=i(679026)},381551:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModal:()=>o.EditPlaylistCategoriesModal});var o=i(978508)},699644:(e,t,i)=>{i.d(t,{showEditPlaylistCategoriesModal:()=>o.showEditPlaylistCategoriesModal});i(307619);var o=i(462108)},597322:(e,t,i)=>{i.d(t,{DynamicTags:()=>n});var o=i(327813),s=i(165268),r=i(8520);const a={actors:s.VideoMovieInfoDropdownDataTypeParams.ACTOR,directors:s.VideoMovieInfoDropdownDataTypeParams.DIRECTOR};class n{setSearchError(e,t){this.searchLengthErrors.set(e,t)}constructor(e){this.movieInfoDropdownProvider=e,this.checkLoading=e=>Boolean(this.pendingMap.get(e)),this.checkSearchLengthError=e=>this.searchLengthErrors.get(e)??!0,this.get=e=>this.dynamicOptions.get(e)||[],this.loadTags=(0,r.debounce)((async(e,t)=>{if(this.setSearchError(e,!1),t.length<2)return this.setSearchError(e,!0),void this.dynamicOptions.delete(e);this.checkLoading(e)&&this.pendingMap.get(e)?.controller.abort();const i=new AbortController,s=this.movieInfoDropdownProvider.fetch({type:a[e],search:t},{signal:i.signal});this.pendingMap.set(e,{request:s,controller:i});try{const t=await s;(0,o.runInAction)((()=>{this.dynamicOptions.set(e,t),this.pendingMap.delete(e)}))}catch(t){(0,o.runInAction)((()=>{this.dynamicOptions.delete(e)}))}}),400),this.pendingMap=new Map,this.dynamicOptions=new Map,this.searchLengthErrors=new Map,(0,o.makeAutoObservable)(this)}}},757428:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModalProvider:()=>h,useEditPlaylistCategoriesModalModel:()=>p});var o=i(331635),s=i(132028),r=i(406341),a=i(165268),n=i(327813),d=i(949322),l=i(597322),c=i(346090);class u{get dynamicTags(){return this._dynamicTags}get isShow(){return this._isShow}get refreshCoordinates(){return this._props.current.refreshCoordinates}get isInitialLoading(){return this._isInitialLoading}get isLoading(){return this._isLoading}get submitError(){return this._submitError}get isSubmitDisabled(){return!this._form?.isChanged}get fields(){return this._form?.fields}async[s.init](){this._isInitialLoading=!0,this.abortController=new AbortController;try{const e=await this.movieInfoProvider.fetch({ownerId:this.ownerId,playlistId:this.playlistId},{signal:this.abortController.signal});(0,n.runInAction)((()=>{this._currentState=e;const t=this._currentState?.values.ratingAge?(0,d.getOptionsByIds)([this._currentState?.values.ratingAge],this.getOptions("ratingAge")):[];this._form=new c.Form({fields:{categories:{value:(0,d.getOptionsByIds)(this._currentState?.values.categoryIds,this.getOptions("categories"))},actors:{value:(0,d.getOptionsByTags)(this._currentState?.values.actors)},directors:{value:(0,d.getOptionsByTags)(this._currentState?.values.directors)},countries:{value:(0,d.getOptionsByIds)(this._currentState?.values.countryIds,this.getOptions("countries"))},genres:{value:(0,d.getOptionsByIds)(this._currentState?.values.genreIds,this.getOptions("genres"))},customTags:{value:(0,d.getOptionsByIds)(this._currentState?.values.customTagIds,this.getOptions("customTags"))},kinopoiskId:{value:String(this._currentState?.values.kinopoiskId||"")},year:{value:String(this._currentState?.values.year||"")},ratingKinopoisk:{value:String(this._currentState?.values.ratingKinopoisk||"")},ratingAge:{value:t,preparator:(0,d.getNewValueForRatingAge)(t)}}})}))}catch(e){(0,n.runInAction)((()=>{this._currentState=void 0}))}finally{(0,n.runInAction)((()=>{this._isInitialLoading=!1,this.abortController=null}))}}[s.destroy](){this.abortController?.abort()}get ownerId(){return this._props.current.ownerId}get playlistId(){return this._props.current.playlistId}constructor(e,t,i){this.movieInfoProvider=e,this.movieInfoDropdownProvider=t,this._props=i,this.getOptions=e=>"ratingAge"===e?(0,d.getOptionsByTags)(this._currentState?.options.ratingAges):"actors"===e||"directors"===e?(0,d.getOptionsByTags)(this._dynamicTags.get(e),!0):(0,d.getOptionsByTags)(this._currentState?.options[e]),this.close=()=>{this._isShow=!1,this._props.current.onClose()},this.submit=async()=>{if(this._currentState&&this.fields){this._submitError=!1,this._isLoading=!0;try{await this.movieInfoProvider.update({ownerId:this.ownerId,playlistId:this.playlistId,infoUpdatedAt:this._currentState.values.infoUpdatedAt,ratingAge:(0,d.getIdsFromOptions)(this.fields.ratingAge.value)?.[0],year:(0,d.getNumberOrUndefined)(this.fields.year.value),ratingKinopoisk:(0,d.getNumberOrUndefined)(this.fields.ratingKinopoisk.value),kinopoiskId:(0,d.getNumberOrUndefined)(this.fields.kinopoiskId.value),categoryIds:(0,d.getIdsFromOptions)(this.fields.categories.value),actorIds:(0,d.getIdsFromOptions)(this.fields.actors.value),directorIds:(0,d.getIdsFromOptions)(this.fields.directors.value),countryIds:(0,d.getIdsFromOptions)(this.fields.countries.value),genreIds:(0,d.getIdsFromOptions)(this.fields.genres.value),customTagIds:(0,d.getIdsFromOptions)(this.fields.customTags.value)})&&this.close()}catch(e){(0,n.runInAction)((()=>{this._submitError=!0}))}finally{(0,n.runInAction)((()=>{this._isLoading=!1}))}}},this._form=void 0,this._isShow=!0,this._isInitialLoading=!1,this._isLoading=!1,this._submitError=!1,this._currentState=void 0,this.abortController=null,this._dynamicTags=new l.DynamicTags(t),(0,n.makeAutoObservable)(this)}}u=(0,o.__decorate)([s.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.VideoMovieInfoProvider?Object:r.VideoMovieInfoProvider,void 0===a.VideoMovieInfoDropdownDataProvider?Object:a.VideoMovieInfoDropdownDataProvider,void 0===s.Props?Object:s.Props])],u);const{Provider:h,useModel:p}=(0,s.createProvider)(u)},97318:(e,t,i)=>{i.d(t,{Form:()=>r});var o=i(327813),s=i(504392);class r{get isChanged(){return this.fieldKeys.reduce(((e,t)=>e||this._fields[t].isChanged),!1)}get isValid(){return this.fieldKeys.reduce(((e,t)=>e||this._fields[t].isValid),!1)}get fields(){return this._fields}validate(){return this.fieldKeys.reduce(((e,t)=>{const i=this._fields[t].validate();return i&&e.push(i),e}),[])}get fieldKeys(){return Object.keys(this._fields)}constructor({fields:e}){this._fields={},Object.keys(e).forEach((t=>{this._fields[t]=new s.FormField(e[t])})),(0,o.makeAutoObservable)(this)}}},504392:(e,t,i)=>{i.d(t,{FormField:()=>a});var o=i(327813),s=i(8520),r=i(205051);class a{get value(){return this._value}get changedValue(){if(this._changed)return this._value}get isChanged(){return this._changed}get isValid(){return!this.validationError}get validationError(){return this._validationError}validateValue(e){const t=this.validateByRequired();if(t)return this._validationError=t,t;const i=this.validator(e);return this._validationError=i,i}validateByRequired(){return this._required&&!this._value||this._required&&Array.isArray(this._value)&&this._value?.length?r.ValidationErrors.REQUIRED:""}constructor({value:e,validator:t,required:i,preparator:r}){this.change=e=>{const t=this.preparator(e);this._changed=!(0,s.isEqual)(t,this._initialValue),this._value=t,this.validateValue(t)},this.validate=()=>{const e=this.validateByRequired();if(e)return this._validationError=e,e;const t=this.validator(this._value);return this._validationError=t,t},this._initialValue=void 0,this._changed=!1,this._validationError="",this._value=void 0,this._required=Boolean(i),this._value=e,this._initialValue=e,this.preparator=r||(e=>e),this.validator=t||(()=>""),(0,o.makeAutoObservable)(this)}}},346090:(e,t,i)=>{i.d(t,{Form:()=>o.Form});i(205051);var o=i(97318);i(504392)},205051:(e,t,i)=>{var o;i.d(t,{ValidationErrors:()=>o}),function(e){e.REQUIRED="required"}(o||(o={}))},34323:(e,t,i)=>{i.d(t,{EditPlaylistCategoriesModalProvider:()=>o.EditPlaylistCategoriesModalProvider,useEditPlaylistCategoriesModalModel:()=>o.useEditPlaylistCategoriesModalModel});var o=i(757428)},949322:(e,t,i)=>{i.d(t,{getIdsFromOptions:()=>a,getNewValueForRatingAge:()=>o,getNumberOrUndefined:()=>n,getOptionsByIds:()=>s,getOptionsByTags:()=>r});const o=e=>t=>t.length?2===t.length?[t[1]]:[t[0]]:e,s=(e,t)=>e&&e.length&&t?t.filter((({value:t})=>e.includes(Number(t)))):[],r=(e,t=!1)=>e?e.map((({id:e,name:i})=>({value:e,label:t?`${i} (${e})`:i}))):[],a=e=>{if(e)return e.map((e=>Number(e.value)))},n=e=>e?Number(e):void 0},462108:(e,t,i)=>{i.d(t,{showEditPlaylistCategoriesModal:()=>a});var o=i(474848),s=i(211413),r=i(307619);const a=e=>{(0,s.showMessageBoxModal)((t=>(0,o.jsx)(r.VideoEditPlaylistCategoriesModal,{...e,...t})),{fullscreen:!0})}},381244:(e,t,i)=>{i.d(t,{showEditPlaylistCategoriesModal:()=>o.showEditPlaylistCategoriesModal});var o=i(699644)},213810:(e,t,i)=>{i.d(t,{getPlaylistUrl:()=>o});const o=e=>`/video/playlist/${e}`},374856:(e,t,i)=>{i.d(t,{isLiveVideo:()=>s});var o=i(326666);const s=({live_status:e})=>Boolean(e&&!o.FINISHED_LIVE_STATUSES.includes(e))},492459:(e,t,i)=>{i.d(t,{CatalogAction:()=>r});var o=i(327813),s=i(832920);class r{fire(){this.actionsEmitter.emit("action",{action:this})}constructor({data:e,actionsEmitter:t}){this.handleSelectOption=e=>{const t={abortController:new AbortController,option:e};return this.actionsEmitter.emit("option",t),t},this.data=e,this.actionsEmitter=t;const{options:i}=this.data;this.options=i?.map((e=>new s.CatalogActionOption({onSelect:this.handleSelectOption,data:e})))??null,(0,o.makeAutoObservable)(this)}}},832920:(e,t,i)=>{i.d(t,{CatalogActionOption:()=>s});var o=i(327813);class s{select(){return this.onSelect(this)}constructor({onSelect:e,data:t}){this.data=t,this.onSelect=e,(0,o.makeAutoObservable)(this)}}},173907:(e,t,i)=>{i.d(t,{CatalogBlock:()=>a});var o=i(327813),s=i(492459);const r=["audios_ids","albums_ids","group_items","search_author_items","videos_ids","market_item_ids","games_items","catalog_users_ids","mini_app_ids"];class a{get isNextLoading(){return Boolean(this.nextFetching)}get providers(){return this.entities.providers}get id(){return this.data.id}get isLoaded(){return!this._nextFrom}get nextFrom(){return this._nextFrom}async fetchNext(){if(this.nextFetching)return this.nextFetching;this.nextFetching=this._fetchNext(),await this.nextFetching,(0,o.runInAction)((()=>{this.nextFetching=null}))}async _fetchNext(){const e=this._nextFrom;if(!e)return;const t=await this.catalogApi.getBlockItems({block_id:this.id,start_from:e}),{block:i}=t;i&&(0,o.runInAction)((()=>{this.entities.update(t),this.merge(i),this._nextFrom=i.next_from??null}))}merge(e){for(const t of r)n(this.data,e,t)}get statInfosMap(){return this.data.stat_infos?.reduce(((e,t)=>(e.set(t.item_id,t),e)),new Map)}constructor({data:e,entities:t,catalogApi:i,actionsEmitter:r}){this._nextFrom=null,this.nextFetching=null,this.catalogApi=i,this.data=e,this.entities=t,this.actionsEmitter=r,this._nextFrom=e.next_from??null,this.actions=e.actions?.map((e=>new s.CatalogAction({data:e,actionsEmitter:r})))??null,(0,o.makeAutoObservable)(this)}}function n(e,t,i){const o=t[i],s=e[i];Array.isArray(o)&&Array.isArray(s)&&s.push(...o)}},863297:(e,t,i)=>{i.d(t,{Catalog:()=>n});var o=i(327813),s=i(173907),r=i(813682),a=i(584053);class n{createHeaderBlock(e){const t=new s.CatalogBlock({data:e,entities:this.entities,catalogApi:this.catalogApi,actionsEmitter:this.actionsEmitter});return this._headerBlockIds.push(t.id),this._headerBlocksMap.set(t.id,t),t}get headerBlockIds(){return this._headerBlockIds}getHeaderBlock(e){return this._headerBlocksMap.get(e)}get providers(){return this.entities.providers}get activeSection(){return this.sectionsMap.get(this._activeSectionId)}get activeSectionId(){return this._activeSectionId}get actions(){return this.actionsEmitter.listenable}setActiveSection(e){this._activeSectionId=e}getSectionFetching(e){return Boolean(this.sectionsFetchingMap.get(e))}get rootSections(){const e=[];for(const t of this.rootSectionIds){const i=this.sectionsMap.get(t);i&&e.push(i)}return e}getSectionByUrl(e){let t;for(const i of this.sectionsMap.values())if(i.url===e){t=i;break}return t}getSectionById(e){return this.sectionsMap.get(e)}async fetchSection(e,t){const{section_id:i}=e,s=this.sectionsFetchingMap.get(i);if(s)return s;this.sectionsFetchingMap.set(i,this._fetchSection(e,t));try{await this.sectionsFetchingMap.get(i)}finally{(0,o.runInAction)((()=>{this.sectionsFetchingMap.set(i,null)}))}return this.sectionsMap.get(i)}async _fetchSection(e,t){const i=await this.catalogApi.getSection(e,t),{section:s}=i;s&&(0,o.runInAction)((()=>{this.addSection(s),this.entities.update(i)}))}addSection(e){const t=this.createSection(e);return this.sectionsMap.set(t.id,t),t}updateEntities(e){this.entities.update(e)}createSection(e){return new r.CatalogSection({data:e,entities:this.entities,catalogApi:this.catalogApi,actionsEmitter:this.actionsEmitter})}constructor({data:e,entities:t,catalogApi:i,entitiesSource:s}){this.actionsEmitter=new a.Emitter,this._headerBlocksMap=new Map,this._headerBlockIds=[],this.sectionsMap=new Map,this.sectionsFetchingMap=new Map,this.catalogApi=i,this.data=e,this.entities=t,this.rootSectionIds=[];for(const e of this.data.sections){const t=this.addSection(e);this.rootSectionIds.push(t.id)}if(this.data.header&&Array.isArray(this.data.header.blocks))for(const e of this.data.header.blocks)this.createHeaderBlock(e);s&&this.entities.update(s),this._activeSectionId=e.default_section,(0,o.makeAutoObservable)(this)}}},813682:(e,t,i)=>{i.d(t,{CatalogSection:()=>r});var o=i(327813),s=i(173907);class r{get isNextLoading(){return Boolean(this._nextFetching)}get providers(){return this.entities.providers}get id(){return this.data.id}get title(){return this.data.title}get url(){const e=this.data?.url;return e?decodeURI(e):e}get actions(){return this.data?.actions}getIsBlockLoading(e){return Boolean(this.isBlocksLoading.get(e))}get blockIds(){return this._blockIds}get blocks(){const e=[];for(const t of this.blockIds){const i=this.blocksMap.get(t);i&&e.push(i)}return e}getBlock(e){return this.blocksMap.get(e)}get isLoaded(){return!this._nextFrom}get nextFrom(){return this._nextFrom}update(e){this._nextFrom=e.next_from??null,e.blocks&&this.updateBlocks(e.blocks)}updateBlock(e){e&&this.blocksMap.get(e.id)?.merge(e)}updateBlocks(e){for(const t of e){this.blocksMap.get(t.id)?this.updateBlock(t):(this._blockIds.push(t.id),this.createBlock(t))}}async fetchNext(e){if(this._nextFetching)return this._nextFetching;this._nextFetching=this._fetchNext(e),await this._nextFetching,(0,o.runInAction)((()=>{this._nextFetching=null}))}async _fetchNext(e){const t=this._nextFrom;if(t||!this.blocks.length)try{const i=await this.catalogApi.getSection({section_id:this.id,start_from:t??void 0},e),s=i.section,r=s?.blocks?.some((e=>"placeholder"===e.data_type));if(!s||r)return void(this._nextFrom=null);(0,o.runInAction)((()=>{this.entities.update(i),this.update(s)}))}catch(e){console.error("Error fetching next section:",e),this._nextFrom=null}}async replaceBlocks(e,t){const[i,s]=e.split("/");if(this.blocksMap.get(i))if(this.blocksMap.get(s))this.replacementBlock(i,s);else{if(this.isBlocksLoading.get(i))return this.isBlocksLoading.get(i);this.isBlocksLoading.set(i,this._replaceBlock(e,t));try{await this.isBlocksLoading.get(i)}finally{(0,o.runInAction)((()=>{this.isBlocksLoading.set(i,null)}))}}}async _replaceBlock(e,t){const i=await this.catalogApi.replaceBlocks({replacement_ids:e},{signal:t.signal}),{replacements:s}=i;if(!s)return;const{replacements:r}=s;(0,o.runInAction)((()=>{this.entities.update(i),r?.forEach((({from_block_ids:e,to_blocks:t=[]})=>{e?.forEach(((e,i)=>{let o=t[i];if(!o)return;const s=this.createBlock(o);this.replacementBlock(e,s.id)}))}))}))}replacementBlock(e,t){const i=this._blockIds.findIndex((t=>t===e));-1!==i&&this._blockIds.splice(i,1,t)}createBlock(e){const t=new s.CatalogBlock({data:e,entities:this.entities,catalogApi:this.catalogApi,actionsEmitter:this.actionsEmitter});return this.blocksMap.set(t.id,t),t}removeBlocks(e){e.forEach((e=>{this.blocksMap.delete(e);const t=this._blockIds.indexOf(e);t>-1&&this._blockIds.splice(t,1)}))}constructor({data:e,entities:t,catalogApi:i,actionsEmitter:s}){this.handleOption=({option:e,abortController:t})=>{e&&this.replaceBlocks(e.data.replacement_id,t)},this.blocksMap=new Map,this.isBlocksLoading=new Map,this._blockIds=[],this._nextFrom=null,this._nextFetching=null,this.catalogApi=i,this.actionsEmitter=s,this.data=e,this.entities=t,this._nextFrom=e.next_from??null,e.blocks&&this.updateBlocks(e.blocks),this.actionsEmitter.listenable.on("option",this.handleOption),(0,o.makeAutoObservable)(this)}}},664700:(e,t,i)=>{i.d(t,{CatalogEntities:()=>a});var o=i(331635),s=i(327813),r=i(382579);class a{update(e){const t=function(e){return{__dangerous_arrays:e,maps:n(e)}}(e);for(const i of r.CATALOG_ENTITY_PROVIDER_NAMES){const o=e[i],s=this.providers[i];o&&s&&s.setMany(o,t)}return this}constructor(e){this.providers=e}}function n(e){return{audios:l(e.audios),audio_stream_mixes:d(e.audio_stream_mixes),artists:d(e.artists),playlists:l(e.playlists),catalog_banners:d(e.catalog_banners),games:d(e.games),profiles:d(e.profiles),groups:d(e.groups),group_collection_items:d(e.group_collection_items),videos:l(e.videos),albums:l(e.albums),placeholders:d(e.placeholders),suggestions:d(e.suggestions),search_filters:d(e.search_filters),search_suggestions:d(e.search_suggestions),classifieds_cities:d(e.classifieds_cities),classifieds_category_tree:c((({id:e})=>String(e)),e.classifieds_category_tree),radio_stations:d(e.radio_stations),market_items:l(e.market_items),navigation_tabs:d(e.navigation_tabs),search_spellcheckers:d(e.search_spellcheckers),catalog_users:c((({item_id:e})=>e),e.catalog_users),mini_apps:d(e.mini_apps),market_community_reviews:d(e.market_community_reviews),market_item_reviews:c((({owner_id:e,item_id:t,id:i})=>`${e}_${t}_${i}`),e.market_item_reviews),market_item_review_prepared:c((({community_id:e,item_id:t})=>`${e}_${t}`),e.market_item_review_prepared)}}function d(e){return c((({id:e})=>e),e)}function l(e){return c((({owner_id:e,id:t})=>{if(null!=e&&null!=t)return`${e}_${t}`}),e)}function c(e,t){const i=new Map;if(!t)return i;for(const o of t){const t=e(o);null!=t&&i.set(t,o)}return i}(0,o.__decorate)([s.action,(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",["undefined"==typeof CatalogEntitiesUpdateSource?Object:CatalogEntitiesUpdateSource]),(0,o.__metadata)("design:returntype",Object)],a.prototype,"update",null)},154481:(e,t,i)=>{i.d(t,{CatalogEntitiesBaseStore:()=>s,CatalogEntityProvider:()=>r});var o=i(327813);class s{get(e){return this.entities.get(e)}set(e){const t=this.toKey(e),i=this.toEntity?this.toEntity(e):e;this.entities.set(t,i)}has(e){return this.entities.has(e)}constructor({toKey:e,toEntity:t}){this.entities=new Map,this.toKey=e,this.toEntity=t,(0,o.makeAutoObservable)(this)}}class r{get(e){return this.store.get(e)}getStrict(e){const t=this.get(e);if(!t)throw new Error(`Entity instance for ${e} not found`);return t}set(e,t){this.store.set(e,t)}setMany(e,t){for(const i of e)this.set(i,t);return this}has(e){return!!this.store.has&&this.store.has(e)}constructor(e){this.store=e,(0,o.makeAutoObservable)(this)}}},31287:(e,t,i)=>{i.d(t,{createCatalogGroupsProvider:()=>r});var o=i(154481);class s{get(e){return this.groupsProvider.getGroup(e)}set(e){this.groupsProvider.createGroupFromApi({apiGroup:e,fields:""})}constructor(e){this.groupsProvider=e}}const r=e=>new o.CatalogEntityProvider(new s(e))},152685:(e,t,i)=>{i.d(t,{creatPlaceholdersProvider:()=>r,createCatalogPlaceholdersProvider:()=>s});var o=i(154481);const s=()=>new o.CatalogEntityProvider(new o.CatalogEntitiesBaseStore({toKey:e=>e.id})),r=s},382579:(e,t,i)=>{i.d(t,{CATALOG_ENTITY_PROVIDER_NAMES:()=>o});const o=["audios","audio_stream_mixes","playlists","artists","catalog_banners","games","profiles","groups","group_collection_items","videos","albums","placeholders","suggestions","search_filters","search_suggestions","classifieds_cities","classifieds_category_tree","radio_stations","market_items","navigation_tabs","search_spellcheckers","catalog_users","mini_apps","market_community_reviews","market_item_reviews","market_item_review_prepared"]},301250:(e,t,i)=>{i.d(t,{FriendsService:()=>d});var o=i(331635),s=i(327813),r=i(208214),a=i(132028),n=i(655465);class d{async fetch(e,t){const i=await this.friendsApi.get(e,t);if((0,n.isFriendsGetFieldsResponse)(i))throw new Error("Unexpected friends.get fetch response format");return i}async fetchFields(e,t){const i=await this.friendsApi.get(e,t);if(!(0,n.isFriendsGetFieldsResponse)(i))throw new Error("Unexpected friends.get fetchFields response format");return i}constructor(e){this.friendsApi=e,(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.FriendsApi?Object:r.FriendsApi])],d)},3969:(e,t,i)=>{i.d(t,{FriendsListsListsProvider:()=>d});var o=i(331635),s=i(327813),r=i(208214),a=i(951652),n=i(132028);class d{getIsLoading(e){return Boolean(this.requestsMap.get(e))}getIsLoadingCurrentUser(){return this.getIsLoading(this.authService.ensureUserId())}async request(e,t){this.abortController=new AbortController;const i=await this.friendsApi.getLists(e,{signal:this.abortController?.signal});return this.friendsListMap.set(t,i.items),i.items}async fetch(e){const t={user_id:e.userId,return_system:e.returnSystem?1:0},i=this.request(t,e.userId);this.requestsMap.set(e.userId,i);try{return await i}catch{return[]}finally{this.requestsMap.delete(e.userId)}}async ensure(e){const t=this.requestsMap.get(e.userId);if(t)return await t;const i=this.friendsListMap.get(e.userId);return i||this.fetch(e)}async ensureForCurrentUser(e={}){return this.ensure({...e,userId:this.authService.ensureUserId()})}reset(){this.friendsListMap.clear(),this.abortController?.abort(),this.requestsMap.clear()}constructor(e,t){this.friendsApi=e,this.authService=t,this.abortController=null,this.requestsMap=new Map,this.friendsListMap=new Map,(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([n.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.FriendsApi?Object:r.FriendsApi,void 0===a.AuthService?Object:a.AuthService])],d)},889781:(e,t,i)=>{i.d(t,{FriendsSearchService:()=>n});var o=i(331635),s=i(327813),r=i(208214),a=i(132028);class n{async search(e,t){return this.friendsApi.search(e,t)}constructor(e){this.friendsApi=e,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.FriendsApi?Object:r.FriendsApi])],n)},655465:(e,t,i)=>{i.d(t,{isFriendsGetFieldsResponse:()=>o});const o=e=>!e.items.length||e.items.some((e=>"number"!=typeof e))},564616:(e,t,i)=>{i.d(t,{AudioClipsProvider:()=>r});var o=i(327813),s=i(222012);class r{getAudioClip(e){return this.data.audioClipsMap.get(e)}createAudioClipFromApi(e){const t=new s.AudioClip(e);return this.data.audioClipsMap.set(t.rawId,t),t}constructor(){this.data={audioClipsMap:new Map},(0,o.makeAutoObservable)(this)}}},222012:(e,t,i)=>{i.d(t,{AudioClip:()=>r});var o=i(327813),s=i(873900);class r{get rawId(){const{id:e,owner_id:t}=this.data;return(0,s.getIdentityRawId)({id:e,ownerId:t})}constructor(e){this.data=e,(0,o.makeAutoObservable)(this)}}},543116:(e,t,i)=>{i.d(t,{AudioClipsListsProvider:()=>l});var o=i(331635),s=i(327813),r=i(52016),a=i(132028),n=i(564616),d=i(42006);class l{createSearchList(){return new d.AudioClipsSearchList(this.audioClipsProvider,this.catalogApi)}constructor(e,t){this.audioClipsProvider=e,this.catalogApi=t,(0,s.makeAutoObservable)(this)}}l=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.AudioClipsProvider?Object:n.AudioClipsProvider,void 0===r.CatalogApi?Object:r.CatalogApi])],l)},42006:(e,t,i)=>{i.d(t,{AudioClipsSearchList:()=>s});var o=i(327813);class s{get count(){return this.ids.length}get items(){const e=[];for(const t of this.ids){const i=this.audioClipsProvider.getAudioClip(t);if(!i)return e;e.push(i)}return e}reset(){this.abortController?.abort(),this.resetState()}resetState(){this.ids=[],this.isLoading=!1,this.initialLoad=!1,this.abortController=null}async request(e,t){const i=await this.catalogApi[e.query?"getAudioClipsSearch":"getAudioClips"]({query:e.query,need_blocks:1},{signal:t.signal}),o=i.short_video_audios?"short_video_audios":"audios";return{items:i[o]?.map((e=>this.audioClipsProvider.createAudioClipFromApi(e)))||[]}}async fetch(e){this.abortController&&this.abortController.abort(),this.resetState(),this.isLoading=!0,this.initialLoad||(this.initialLoad=!0),this.abortController=new AbortController;const t=await this.request(e,this.abortController);this.handleResponse(t)}handleResponse(e){this.ids=e.items.map((e=>e.rawId)),this.isLoading=!1,this.abortController=null}constructor(e,t){this.audioClipsProvider=e,this.catalogApi=t,this.ids=[],this.abortController=null,this.initialLoad=!1,this.isLoading=!1,(0,o.makeAutoObservable)(this)}}},791018:(e,t,i)=>{var o;i.d(t,{PrivacyAliases:()=>o}),function(e){e.all="all",e.byLink="by_link",e.friendsOfFriends="friends_of_friends",e.friends="friends",e.onlyMe="only_me",e.allExcept="all_except",e.someFriends="some_friends",e.someFriendLists="some_friend_lists",e.bestFriends="best_friends"}(o||(o={}))},891999:(e,t,i)=>{i.d(t,{UsersProvider:()=>n});var o=i(331635),s=i(132028),r=i(488709),a=i(327813);class n{createUserFromAPI(e){return(0,a.observable)(e)}async fetchUsersByIds(e,t){return(await this.usersApi.get({user_ids:e.userIds.join(","),fields:e.fields?.join(",")},t)).map((e=>this.createUserFromAPI(e)))}constructor(e){this.usersApi=e,(0,a.makeAutoObservable)(this)}}n=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.UsersApi?Object:r.UsersApi])],n)},694049:(e,t,i)=>{i.d(t,{VideoPlaylistSubscribeService:()=>l});var o=i(331635),s=i(132028),r=i(882044),a=i(327813),n=i(768035),d=i(446367);class l{async toggle(e,t){const i=this.getIsSubscribed(e);return i?await this.unsubscribe(e,t):await this.subscribe(e,t),!i}subscribe(e,t){const{id:i,ownerId:o}=(0,n.parseRawId)(e);return this.baseFieldService.edit(e,(async()=>{const s={album_id:i,owner_id:o};await this.videoApi.subscribeToAlbum(s,t),this.setIsSubscribed(e,!0)}))}unsubscribe(e,t){const{id:i,ownerId:o}=(0,n.parseRawId)(e);return this.baseFieldService.edit(e,(async()=>{const s={album_id:i,owner_id:o};await this.videoApi.unsubscribeFromAlbum(s,t),this.setIsSubscribed(e,!1)}))}setIsSubscribed(e,t){if(void 0!==t)return this.baseFieldService.setValue(e,t)}getIsSubscribed(e){return this.baseFieldService.getValue(e)}getIsLoading(e){return this.baseFieldService.isLoading(e)}constructor(e){this.videoApi=e,this.baseFieldService=new d.VideoPlaylistBaseField,(0,a.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.global(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.VideoApi?Object:r.VideoApi])],l)},233981:(e,t,i)=>{i.d(t,{VideoPlaylistThumbProvider:()=>n});var o=i(331635),s=i(327813),r=i(882044),a=i(132028);class n{async getPlaylistThumbUploadUrl(e,t){const{upload_url:i}=await this.videoApi.getPlaylistThumbUploadUrl(e,{signal:t?.signal});return i}async uploadFile(e,t,i){const o=new FormData;o.append("photo",e);return(await fetch(t,{method:"POST",body:o,signal:i.signal})).json()}async upload(e,t,i){const{ownerId:o}=t,s=await this.getPlaylistThumbUploadUrl({owner_id:o,type:1},i),r=await this.uploadFile(e,s,i);return this.videoApi.savePlaylistThumb({owner_id:o,thumb_json:JSON.stringify(r),thumb_size:"l"},i)}constructor(e){this.videoApi=e,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.VideoApi?Object:r.VideoApi])],n)},968192:(e,t,i)=>{i.d(t,{VideoPlaylistsListProvider:()=>d});var o=i(331635),s=i(327813),r=i(915177),a=i(132028),n=i(627016);class d{createList(){return new r.VideoPlaylistsList(this.videoPlaylistProvider)}constructor(e){this.videoPlaylistProvider=e,(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===n.VideoPlaylistsProvider?Object:n.VideoPlaylistsProvider])],d)},491318:(e,t,i)=>{i.d(t,{VideoPlaylistsListService:()=>d});var o=i(331635),s=i(327813),r=i(882044),a=i(132028),n=i(800227);class d{getContainingVideoPlaylistIds(e){return this.playlistsIdByVideoMap.get(e)}getContainingVideoPlaylists(e){return this.playlistsByVideoMap.get(e)}async addToAlbum({videoId:e,albumId:t,albumIds:i,targetId:o,ownerId:s,accessKey:r,ref:a,context:n},d){const l={video_id:e,target_id:o,access_key:r,owner_id:s,album_id:t,album_ids:i?.join(","),ref:a,context:n};return await this.videoApi.addToAlbum(l,d)}async removeFromAlbum({ownerId:e,albumId:t,albumIds:i,targetId:o,videoId:s},r){const a={owner_id:e,video_id:s,album_id:t,target_id:o,album_ids:i?.join(",")};return await this.videoApi.removeFromAlbum(a,r)}async fetchAlbumsByVideo({targetId:e,videoId:t,ownerId:i,extended:o},r){const a={extended:(0,n.convertToBooleanParam)(o),video_id:t,target_id:e,owner_id:i},d=await this.videoApi.getAlbumsByVideo(a,r);return(0,s.runInAction)((()=>{if(Array.isArray(d))this.playlistsIdByVideoMap.set(a.video_id,new Set(d));else{const e=d.items.map((e=>e.id));this.playlistsIdByVideoMap.set(a.video_id,new Set(e)),this.playlistsByVideoMap.set(a.video_id,d.items)}})),d}constructor(e){this.videoApi=e,this.playlistsIdByVideoMap=new Map,this.playlistsByVideoMap=new Map,(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([a.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.VideoApi?Object:r.VideoApi])],d)},627016:(e,t,i)=>{i.d(t,{VideoPlaylistsProvider:()=>_});var o=i(331635),s=i(327813),r=i(132028),a=i(468073),n=i(768035),d=i(882044),l=i(859139),c=i(628579),u=i(639370),h=i(694049),p=i(800227);class _{set(e){const t=new u.VideoPlaylist(e,this.videoApi,this.ownerProvider,this.subscribeService);this.playlistMap.set(t.rawId,t)}createVideoPlaylistFromApi(e){const t=new u.VideoPlaylist(e,this.videoApi,this.ownerProvider,this.subscribeService);return this.playlistMap.set(t.rawId,t),t}createVideoPlaylistsFromApi(e){return e.reduce(((e,t)=>{const i=this.createVideoPlaylistFromApi(t);return e.push(i),e}),[])}getPlaylist(e){return this.playlistMap.get(e)}async fetch(e,t){const i={count:e.count,offset:e.offset,need_system:(0,p.convertToBooleanParam)(e.needSystem),group_id:e.groupId,owner_id:e.ownerId,extended:(0,p.convertToBooleanParam)(!0)},o=Object.fromEntries(Object.entries(i).filter((([,e])=>void 0!==e))),{count:s,items:r}=await this.videoApi.getAlbums(o,t);return{count:s,items:this.createVideoPlaylistsFromApi(r)}}addVideoToPlaylist(e,t){return this.videoApi.addToAlbum(e,t)}async fetchById(e,t){const i=await this.videoApi.getAlbumById(_.prepareFetchByIdParams(e),t),[o]=this.createVideoPlaylistsFromApi([i]);return o}async create(e,t){const{ownerId:i,title:o,privacy:s,photoId:r,photoHash:n,verticalPhotoHash:d,verticalPhotoTag:c}=e,u={title:o};return void 0!==r&&(u.photo_id=r,u.photo_hash=n),void 0!==c&&(u.vertical_photo_tag=c,u.vertical_photo_hash=d),s&&(u.privacy=(0,l.stringifyBasePrivacy)(s)),a.Ranges.isGroupId(i)&&(u.group_id=a.Ranges.convertOwnerIdToGroupId(i)),this.videoApi.addAlbum(u,t)}async delete({id:e,ownerId:t},i){const o={album_id:e};a.Ranges.isGroupId(t)?o.group_id=t:o.owner_id=t;const s=Boolean(await this.videoApi.deleteAlbum(o,i));return s&&this.playlistMap.delete(u.VideoPlaylist.createRawId({id:e,ownerId:t})),s}static prepareFetchByIdParams(e){if("number"==typeof e)return{album_id:e};const{accessKey:t,id:i,ownerId:o}="string"==typeof e?(0,n.parseRawId)(e):e,s={album_id:i};return void 0!==o&&(s.owner_id=o),void 0!==t&&(s.access_key=t),s}constructor(e,t,i){this.videoApi=e,this.ownerProvider=t,this.subscribeService=i,this.playlistMap=new Map,(0,s.makeAutoObservable)(this)}}_=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===d.VideoApi?Object:d.VideoApi,void 0===c.VideoOwnerProvider?Object:c.VideoOwnerProvider,void 0===h.VideoPlaylistSubscribeService?Object:h.VideoPlaylistSubscribeService])],_)},639370:(e,t,i)=>{i.d(t,{VideoPlaylist:()=>n});var o=i(327813),s=i(873900),r=i(468073),a=i(859139);class n{static createRawId(e){return(0,s.getIdentityRawId)(e)}get rawId(){const{id:e,owner_id:t}=this.data;return n.createRawId({id:e,ownerId:t})}get data(){return this._data}get owner(){return this.ownerProvider?.getOwner(this._data.owner_id)}get isSubscribed(){return this.subscribeService?.getIsSubscribed(this.rawId)??this._data.is_subscribed}get isEditing(){return this._isEditing}async edit(e,t){if(this._isEditing)throw new Error("VideoPlaylist is already editing");this._isEditing=!0;const{ownerId:i,itemId:s,title:n,privacy:d,photoId:l,photoHash:c,verticalPhotoTag:u,verticalPhotoHash:h}=e,p={album_id:s,title:n};r.Ranges.isGroupId(i)&&(p.group_id=r.Ranges.convertOwnerIdToGroupId(i)),void 0!==l&&(p.photo_id=l,p.photo_hash=c),void 0!==u&&(p.vertical_photo_tag=u,p.vertical_photo_hash=h),d&&(p.privacy=(0,a.stringifyBasePrivacy)(d));try{await this.videoApi.editAlbum(p,t),(0,o.runInAction)((()=>{this._data.title=e.title,this._data.privacy=e.privacy}))}finally{(0,o.runInAction)((()=>{this._isEditing=!1}))}}constructor(e,t,i,s){this._data=e,this.videoApi=t,this.ownerProvider=i,this.subscribeService=s,this._isEditing=!1,this.subscribeService?.setIsSubscribed(this.rawId,e.is_subscribed),(0,o.makeAutoObservable)(this,{},{autoBind:!0})}}},915177:(e,t,i)=>{i.d(t,{VideoPlaylistsList:()=>s});var o=i(327813);class s{get count(){return this._count}get isLoading(){return this._isLoading}get isLoadedFully(){return this._isLoadedFully}get isLoaded(){return Boolean(this.prevRequestParams)}getPlaylistById(e){return this.ids.includes(e)&&this.videoPlaylistsProvider.getPlaylist(e)||null}get playlists(){return this.ids.reduce(((e,t)=>{const i=this.videoPlaylistsProvider.getPlaylist(t);return i&&e.push(i),e}),[])}get notEmptyPlaylists(){return this.ids.reduce(((e,t)=>{const i=this.videoPlaylistsProvider.getPlaylist(t);return i&&i.data.count>0&&e.push(i),e}),[])}dispose(){this.controller?.abort()}done(e,t){const{count:i=0,offset:o=0}=e,s=t.items.map((({rawId:e})=>e));return this._isLoadedFully=t.count<=o+i,this._count=t.count,this.ids=o?[...this.ids,...s]:s,this._isLoading=!1,this.controller=null,this.prevRequestParams=e,s}async fetch(e,t=new AbortController){this.reset(),this.controller=t,this._isLoading=!0;const i=await this.request(e,t);return this.done(e,i)}async fetchMore(e=new AbortController){if(!this.prevRequestParams||this._isLoading||this._isLoadedFully)return;this.controller=e,this._isLoading=!0;const{count:t=0,offset:i=0}=this.prevRequestParams??{},o=i+t,s={...this.prevRequestParams,offset:o},r=await this.request(s,e);return this.done(s,r)}request(e,t){return this.videoPlaylistsProvider.fetch(e,{signal:t.signal})}reset(){this.controller?.abort(),this.resetData()}resetData(){this._count=0,this._isLoading=!1,this._isLoadedFully=!1,this.ids=[],this.prevRequestParams=null,this.controller=null}constructor(e){this.videoPlaylistsProvider=e,this.ids=[],this.prevRequestParams=null,this.controller=null,this._count=0,this._isLoading=!1,this._isLoadedFully=!1,(0,o.makeAutoObservable)(this)}}},446367:(e,t,i)=>{i.d(t,{VideoPlaylistBaseField:()=>s});var o=i(327813);class s{isLoading(e){return Boolean(this._loadings.get(e))}setValue(e,t){this._data.set(e,t)}getValue(e){return this._data.get(e)}async edit(e,t){if(this._loadings.get(e))return this._loadings.get(e);try{this._loadings.set(e,t()),await this._loadings.get(e)}catch(e){this.errorBoundary(e)}finally{(0,o.runInAction)((()=>{this._loadings.set(e,null)}))}}constructor(e=(e=>console.error(e))){this._data=new Map,this._loadings=new Map,this.errorBoundary=e,(0,o.makeAutoObservable)(this)}}},485484:(e,t,i)=>{i.d(t,{VideoBookmarksService:()=>d});var o=i(331635),s=i(132028),r=i(972573),a=i(327813),n=i(538522);class d{async add({videoId:e,ownerId:t,ref:i,source:o},s){const r=(0,n.joinRawId)({itemId:e,ownerId:t});if(this.isBookmarkDeleting(r))return!1;const a={owner_id:t,id:e,ref:i,source:o};this.videoBookmarkAddingMap.set(r,!0);try{const e=await this.faveApi.addVideo(a,s);return this.videoBookmarkAddedMap.set(r,!0),e}finally{this.videoBookmarkAddingMap.set(r,!1)}}async remove({videoId:e,ownerId:t,ref:i,source:o},s){const r=(0,n.joinRawId)({itemId:e,ownerId:t});if(this.isBookmarkAdding(r))return!1;const a={owner_id:t,id:e,ref:i,source:o};this.videoBookmarkDeletingMap.set(r,!0);try{const e=await this.faveApi.removeVideo(a,s);return this.videoBookmarkAddedMap.set(r,!1),e}finally{this.videoBookmarkDeletingMap.set(r,!1)}}isBookmarkAdded(e){return this.videoBookmarkAddedMap.get(e)}isBookmarkAdding(e){return this.videoBookmarkAddingMap.get(e)}isBookmarkDeleting(e){return this.videoBookmarkDeletingMap.get(e)}constructor(e){this.faveApi=e,this.videoBookmarkAddedMap=new Map,this.videoBookmarkAddingMap=new Map,this.videoBookmarkDeletingMap=new Map,(0,a.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.FaveApi?Object:r.FaveApi])],d)},969617:(e,t,i)=>{i.d(t,{VideoFaveService:()=>d});var o=i(331635),s=i(132028),r=i(972573),a=i(327813),n=i(821969);class d{toggle(e,t){const i=this.getIsFavorite(e.id);void 0!==i&&(i?this.remove(e,t):this.add(e,t))}add(e,t){return this.baseFieldService.edit(e.id,(async()=>{const i={owner_id:e.ownerId,id:e.id,source:e.source,ref:e.ref};await this.faveApi.addVideo(i,t),this.setIsFavorite(e.id,!0)}))}remove(e,t){return this.baseFieldService.edit(e.id,(async()=>{const i={owner_id:e.ownerId,id:e.id,source:e.source,ref:e.ref};await this.faveApi.removeVideo(i,t),this.setIsFavorite(e.id,!1)}))}setIsFavorite(e,t){if(void 0!==t)return this.baseFieldService.setValue(e,t)}getIsFavorite(e){return this.baseFieldService.getValue(e)}constructor(e){this.faveApi=e,this.baseFieldService=new n.VideoBaseField,(0,a.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.global(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.FaveApi?Object:r.FaveApi])],d)},712023:(e,t,i)=>{i.d(t,{VideoGroupsFetchProvider:()=>l});var o=i(331635),s=i(327813),r=i(132028),a=i(962005),n=i(800227),d=i(476205);class l{static isNumberArray(e){const[t]=e;return"number"==typeof t}async fetch(e,t){const i=this.getPending(e);if(i)return i;const o=this.groupsApi.get(l.getApiParams(e),t),r=l.getKey(e);this.pendingMap.set(r,o);try{const t=await o,{items:i}=t;return l.isNumberArray(i)||this.groupsStoreFactory.ensureByFields(e.fields??[]).createFromApi(i),t}finally{(0,s.runInAction)((()=>{this.pendingMap.delete(r)}))}}isPending(e){return Boolean(this.getPending(e))}static getApiParams(e){const t={count:e.count,extended:(0,n.convertToBooleanParam)(e.extended),fields:e.fields?.join(","),filter:e.filter?.join(","),last_request_time:e.lastRequestTime,offset:e.offset,user_id:e.userId};return Object.fromEntries(Object.entries(t).filter((([,e])=>void 0!==e)))}static getKey(e){return JSON.stringify(Object.entries(l.getApiParams(e)).sort((([e],[t])=>e<t?-1:1)))}getPending(e){return this.pendingMap.get(l.getKey(e))}constructor(e,t){this.groupsApi=e,this.groupsStoreFactory=t,this.pendingMap=new Map,(0,s.makeAutoObservable)(this)}}l=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.GroupsApi?Object:a.GroupsApi,void 0===d.VideoGroupsStoreFactory?Object:d.VideoGroupsStoreFactory])],l)},169689:(e,t,i)=>{i.d(t,{VideoGroupsProvider:()=>n});var o=i(331635),s=i(327813),r=i(132028),a=i(73573);class n{getGroup(e){return this.groupsMap.get(e)}createGroupsFromApi(e){return e.map((e=>{const t=new a.VideoGroup(e);return this.groupsMap.set(e.id,t),t}))}constructor(){this.groupsMap=new Map,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[])],n)},104403:(e,t,i)=>{i.d(t,{VideoGroupsStore:()=>r});var o=i(327813),s=i(73573);class r{createFromApi(e){const t=e=>{const t=new s.VideoGroup(e);return this.groupsMap.set(e.id,t),t};return Array.isArray(e)?e.map(t):t(e)}getById(e){return this.groupsMap.get(e)}constructor(){this.groupsMap=new Map,(0,o.makeAutoObservable)(this)}}},476205:(e,t,i)=>{i.d(t,{VideoGroupsStoreFactory:()=>d});var o=i(331635),s=i(327813),r=i(132028),a=i(740370),n=i(104403);class d{static filterFields(e){const t=a.VIDEO_GROUP_OPTIONAL_FIELDS;return e.filter((e=>t.includes(e)))}ensureByFields(e){const t=d.getKey(e);return this.stores.get(t)??this.create(t)}create(e){const t=new n.VideoGroupsStore;return this.stores.set(e,t),t}static getKey(e){return[...new Set(e)].sort().join(",")}constructor(){this.stores=new Map,(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[])],d)},740370:(e,t,i)=>{i.d(t,{VIDEO_GROUP_OPTIONAL_FIELDS:()=>o});const o=["activity","addresses","age_limits","ban_info","can_create_topic","can_message","can_post","can_suggest","can_see_all_posts","can_upload_doc","can_upload_story","can_upload_video","city","contacts","counters","country","cover","crop_photo","description","fixed_post","has_photo","is_favorite","is_hidden_from_feed","is_messages_blocked","links","main_album_id","main_section","market","member_status","members_count","place","public_date_label","site","start_date и finish_date","status","trending","verified","wall","wiki_page"]},129021:(e,t,i)=>{i.d(t,{VideoLikesService:()=>n});var o=i(331635),s=i(132028),r=i(591301),a=i(327813);class n{async add(e,t){const i={type:e.type,owner_id:e.ownerId,item_id:e.itemId};return await this.likesApi.add(i,t)}async remove(e,t){const i={type:e.type,owner_id:e.ownerId,item_id:e.itemId};return await this.likesApi.delete(i,t)}constructor(e){this.likesApi=e,(0,a.makeAutoObservable)(this)}}n=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.LikesApi?Object:r.LikesApi])],n)},165268:(e,t,i)=>{i.d(t,{VideoMovieInfoDropdownDataProvider:()=>d,VideoMovieInfoDropdownDataTypeParams:()=>n});var o=i(331635),s=i(132028),r=i(882044),a=i(327813);const n={ACTOR:1,DIRECTOR:2,COUNTRY:3,GENRE:4,CUSTOM:5};class d{async fetch(e,t){const i=this.getMapKey(e),o=this._pendingMap.get(i);if(o){const{items:e}=await o;return e}const s=this.videoApi.getMovieInfoDropdownData(e,t);try{this._pendingMap.set(i,s);const{items:e}=await s;return e}finally{this._pendingMap.delete(i)}}getMapKey({type:e,search:t}){return[e,t].join()}constructor(e){this.videoApi=e,this._pendingMap=new Map,(0,a.makeAutoObservable)(this)}}d=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.VideoApi?Object:r.VideoApi])],d)},406341:(e,t,i)=>{i.d(t,{VideoMovieInfoProvider:()=>l});var o=i(331635),s=i(132028),r=i(882044),a=i(327813),n=i(376150),d=i(839526);class l{async fetch({ownerId:e,playlistId:t},i){const o=this.getMapKey({ownerId:e,playlistId:t}),s=this._pendingMap.get(o);if(s)return this.createFromApi(await s);const r=this.videoApi.getMovieInfo({owner_id:e,playlist_id:t},i);try{return this._pendingMap.set(o,r),this.createFromApi(await r)}finally{this._pendingMap.delete(o)}}async update({ownerId:e,playlistId:t,infoUpdatedAt:i,ratingAge:o,year:s,ratingKinopoisk:r,kinopoiskId:a,categoryIds:n,actorIds:l,directorIds:c,countryIds:u,genreIds:h,customTagIds:p}){const _={owner_id:e,playlist_id:t,info_updated_at:i||Date.now(),rating_age:o,year:s,rating_kinopoisk:r,kinopoisk_id:a,category_ids:(0,d.getJoinedStringOrUndefined)(n),actor_ids:(0,d.getJoinedStringOrUndefined)(l),director_ids:(0,d.getJoinedStringOrUndefined)(c),country_ids:(0,d.getJoinedStringOrUndefined)(u),genre_ids:(0,d.getJoinedStringOrUndefined)(h),custom_tag_ids:(0,d.getJoinedStringOrUndefined)(p)},v=Object.fromEntries(Object.entries(_).filter((([,e])=>void 0!==e)));return Boolean(await this.videoApi.updateMovieInfo(v))}createFromApi(e){return new n.VideoMovieInfo(e)}getMapKey({ownerId:e,playlistId:t}){return[e,t].join()}constructor(e){this.videoApi=e,this._pendingMap=new Map,(0,a.makeAutoObservable)(this)}}l=(0,o.__decorate)([s.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.VideoApi?Object:r.VideoApi])],l)},376150:(e,t,i)=>{i.d(t,{VideoMovieInfo:()=>s});var o=i(327813);class s{get values(){return{infoUpdatedAt:this.data.info_updated_at,kinopoiskId:this.data.kinopoisk_id,year:this.data.year,ratingKinopoisk:this.data.rating_kinopoisk,ratingAge:this.data.rating_age,categoryIds:this.data.category_ids,countryIds:this.data.country_ids,genreIds:this.data.genre_ids,customTagIds:this.data.custom_tag_ids,actors:this.data.selected_actors,directors:this.data.selected_directors}}get options(){return{categories:this.data.all_categories,countries:this.data.all_countries,genres:this.data.all_genres,customTags:this.data.all_custom_tags,ratingAges:this.data.all_rating_ages}}constructor(e){this.data=e,(0,o.makeAutoObservable)(this)}}},839526:(e,t,i)=>{i.d(t,{getJoinedStringOrUndefined:()=>o});const o=e=>{if(e&&e?.length)return e.join()}},628579:(e,t,i)=>{i.d(t,{VideoOwnerProvider:()=>u});var o=i(331635),s=i(327813),r=i(468073),a=i(132028),n=i(73573),d=i(169689),l=i(805373),c=i(878585);class u{static isVideoGroup(e){return e instanceof n.VideoGroup}static isVideoUser(e){return e instanceof l.VideoUser}createGroupsFromApi(e){return this.groupsProvider.createGroupsFromApi(e)}createUsersFromApi(e){return this.usersProvider.createUsersFromApi(e)}getOwner(e){return r.Ranges.isGroupId(e)?this.groupsProvider.getGroup(r.Ranges.convertOwnerIdToGroupId(e)):r.Ranges.isUserId(e)?this.usersProvider.getUser(e):void 0}constructor(e,t){this.groupsProvider=e,this.usersProvider=t,(0,s.makeAutoObservable)(this)}}u=(0,o.__decorate)([a.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===d.VideoGroupsProvider?Object:d.VideoGroupsProvider,void 0===c.VideoUsersProvider?Object:c.VideoUsersProvider])],u)},67552:(e,t,i)=>{i.d(t,{VideoSubscriptionsCatalogProvider:()=>h});var o=i(331635),s=i(327813),r=i(132028),a=i(52016),n=i(863297),d=i(664700),l=i(31287),c=i(152685),u=i(903723);class h{async fetchSection(e,t){const i=await this.catalogApi.getSection(e,t);if(!i.section)return null;const o=this.createEntities(),{section:s,...r}=i,a={default_section:s.id,sections:[s]};return new n.Catalog({data:a,catalogApi:this.catalogApi,entitiesSource:r,entities:o})}async fetchSectionId(e){const t=await this.catalogApi.getVideo(e);if(!t?.catalog?.default_section)throw new Error("No section ID");return t.catalog.default_section}constructor(e,t){this.catalogApi=e,this.groupsProvider=t,this.createEntities=()=>new d.CatalogEntities({groups:(0,l.createCatalogGroupsProvider)(this.groupsProvider),placeholders:(0,c.createCatalogPlaceholdersProvider)()}),(0,s.makeAutoObservable)(this)}}h=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.CatalogApi?Object:a.CatalogApi,void 0===u.GroupsProvider?Object:u.GroupsProvider])],h)},298593:(e,t,i)=>{i.d(t,{VideoSubscriptionsService:()=>n});var o=i(331635),s=i(327813),r=i(132028),a=i(882044);class n{async subscribeChooseRelevantAuthors(e){return Boolean(await this.videoApi.subscribeChooseRelevantAuthors(e))}async subscribeGetRelevantAuthors(e){return await this.videoApi.subscribeGetRelevantAuthors(e)}constructor(e){this.videoApi=e,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.VideoApi?Object:a.VideoApi])],n)},878585:(e,t,i)=>{i.d(t,{VideoUsersProvider:()=>d});var o=i(331635),s=i(327813),r=i(132028),a=i(488709),n=i(805373);class d{getUser(e){return this.usersMap.get(e)}createUsersFromApi(e){return e.map((e=>{const t=new n.VideoUser(e);return this.usersMap.set(e.id,t),t}))}async fetchUserById(e,t){const i=await this.userApi.get({user_ids:e.toString(),fields:t.join()});if(i.length)return new n.VideoUser(i[0])}constructor(e){this.userApi=e,this.usersMap=new Map,(0,s.makeAutoObservable)(this)}}d=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.UsersApi?Object:a.UsersApi])],d)},821969:(e,t,i)=>{i.d(t,{VideoBaseField:()=>s});var o=i(327813);class s{getIsLoading(e){return!!this.loadings.get(e)}setValue(e,t){this.data.set(e,t)}getValue(e){return this.data.get(e)}async edit(e,t){if(this.loadings.get(e))return this.loadings.get(e);try{this.loadings.set(e,t()),await this.loadings.get(e)}catch(e){this.errorBoundary(e)}finally{(0,o.runInAction)((()=>{this.loadings.set(e,null)}))}}constructor(e=(e=>console.error(e))){this.data=new Map,this.loadings=new Map,this.errorBoundary=e,(0,o.makeAutoObservable)(this)}}},800227:(e,t,i)=>{i.d(t,{convertToBooleanParam:()=>o});const o=e=>{if(void 0!==e)return e?1:0}},751932:(e,t,i)=>{i.d(t,{VideoVideosDeletingProvider:()=>l});var o=i(331635),s=i(327813),r=i(132028),a=i(882044),n=i(361121),d=i(538522);class l{async delete(e,{targetId:t,controller:i}={}){const o=(0,n.splitRawId)(e);if(this.isRestoring(e))return!1;const s={video_id:o.itemId,owner_id:o.ownerId,target_id:t};this.videoDeletingMap.set(e,!0);try{const t=await this.videoApi.delete(s,{signal:i?.signal});return t&&this.videoDeletedMap.set(e,!0),Boolean(t)}finally{this.videoDeletingMap.set(e,!1)}}async restore({videoId:e,ownerId:t},i){const o=(0,d.joinRawId)({itemId:e,ownerId:t});if(this.isDeleting(o))return!1;this.videoRestoringMap.set(o,!0);try{const s=await this.videoApi.restore({video_id:e,owner_id:t},i);return this.videoDeletedMap.set(o,!1),s}finally{this.videoRestoringMap.set(o,!1)}}isDeleted(e){return this.videoDeletedMap.get(e)}isDeleting(e){return this.videoDeletingMap.get(e)}isRestoring(e){return this.videoDeletingMap.get(e)}constructor(e){this.videoApi=e,this.videoDeletedMap=new Map,this.videoDeletingMap=new Map,this.videoRestoringMap=new Map,(0,s.makeAutoObservable)(this)}}l=(0,o.__decorate)([r.scope.container(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===a.VideoApi?Object:a.VideoApi])],l)},52016:(e,t,i)=>{i.d(t,{CatalogApi:()=>a});var o=i(331635),s=i(641569),r=i(132028);class a extends s.ApiNamespace{get namespace(){return"catalog"}constructor(...e){super(...e),this.getAudio=this.makeMethod("getAudio"),this.getGroups=this.makeMethod("getGroups",!0),this.getSearchGroups=this.makeMethod("getSearchGroups"),this.getVideo=this.makeMethod("getVideo"),this.getSection=this.makeMethod("getSection"),this.getGroupsCollection=this.makeMethod("getGroupsCollection"),this.getBlockItems=this.makeMethod("getBlockItems"),this.getClassifieds=this.makeMethod("getClassifieds"),this.getAudioClips=this.makeMethod("getAudioClips"),this.getAudioClipsSearch=this.makeMethod("getAudioClipsSearch"),this.replaceBlocks=this.makeMethod("replaceBlocks"),this.getShortVideoSearch=this.makeMethod("getShortVideoSearch"),this.getVideoShowcase=this.makeMethod("getVideoShowcase"),this.getVideoSearchSubscriptions=this.makeMethod("getVideoSearchSubscriptions"),this.getVideoSearchWeb2=this.makeMethod("getVideoSearchWeb2"),this.getVideoSearch=this.makeMethod("getVideoSearch"),this.getSearchGames=this.makeMethod("getSearchGames"),this.getSearchMarket=this.makeMethod("getSearchMarket"),this.getPeopleSearch=this.makeMethod("getPeopleSearch"),this.getOwnerVideosSearch=this.makeMethod("getOwnerVideosSearch"),this.getSearchMiniApps=this.makeMethod("getSearchMiniApps"),this.hideBlock=this.makeMethod("hideBlock")}}a=(0,o.__decorate)([r.scope.global()],a)},995340:(e,t,i)=>{i.d(t,{StatsApi:()=>a});var o=i(331635),s=i(132028),r=i(641569);class a extends r.ApiNamespace{get namespace(){return"stats"}constructor(...e){super(...e),this.trackEvents=this.makeMethod("trackEvents")}}a=(0,o.__decorate)([s.scope.global()],a)},308011:(e,t,i)=>{i.d(t,{isNotEmptyQuery:()=>o});const o=".*[^ ].*"},265567:(e,t,i)=>{i.d(t,{CatalogSearchWidget:()=>p});var o=i(474848),s=i(456921),r=i(296540),a=i(132028),n=i(194528),d=i(172656),l=i(4485),c=i(963272),u=i(173509);const h=(0,s.observer)((function(){const e=(0,c.useCatalogModel)(),{blocks:t}=e,{section:i,blockLayoutResolver:s,island:a,spacing:h}=e.props.current;if(!i||!t.length)return null;const p=e=>e.map(((t,i)=>{const r=e[i+1],a=s(t);return h&&(0,u.isSeparatorBlock)(t.data)&&r&&!(0,u.isHeaderBlock)(r.data)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a,{index:i,block:t},t.id),(0,o.jsx)(n.Spacing,{size:h})]}):(0,o.jsx)(a,{index:i,block:t},t.id)}));return a?(0,o.jsx)(r.Fragment,{children:e.islandBlocks.map(((e,t,i)=>(0,o.jsxs)(d.Group,{mode:"card",children:[p(e),i.length-1===t&&(0,o.jsx)(l.NextFrom,{})]},e[0].id)))}):(0,o.jsxs)(r.Fragment,{children:[p(t),(0,o.jsx)(l.NextFrom,{})]})})),p=(0,a.createWidget)(c.CatalogModelProvider,h)},455376:(e,t,i)=>{i.d(t,{NextFrom:()=>l});var o=i(474848),s=i(456921),r=i(296540),a=i(140094),n=i(753457),d=i(963272);const l=(0,s.observer)((()=>{const[e,t]=(0,a.useInView)(),i=(0,d.useCatalogModel)(),{section:s}=i.props.current;return(0,r.useEffect)((()=>{if(!t||s?.isNextLoading||!s?.nextFrom)return;const e=setTimeout((()=>{s.fetchNext()}),200);return()=>clearTimeout(e)}),[t,s?.isNextLoading]),s?.nextFrom&&(0,o.jsx)(n.PanelSpinner,{getRootRef:e,height:42,size:"small"})}))},4485:(e,t,i)=>{i.d(t,{NextFrom:()=>o.NextFrom});var o=i(455376)},298405:(e,t,i)=>{i.d(t,{getOwner:()=>s});var o=i(468073);const s=(e,t)=>o.Ranges.isUserId(e)?t.profiles.get(e):t.groups.get(o.Ranges.convertOwnerIdToGroupId(e))},584376:(e,t,i)=>{i.d(t,{getOwner:()=>o.getOwner});var o=i(298405)},157996:(e,t,i)=>{i.d(t,{withCatalogAction:()=>o.withCatalogAction,withCatalogBlock:()=>s.withCatalogBlock,withCatalogStore:()=>r.withCatalogStore});var o=i(250195),s=i(683802),r=i(831518)},250195:(e,t,i)=>{i.d(t,{withCatalogAction:()=>a});var o=i(474848),s=i(456921),r=i(140094);function a(e,t={},i){const{onActionView:a}=t,n=t=>{const s=t.action,n=s.data.track_code,{ref:d}=(0,r.useInView)({threshold:.8,skip:!a||!n,onChange:e=>n&&a&&e&&a(s,n)});return(0,o.jsx)(e,{...t,...i,getRootRef:d,trackCode:n})};return n.displayName=`${e.displayName}_withCatalogAction`,(0,s.observer)(n)}},683802:(e,t,i)=>{i.d(t,{withCatalogBlock:()=>d});var o=i(474848),s=i(456921),r=i(327813),a=i(296540),n=i(173509);function d(e,t,i){const d=({index:s,block:d})=>{const[l,c]=(0,a.useState)([]),u=i(d);return(0,a.useEffect)((()=>(0,r.autorun)((()=>c((0,n.extractItemsIds)(d.data))))),[]),l.length&&u?(0,o.jsx)(e,{...t,index:s,block:d,items:l,ItemComponent:u}):null};return d.displayName=`${e.displayName}_withCatalogBlock`,(0,s.observer)(d)}},831518:(e,t,i)=>{i.d(t,{withCatalogStore:()=>l});var o=i(474848),s=i(456921),r=i(296540),a=i(22421),n=i(140094),d=i(963272);function l(e,t,i={},l){const{attachTrackCodeToUrl:c,getUrl:u,getTrackCode:h,onItemView:p}=i,_=i=>{const s=(0,d.useCatalogModel)(),_=(0,r.useMemo)((()=>t(s.providers,i,i.block)),[i]),v=_&&h?h(_,i):i.track_code,{ref:g}=(0,n.useInView)({threshold:.8,skip:!_||!p||!v,onChange:e=>_&&v&&p&&e&&p(_,v)});if(!_)return null;const m=u?.(_,i);return(0,o.jsx)(e,{...i,...l,item:_,getRootRef:g,index:i.index,block:i.block,trackCode:v,href:m&&(c&&v?(0,a.makeUrl)(m,{search_track_code:v}):m)})};return _.displayName=`${e.displayName}_withCatalogStore`,(0,s.observer)(_)}},839614:(e,t,i)=>{i.d(t,{CatalogSearchWidget:()=>o.CatalogSearchWidget,getOwner:()=>r.getOwner,withCatalogAction:()=>s.withCatalogAction,withCatalogBlock:()=>s.withCatalogBlock,withCatalogStore:()=>s.withCatalogStore});var o=i(265567),s=i(157996),r=i(584376)},354906:(e,t,i)=>{i.d(t,{CatalogModelProvider:()=>d,useCatalogModel:()=>l});var o=i(331635),s=i(327813),r=i(132028),a=i(173509);class n{get providers(){const{section:e}=this.props.current;return e?.providers}get blocks(){const{section:e,canRemoveBlock:t}=this.props.current;return t?this.notEmptyBlocks:e?.blocks||[]}get notEmptyBlocks(){const{section:e}=this.props.current,t=e?.blocks;if(!t)return[];const i=t.findIndex((e=>{const t=(0,a.tryExtractItemsIds)(e.data);return Boolean(t&&!t.length)}));return t.filter(((e,t)=>t===i-1?!(0,a.isHeaderBlock)(e.data):t===i+1?!(0,a.isSeparatorBlock)(e.data):t!==i))}get islandBlocks(){return(0,a.splitBlocksBySeparator)(this.blocks)}constructor(e){this.props=e,(0,s.makeAutoObservable)(this)}}n=(0,o.__decorate)([r.scope.transient(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[void 0===r.Props?Object:r.Props])],n);const{Provider:d,useModel:l}=(0,r.createProvider)(n)},173509:(e,t,i)=>{i.d(t,{extractItemsIds:()=>d,isHeaderBlock:()=>o,isSeparatorBlock:()=>s,splitBlocksBySeparator:()=>r,tryExtractItemsIds:()=>n});const o=e=>["header","header_large","header_compact","header_extended"].includes(e.layout.name),s=e=>"separator"===e.layout.name||"separator_compact"===e.layout.name,r=(e,t=[])=>{const i=e.findIndex((e=>"separator"===e.data.layout.name));return-1===i?[...t,e]:r(e.slice(i+1),[...t,e.slice(0,i)])},a=e=>e?.map((e=>({id:e}))),n=e=>{switch(e.data_type){case"groups":return a(e.group_ids);case"groups_invites":return a(e.group_invites);case"groups_items":case"groups_events":return e.group_items;case"catalog_users":return a(e.catalog_users_ids);case"mini_apps":return a(e.mini_app_ids);case"links":return a(e.links_ids);case"videos":return a(e.videos_ids);case"albums":return a(e.albums_ids);case"catalog_search_suggestion":return a(e.search_suggestions_ids);case"search_authors":return e.search_author_items;case"search_filter":return a(e.search_filters_ids);case"search_suggestions":return a(e.suggestions_ids);case"newsfeed_items":return a(e.newsfeed_item_ids);case"music_audios":return a(e.audios_ids);case"music_playlists":return a(e.playlists_ids);case"games":return e.games_items;case"market_items":return a(e.market_item_ids);case"stickers_packs":return a(e.stickers_pack_ids);case"mini_apps_content":return e.miniapps_content_items?.map((e=>({...e,id:e.id??""})));case"search_entity_items":return a(e.search_entity_ids);case"navigation_tabs":return a(e.navigation_tab_ids);case"placeholder":return a(e.placeholder_ids);case"radiostations":return a(e.radio_stations_ids);case"search_spellchecker":return a(e.search_spellcheckers_ids)}},d=e=>n(e)??[]},963272:(e,t,i)=>{i.d(t,{CatalogModelProvider:()=>o.CatalogModelProvider,useCatalogModel:()=>o.useCatalogModel});var o=i(354906)},157307:(e,t,i)=>{i.d(t,{Icon12ListPlayOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon12ListPlayOutline","list_play_outline_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="list_play_outline_12"><path d="M1.75 2a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5zm9.02 5.3L7.967 5.13A.6.6 0 0 0 7 5.603v4.29a.6.6 0 0 0 .962.479l2.803-2.12a.6.6 0 0 0 .005-.953ZM1 8.75A.75.75 0 0 1 1.75 8h3a.75.75 0 0 1 0 1.5h-3A.75.75 0 0 1 1 8.75M1.75 5a.75.75 0 0 0 0 1.5h3a.75.75 0 0 0 0-1.5z" /></symbol>',12,12,!1,void 0)},725772:(e,t,i)=>{i.d(t,{Icon12Lock:()=>o});var o=(0,i(844990).makeIcon)("Icon12Lock","lock_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="lock_12"><path d="M6 .5c1.657 0 3 1.337 3 2.992v1.507L9.748 5c.415 0 .752.34.752.76v4.48a.76.76 0 0 1-.752.76H2.252a.756.756 0 0 1-.752-.76V5.76c0-.42.342-.76.752-.76L3 4.999V3.501A3.003 3.003 0 0 1 5.824.505zM6 2l-.145.007A1.496 1.496 0 0 0 4.5 3.5V5h3V3.5C7.5 2.666 6.828 2 6 2" /></symbol>',12,12,!1,void 0)},760793:(e,t,i)=>{i.d(t,{Icon12Mask:()=>o});var o=(0,i(844990).makeIcon)("Icon12Mask","mask_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 12" id="mask_12"><path fill="currentColor" fill-rule="evenodd" d="M6 11.25c-1.805 0-3.513-1.376-4.419-3.581-.998-2.43-1.095-5.756-.304-6.581.396-.414.558-.426 2.276-.155.943.148 1.63.219 2.447.219s1.504-.07 2.447-.22c1.718-.27 1.88-.258 2.276.156.79.825.694 4.15-.304 6.58C9.513 9.875 7.805 11.25 6 11.25m0-2.187c-1.82 0-2.548-1.658-2.184-2.072.173-.198.347-.112.639.03.32.158.783.384 1.545.384s1.224-.226 1.545-.383c.292-.144.465-.229.639-.031.364.414-.364 2.072-2.184 2.072M4.076 5.38c.724.064 1.349-.331 1.396-.883s-.5-1.052-1.224-1.116c-.723-.065-1.348.33-1.395.883s.5 1.051 1.223 1.116m2.452-.883c.047.552.671.947 1.393.883.722-.065 1.27-.564 1.222-1.116-.047-.552-.671-.948-1.393-.883s-1.27.564-1.222 1.116" clip-rule="evenodd" /></symbol>',12,12,!1,void 0)},487376:(e,t,i)=>{i.d(t,{Icon12Place:()=>o});var o=(0,i(844990).makeIcon)("Icon12Place","place_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 12 12" id="place_12"><path fill="currentColor" fill-rule="evenodd" d="M10 5.053C10 2.855 8.212 1 6 1S2 2.855 2 5.053c0 1.54.983 3.335 2.899 5.456a1.48 1.48 0 0 0 2.11.094 2 2 0 0 0 .092-.094C9.018 8.389 10 6.592 10 5.052M6 3.5a1.5 1.5 0 1 0 .001 3.001A1.5 1.5 0 0 0 6 3.5" clip-rule="evenodd" /></symbol>',12,12,!1,void 0)},562791:(e,t,i)=>{i.d(t,{Icon16LockOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon16LockOutline","lock_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="lock_outline_16"><path fill="currentColor" fill-rule="evenodd" d="M2 10c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.093c.297-.15.645-.218 1.135-.248V4.5a3.5 3.5 0 1 1 7 0v1.524c.49.03.838.097 1.135.249a2.5 2.5 0 0 1 1.093 1.092C14 7.9 14 8.6 14 10v1c0 1.4 0 2.1-.272 2.635a2.5 2.5 0 0 1-1.093 1.093C12.1 15 11.4 15 10 15H6c-1.4 0-2.1 0-2.635-.272a2.5 2.5 0 0 1-1.092-1.093C2 13.1 2 12.4 2 11zm8-2.5H6c-.725 0-1.178.001-1.52.029-.324.027-.413.07-.434.08a1 1 0 0 0-.437.437c-.01.02-.053.11-.08.434-.028.342-.029.795-.029 1.52v1c0 .725.001 1.178.029 1.52.027.324.07.413.08.434a1 1 0 0 0 .437.437c.02.01.11.053.434.08.342.028.795.029 1.52.029h4c.725 0 1.178-.001 1.52-.03.324-.026.413-.069.434-.079a1 1 0 0 0 .437-.437c.01-.02.053-.11.08-.434.028-.342.029-.795.029-1.52v-1c0-.725-.001-1.178-.03-1.52-.026-.324-.069-.413-.079-.434a1 1 0 0 0-.437-.437c-.02-.01-.11-.053-.434-.08-.342-.028-.795-.029-1.52-.029M10 6H6V4.5a2 2 0 1 1 4 0z" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},373206:(e,t,i)=>{i.d(t,{Icon16UnlockOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon16UnlockOutline","unlock_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="unlock_outline_16"><path fill="currentColor" fill-rule="evenodd" d="M2 10c0-1.4 0-2.1.273-2.635a2.5 2.5 0 0 1 1.092-1.093c.297-.15.645-.218 1.135-.248V4.5a3.5 3.5 0 0 1 6.867-.957.75.75 0 1 1-1.443.41A2 2 0 0 0 6 4.5V6h4c1.4 0 2.1 0 2.635.273a2.5 2.5 0 0 1 1.093 1.092C14 7.9 14 8.6 14 10v1c0 1.4 0 2.1-.272 2.635a2.5 2.5 0 0 1-1.093 1.093C12.1 15 11.4 15 10 15H6c-1.4 0-2.1 0-2.635-.272a2.5 2.5 0 0 1-1.092-1.093C2 13.1 2 12.4 2 11zm8-2.5H6c-.725 0-1.178.001-1.52.029-.324.027-.413.07-.434.08a1 1 0 0 0-.437.437c-.01.02-.053.11-.08.434-.028.342-.029.795-.029 1.52v1c0 .725.001 1.178.029 1.52.027.324.07.413.08.434a1 1 0 0 0 .437.437c.02.01.11.053.434.08.342.028.795.029 1.52.029h4c.725 0 1.178-.001 1.52-.03.324-.026.413-.069.434-.079a1 1 0 0 0 .437-.437c.01-.02.053-.11.08-.434.028-.342.029-.795.029-1.52v-1c0-.725-.001-1.178-.03-1.52-.026-.324-.069-.413-.079-.434a1 1 0 0 0-.437-.437c-.02-.01-.11-.053-.434-.08-.342-.028-.795-.029-1.52-.029" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},565168:(e,t,i)=>{i.d(t,{Icon20DeleteClockOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon20DeleteClockOutline","delete_clock_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="delete_clock_outline_20"><path fill-rule="evenodd" d="M8.418 4a1.75 1.75 0 0 1 3.164 0zm-1.58 0a3.25 3.25 0 0 1 6.325 0h4.087a.75.75 0 0 1 0 1.5h-.545l-.155 1.573a.75.75 0 0 1-1.493-.146l.14-1.427H4.803l.896 9.14c.051.527.087.882.134 1.156.046.265.095.4.147.492a1.4 1.4 0 0 0 .654.593c.177.078.431.113 1.172.118a.75.75 0 0 1-.01 1.5c-.69-.005-1.261-.022-1.768-.246a2.9 2.9 0 0 1-1.354-1.228c-.17-.302-.259-.624-.319-.973a18 18 0 0 1-.146-1.238L3.295 5.5H2.75a.75.75 0 0 1 0-1.5h4.087ZM14 19c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8a.75.75 0 0 1 .75.75v1.849l.913.608a.75.75 0 1 1-.832 1.248l-1.247-.831A.75.75 0 0 1 13.25 14v-2.25A.75.75 0 0 1 14 11" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},578192:(e,t,i)=>{i.d(t,{Icon28ArrowDownOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28ArrowDownOutline","arrow_down_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="arrow_down_outline_28"><path d="M14 23h-.02l-.07-.004za1 1 0 0 1-.155-.011l-.036-.007a1 1 0 0 1-.62-.377l-7.896-7.898a1 1 0 0 1 1.32-1.497l.094.083L13 19.586V4.95c0-.525.448-.95 1-.95.513 0 .935.367.993.84l.007.11v14.636l6.293-6.293a1 1 0 0 1 1.32-.083l.094.083a1 1 0 0 1 .083 1.32l-.083.094-7.895 7.898a1 1 0 0 1-.621.378l-.037.005A.7.7 0 0 1 14 23" /></symbol>',28,28,!1,void 0)},225583:(e,t,i)=>{i.d(t,{Icon28ArrowUpOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28ArrowUpOutline","arrow_up_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="arrow_up_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M14 5h.02q.034 0 .07.004zq.079 0 .155.011l.036.007c.254.046.475.184.62.377l7.896 7.898a1 1 0 0 1-1.32 1.497l-.094-.083L15 8.414V23.05c0 .525-.448.95-1 .95-.513 0-.936-.367-.993-.84L13 23.05V8.414l-6.293 6.293a1 1 0 0 1-1.32.083l-.094-.083a1 1 0 0 1-.083-1.32l.083-.094 7.895-7.898c.146-.193.367-.331.621-.378l.037-.005A.7.7 0 0 1 14 5" /></g></symbol>',28,28,!1,void 0)},509548:(e,t,i)=>{i.d(t,{Icon28LikeFillRed:()=>o});var o=(0,i(844990).makeIcon)("Icon28LikeFillRed","like_fill_red_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="like_fill_red_28"><path fill="#ff3347" d="M9.026 4.88A6.526 6.526 0 0 0 2.5 11.406c0 3.613 1.445 5.421 7.493 10.126l2.78 2.16a2 2 0 0 0 2.455 0l2.779-2.16c6.048-4.705 7.493-6.513 7.493-10.126a6.526 6.526 0 0 0-6.526-6.526c-1.872 0-3.538.85-4.974 2.487C12.564 5.73 10.898 4.88 9.026 4.88" /></symbol>',28,28,!1,void 0)},225853:(e,t,i)=>{i.d(t,{Icon28MoreHorizontal:()=>o});var o=(0,i(844990).makeIcon)("Icon28MoreHorizontal","more_horizontal_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="more_horizontal_28"><path d="M8.5 14a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0m8 0a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0m5.5 2.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5" /></symbol>',28,28,!1,void 0)},217157:(e,t,i)=>{i.d(t,{Icon28MuteOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28MuteOutline","mute_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="mute_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M13.925 4h-.032q-.094 0-.175.002a3 3 0 0 0-1.931.8l-.126.122L6.586 10H5.364c-.39 0-.74 0-1.03.024a2.5 2.5 0 0 0-.969.249 2.5 2.5 0 0 0-1.092 1.092 2.5 2.5 0 0 0-.25.968C2 12.625 2 12.975 2 13.363v1.273c0 .39 0 .74.024 1.03.025.313.083.644.249.969a2.5 2.5 0 0 0 1.092 1.092c.325.166.656.224.968.25.292.023.642.023 1.03.023h1.223l5.075 5.076q.066.066.126.122a3 3 0 0 0 1.93.8c.057.002.113.002.176.002h.032c.066 0 .147 0 .222-.005a2 2 0 0 0 1.848-1.848 3 3 0 0 0 .005-.222V6.075a3 3 0 0 0-.005-.222 2 2 0 0 0-1.848-1.848C14.072 4 13.991 4 13.925 4m-.019 2H14v16h-.208a1 1 0 0 1-.644-.267l-.082-.08-5.312-5.313-.001-.001-.053-.051a1 1 0 0 0-.167-.126 1.1 1.1 0 0 0-.318-.132 1 1 0 0 0-.207-.029L6.935 16H5.4c-.436 0-.704 0-.904-.017a1 1 0 0 1-.184-.025l-.031-.01-.008-.002a.5.5 0 0 1-.218-.219l-.004-.008-.009-.031a1 1 0 0 1-.025-.184c-.016-.2-.017-.467-.017-.904v-1.2c0-.436 0-.704.017-.904a1 1 0 0 1 .025-.184l.01-.031.003-.008a.5.5 0 0 1 .218-.218l.008-.004.031-.009a1 1 0 0 1 .184-.025c.2-.016.467-.017.904-.017h1.535l.073-.001a1.1 1.1 0 0 0 .692-.287c.025-.022.048-.046.053-.05l.001-.002 5.312-5.312.082-.08A1 1 0 0 1 13.792 6zm11.801 4.293a1 1 0 0 1 0 1.414L23.414 14l2.293 2.293a1 1 0 0 1-1.414 1.414L22 15.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L20.586 14l-2.293-2.293a1 1 0 0 1 1.414-1.414L22 12.586l2.293-2.293a1 1 0 0 1 1.414 0" /></symbol>',28,28,!1,void 0)},544129:(e,t,i)=>{i.d(t,{Icon28ThumbsDown:()=>o});var o=(0,i(844990).makeIcon)("Icon28ThumbsDown","thumbs_down_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="thumbs_down_28"><path fill-rule="evenodd" d="M23.75 4.004a1.25 1.25 0 0 0-1.251 1.25v11.5a1.25 1.25 0 0 0 2.5 0v-11.5c0-.69-.559-1.25-1.25-1.25Zm-4.235 14.602-2.37 4.997a2.443 2.443 0 0 1-4.65-1.046v-3.768a.287.287 0 0 0-.288-.287H6.503c-2.456 0-4.149-2.465-3.266-4.757l2.96-7.69a3.2 3.2 0 0 1 2.987-2.05h7.213a3.6 3.6 0 0 1 3.6 3.6v8.86a5 5 0 0 1-.482 2.141" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},222870:(e,t,i)=>{i.d(t,{Icon28ThumbsDownOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28ThumbsDownOutline","thumbs_down_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="thumbs_down_outline_28"><path fill-rule="evenodd" d="M16.201 23.188a1.419 1.419 0 0 1-2.701-.607v-3.699c0-.763-.619-1.382-1.382-1.382h-5.61a2.5 2.5 0 0 1-2.322-3.424l2.982-7.5A2.5 2.5 0 0 1 9.491 5H16.5A2.5 2.5 0 0 1 19 7.5v8.951c0 .543-.12 1.079-.352 1.569L16.2 23.188ZM14.92 26a3.42 3.42 0 0 0 3.09-1.956l2.446-5.168A5.7 5.7 0 0 0 21 16.45V7.5A4.5 4.5 0 0 0 16.5 3H9.491A4.5 4.5 0 0 0 5.31 5.837l-2.983 7.5C1.152 16.292 3.33 19.5 6.51 19.5h4.99v3.081A3.42 3.42 0 0 0 14.919 26ZM24 3a1 1 0 0 0-1 1v12a1 1 0 1 0 2 0V4a1 1 0 0 0-1-1" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},54472:(e,t,i)=>{i.d(t,{Icon28VolumeOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon28VolumeOutline","volume_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="volume_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M13.925 4c.066 0 .147 0 .222.005A2 2 0 0 1 16 6.075v15.85a3 3 0 0 1-.005.222A2 2 0 0 1 13.925 24h-.032q-.093 0-.175-.002a3 3 0 0 1-1.931-.8c-.041-.038-.08-.077-.126-.122L6.586 18H5.364c-.39 0-.74 0-1.03-.024a2.5 2.5 0 0 1-.969-.249 2.5 2.5 0 0 1-1.092-1.092 2.5 2.5 0 0 1-.25-.968C2 15.375 2 15.025 2 14.637v-1.273c0-.39 0-.74.024-1.03.025-.313.083-.644.249-.969a2.5 2.5 0 0 1 1.092-1.092 2.5 2.5 0 0 1 .968-.25C4.625 10 4.975 10 5.363 10h1.223l5.075-5.075.126-.123a3 3 0 0 1 1.93-.8C13.775 4 13.83 4 13.894 4zm.07 2h-.203a1 1 0 0 0-.644.267l-.082.08-5.312 5.313v.001l-.054.051a1.1 1.1 0 0 1-.692.287L6.935 12H5.4c-.436 0-.704 0-.904.017a1 1 0 0 0-.184.025l-.031.01-.008.002a.5.5 0 0 0-.218.219s-.002.003-.004.008l-.009.031a1 1 0 0 0-.025.184c-.016.2-.017.467-.017.904v1.2c0 .437 0 .704.017.904.008.093.017.15.025.184l.01.031.003.008a.5.5 0 0 0 .218.219s.003 0 .008.003l.031.009c.035.008.091.017.184.025.2.016.467.017.904.017h1.535l.073.001a1 1 0 0 1 .207.03 1.1 1.1 0 0 1 .538.308h.001l5.312 5.313c.06.06.071.071.082.08a1 1 0 0 0 .644.267l.114.001H14V6zm4.725 4.252a1 1 0 0 1 1.406-.155A5 5 0 0 1 22 14c0 1.58-.733 2.988-1.874 3.903a1 1 0 0 1-1.251-1.56A3 3 0 0 0 20 14c0-.947-.437-1.791-1.125-2.342a1 1 0 0 1-.155-1.406m4.233-3.002a1 1 0 0 0-1.323 1.5A6.98 6.98 0 0 1 24 14a6.98 6.98 0 0 1-2.37 5.25 1 1 0 1 0 1.323 1.5A8.98 8.98 0 0 0 26 14a8.98 8.98 0 0 0-3.047-6.75" /></symbol>',28,28,!1,void 0)},357331:(e,t,i)=>{i.d(t,{Icon36Pause:()=>o});var o=(0,i(844990).makeIcon)("Icon36Pause","pause_36","0 0 36 36",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 36 36" id="pause_36"><g fill="currentColor"><path d="M20.5 9.5A1.5 1.5 0 0 1 22 8h3.5A1.5 1.5 0 0 1 27 9.5v17a1.5 1.5 0 0 1-1.5 1.5H22a1.5 1.5 0 0 1-1.5-1.5zM9 9.5A1.5 1.5 0 0 1 10.5 8H14a1.5 1.5 0 0 1 1.5 1.5v17A1.5 1.5 0 0 1 14 28h-3.5A1.5 1.5 0 0 1 9 26.5z" /></g></symbol>',36,36,!1,void 0)},910551:(e,t,i)=>{i.d(t,{Icon56LogoClipsOutline:()=>o});var o=(0,i(844990).makeIcon)("Icon56LogoClipsOutline","logo_clips_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="logo_clips_outline_56"><path fill="currentColor" d="M20.138 4.003A1.6 1.6 0 0 1 21.835 5.5l.803 12.8a1.6 1.6 0 0 1-3.194.2l-.803-12.8a1.6 1.6 0 0 1 1.497-1.697m20.338 20.358a1.5 1.5 0 0 0-1.952 2.278c3.166 2.714 4.474 6.273 4.476 9.289v.008C43 41.508 37.834 49 28.073 49c-3.654 0-7.463-1.415-10.345-3.797C14.855 42.828 13 39.583 13 35.936c0-1.686.519-3.43 1.615-4.725C15.675 29.957 17.376 29 20.036 29c1.441 0 3.813.703 5.06 4.027a1.5 1.5 0 0 0 2.809-1.054c-1.753-4.672-5.377-5.971-7.864-5.973h-.005c-3.47 0-6.036 1.293-7.712 3.273C10.684 31.212 10 33.686 10 35.936c0 4.73 2.413 8.766 5.817 11.58C19.212 50.32 23.69 52 28.073 52 39.553 52 45.997 43.103 46 35.941v-.005c0-3.855-1.661-8.264-5.524-11.575M35.825 5.057a1.6 1.6 0 0 1 1.117 1.968l-3.8 13.8a1.6 1.6 0 1 1-3.085-.85l3.8-13.8a1.6 1.6 0 0 1 1.968-1.118" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},389900:(e,t,i)=>{i.d(t,{default:()=>o});const o={playlistPrivateIcon:"PlaylistCheckboxTooltip__playlistPrivateIcon--Q2r70"}},635172:(e,t,i)=>{i.d(t,{default:()=>o});const o={playlistPrivateIcon:"PlaylistPopover__playlistPrivateIcon--CxRHz",playlistSubhead:"PlaylistPopover__playlistSubhead--M3q0F",scrollHeight:"PlaylistPopover__scrollHeight--r5ujL"}},729501:(e,t,i)=>{i.d(t,{default:()=>o});const o={scroll:"PrivacyFriendsFormList__scroll--PKMcW"}},930735:(e,t,i)=>{i.d(t,{default:()=>o});const o={status:"PrivacyFriendsFormStatus__status--8iUpg"}},111658:(e,t,i)=>{i.d(t,{default:()=>o});const o={feedWrapper:"ClipsFeedComponent__feedWrapper--iT33i"}},912248:(e,t,i)=>{i.d(t,{default:()=>o});const o={root:"ClipsFeedControlsLayout__root--gxGXI"}},291886:(e,t,i)=>{i.d(t,{default:()=>o});const o={container:"VideoClipsWidget__container--1I2Pg"}},477100:(e,t,i)=>{i.d(t,{default:()=>o});const o={modalHeader:"VideoPlaylistsModal__modalHeader--8Iz2V"}},807320:(e,t,i)=>{i.d(t,{PresenceChild:()=>d});var o=i(331635),s=i(296540),r=i(786719),a=i(328601),n=i(114278),d=function(e){var t=e.children,i=e.initial,d=e.isPresent,c=e.onExitComplete,u=e.custom,h=e.presenceAffectsLayout,p=(0,a.useConstant)(l),_=(0,n.useId)(),v=(0,s.useMemo)((function(){return{id:_,initial:i,isPresent:d,custom:u,onExitComplete:function(e){var t,i;p.set(e,!0);try{for(var s=(0,o.__values)(p.values()),r=s.next();!r.done;r=s.next()){if(!r.value)return}}catch(e){t={error:e}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}null==c||c()},register:function(e){return p.set(e,!1),function(){return p.delete(e)}}}}),h?void 0:[d]);return(0,s.useMemo)((function(){p.forEach((function(e,t){return p.set(t,!1)}))}),[d]),s.useEffect((function(){!d&&!p.size&&(null==c||c())}),[d]),s.createElement(r.PresenceContext.Provider,{value:v},t)};function l(){return new Map}},854999:(e,t,i)=>{i.d(t,{AnimatePresence:()=>p});var o=i(331635),s=i(296540),r=i(93593),a=i(198048),n=i(51194),d=i(807320),l=i(29473),c=i(525128),u=i(757491),h=function(e){return e.key||""};var p=function(e){var t=e.children,i=e.custom,p=e.initial,_=void 0===p||p,v=e.onExitComplete,g=e.exitBeforeEnter,m=e.presenceAffectsLayout,y=void 0===m||m,b=(0,o.__read)((0,a.useForceUpdate)(),1)[0],C=(0,s.useContext)(l.LayoutGroupContext).forceRender;C&&(b=C);var f=(0,n.useIsMounted)(),I=function(e){var t=[];return s.Children.forEach(e,(function(e){(0,s.isValidElement)(e)&&t.push(e)})),t}(t),S=I,P=new Set,w=(0,s.useRef)(S),A=(0,s.useRef)(new Map).current,L=(0,s.useRef)(!0);if((0,c.useIsomorphicLayoutEffect)((function(){L.current=!1,function(e,t){e.forEach((function(e){var i=h(e);t.set(i,e)}))}(I,A),w.current=S})),(0,u.useUnmountEffect)((function(){L.current=!0,A.clear(),P.clear()})),L.current)return s.createElement(s.Fragment,null,S.map((function(e){return s.createElement(d.PresenceChild,{key:h(e),isPresent:!0,initial:!!_&&void 0,presenceAffectsLayout:y},e)})));S=(0,o.__spreadArray)([],(0,o.__read)(S),!1);for(var E=w.current.map(h),M=I.map(h),F=E.length,k=0;k<F;k++){var x=E[k];-1===M.indexOf(x)&&P.add(x)}return g&&P.size&&(S=[]),P.forEach((function(e){if(-1===M.indexOf(e)){var t=A.get(e);if(t){var o=E.indexOf(e);S.splice(o,0,s.createElement(d.PresenceChild,{key:h(t),isPresent:!1,onExitComplete:function(){A.delete(e),P.delete(e);var t=w.current.findIndex((function(t){return t.key===e}));if(w.current.splice(t,1),!P.size){if(w.current=I,!1===f.current)return;b(),v&&v()}},custom:i,presenceAffectsLayout:y},t))}}})),S=S.map((function(e){var t=e.key;return P.has(t)?e:s.createElement(d.PresenceChild,{key:h(e),isPresent:!0,presenceAffectsLayout:y},e)})),"production"!==r.env&&g&&S.length>1&&console.warn("You're attempting to animate multiple children within AnimatePresence, but its exitBeforeEnter prop is set to true. This will lead to odd visual behaviour."),s.createElement(s.Fragment,null,P.size?S:S.map((function(e){return(0,s.cloneElement)(e)})))}},198048:(e,t,i)=>{i.d(t,{useForceUpdate:()=>n});var o=i(331635),s=i(282439),r=i(296540),a=i(51194);function n(){var e=(0,a.useIsMounted)(),t=(0,o.__read)((0,r.useState)(0),2),i=t[0],n=t[1],d=(0,r.useCallback)((function(){e.current&&n(i+1)}),[i]);return[(0,r.useCallback)((function(){return s.default.postRender(d)}),[d]),i]}},114278:(e,t,i)=>{i.d(t,{useId:()=>a});var o=i(328601),s=0,r=function(){return s++},a=function(){return(0,o.useConstant)(r)}},51194:(e,t,i)=>{i.d(t,{useIsMounted:()=>r});var o=i(296540),s=i(525128);function r(){var e=(0,o.useRef)(!1);return(0,s.useIsomorphicLayoutEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}},757491:(e,t,i)=>{i.d(t,{useUnmountEffect:()=>s});var o=i(296540);function s(e){return(0,o.useEffect)((function(){return function(){return e()}}),[])}}}]);try{stManager?.done("dist/web/chunks/53b7eaed.31a9ddf6.js")}catch(e){}